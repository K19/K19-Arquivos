<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 5. Basic O/R Mapping</title><link rel="stylesheet" type="text/css" href="css/hibernate.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="home" href="index.html" title="HIBERNATE - Relational Persistence for Idiomatic Java"/><link rel="up" href="index.html" title="HIBERNATE - Relational Persistence for Idiomatic Java"/><link rel="prev" href="ch04.html" title="Chapter 4. Persistent Classes"/><link rel="next" href="ch06.html" title="Chapter 6. Types"/><link rel="copyright" href="ln-d5e19.html" title="Legal Notice"/><meta xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" http-equiv="Content-Type" content="text/html; charset=UTF-8"/></head><body><p xmlns:d="http://docbook.org/ns/docbook" id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="ch04.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="ch06.html"><strong>Next</strong></a></li></ul><div class="chapter" title="Chapter 5. Basic O/R Mapping"><div class="titlepage"><div><div><h2 class="title"><a id="mapping"/>Chapter 5. Basic O/R Mapping</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="section"><a href="ch05.html#mapping-declaration">5.1. Mapping declaration</a></span></dt><dd><dl><dt><span class="section"><a href="ch05.html#mapping-declaration-class">5.1.1. Entity</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-declaration-id">5.1.2. Identifiers</a></span></dt><dt><span class="section"><a href="ch05.html#d5e2785">5.1.3. Optimistic locking properties (optional)</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-declaration-property">5.1.4. Property</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-declaration-component">5.1.5. Embedded objects (aka components)</a></span></dt><dt><span class="section"><a href="ch05.html#d5e3306">5.1.6. Inheritance strategy</a></span></dt><dt><span class="section"><a href="ch05.html#d5e3628">5.1.7. Mapping one to one and one to many associations</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-declaration-naturalid">5.1.8. Natural-id</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-types-anymapping">5.1.9. Any</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-declaration-properties">5.1.10. Properties</a></span></dt><dt><span class="section"><a href="ch05.html#d5e4015">5.1.11. Some hbm.xml specificities</a></span></dt></dl></dd><dt><span class="section"><a href="ch05.html#mapping-types">5.2. Hibernate types</a></span></dt><dd><dl><dt><span class="section"><a href="ch05.html#mapping-types-entitiesvalues">5.2.1. Entities and values</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-types-basictypes">5.2.2. Basic value types</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-types-custom">5.2.3. Custom value types</a></span></dt></dl></dd><dt><span class="section"><a href="ch05.html#mapping-entityname">5.3. Mapping a class more than once</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-quotedidentifiers">5.4. SQL quoted identifiers</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-generated">5.5. Generated properties</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-column-read-and-write">5.6. Column transformers: read and write expressions</a></span></dt><dt><span class="section"><a href="ch05.html#mapping-database-object">5.7. Auxiliary database objects</a></span></dt></dl></div>
  

  <div class="section" title="5.1. Mapping declaration"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-declaration"/>5.1. Mapping declaration</h2></div></div></div>
    

    <p>Object/relational mappings can be defined in three
    approaches:</p>

    <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
        <p>using Java 5 annotations (via the Java Persistence 2
        annotations)</p>
      </li><li class="listitem">
        <p>using JPA 2 XML deployment descriptors (described in chapter
        XXX)</p>
      </li><li class="listitem">
        <p>using the Hibernate legacy XML files approach known as
        hbm.xml</p>
      </li></ul></div>

    <p>Annotations are split in two categories, the logical mapping
    annotations (describing the object model, the association between two
    entities etc.) and the physical mapping annotations (describing the
    physical schema, tables, columns, indexes, etc). We will mix annotations
    from both categories in the following code examples.</p>

    <p>JPA annotations are in the <code class="literal">javax.persistence.*</code>
    package. Hibernate specific extensions are in
    <code class="literal">org.hibernate.annotations.*</code>. You favorite IDE can
    auto-complete annotations and their attributes for you (even without a
    specific "JPA" plugin, since JPA annotations are plain Java 5
    annotations).</p>

    <p>Here is an example of mapping</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">package eg;

@Entity 
@Table(name="cats") @Inheritance(strategy=SINGLE_TABLE)
@DiscriminatorValue("C") @DiscriminatorColumn(name="subclass", discriminatorType=CHAR)
public class Cat {
   
   @Id @GeneratedValue
   public Integer getId() { return id; }
   public void setId(Integer id) { this.id = id; }
   private Integer id;

   public BigDecimal getWeight() { return weight; }
   public void setWeight(BigDecimal weight) { this.weight = weight; }
   private BigDecimal weight;

   @Temporal(DATE) @NotNull @Column(updatable=false)
   public Date getBirthdate() { return birthdate; }
   public void setBirthdate(Date birthdate) { this.birthdate = birthdate; }
   private Date birthdate;

   @org.hibernate.annotations.Type(type="eg.types.ColorUserType")
   @NotNull @Column(updatable=false)
   public ColorType getColor() { return color; }
   public void setColor(ColorType color) { this.color = color; }
   private ColorType color;

   @NotNull @Column(updatable=false)
   public String getSex() { return sex; }
   public void setSex(String sex) { this.sex = sex; }
   private String sex;

   @NotNull @Column(updatable=false)
   public Integer getLitterId() { return litterId; }
   public void setLitterId(Integer litterId) { this.litterId = litterId; }
   private Integer litterId;

   @ManyToOne @JoinColumn(name="mother_id", updatable=false)
   public Cat getMother() { return mother; }
   public void setMother(Cat mother) { this.mother = mother; }
   private Cat mother;

   @OneToMany(mappedBy="mother") @OrderBy("litterId")
   public Set&lt;Cat&gt; getKittens() { return kittens; }
   public void setKittens(Set&lt;Cat&gt; kittens) { this.kittens = kittens; }
   private Set&lt;Cat&gt; kittens = new HashSet&lt;Cat&gt;();
}

@Entity @DiscriminatorValue("D")
public class DomesticCat extends Cat {

   public String getName() { return name; }
   public void setName(String name) { this.name = name }
   private String name;
}

@Entity
public class Dog { ... }</pre>

    <p>The legacy hbm.xml approach uses an XML schema designed to be
    readable and hand-editable. The mapping language is Java-centric, meaning
    that mappings are constructed around persistent class declarations and not
    table declarations.</p>

    <p>Please note that even though many Hibernate users choose to write
    the XML by hand, a number of tools exist to generate the mapping document.
    These include XDoclet, Middlegen and AndroMDA.</p>

    <p>Here is an example mapping:</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
      "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
          "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;

        &lt;class name="Cat"
            table="cats"
            discriminator-value="C"&gt;

                &lt;id name="id"&gt;
                        &lt;generator class="native"/&gt;
                &lt;/id&gt;

                &lt;discriminator column="subclass"
                     type="character"/&gt;

                &lt;property name="weight"/&gt;

                &lt;property name="birthdate"
                    type="date"
                    not-null="true"
                    update="false"/&gt;

                &lt;property name="color"
                    type="eg.types.ColorUserType"
                    not-null="true"
                    update="false"/&gt;

                &lt;property name="sex"
                    not-null="true"
                    update="false"/&gt;

                &lt;property name="litterId"
                    column="litterId"
                    update="false"/&gt;

                &lt;many-to-one name="mother"
                    column="mother_id"
                    update="false"/&gt;

                &lt;set name="kittens"
                    inverse="true"
                    order-by="litter_id"&gt;
                        &lt;key column="mother_id"/&gt;
                        &lt;one-to-many class="Cat"/&gt;
                &lt;/set&gt;

                &lt;subclass name="DomesticCat"
                    discriminator-value="D"&gt;

                        &lt;property name="name"
                            type="string"/&gt;

                &lt;/subclass&gt;

        &lt;/class&gt;

        &lt;class name="Dog"&gt;
                &lt;!-- mapping for Dog could go here --&gt;
        &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre>

    <p>We will now discuss the concepts of the mapping documents (both
    annotations and XML). We will only describe, however, the document
    elements and attributes that are used by Hibernate at runtime. The mapping
    document also contains some extra optional attributes and elements that
    affect the database schemas exported by the schema export tool (for
    example, the <code class="literal"> not-null</code> attribute).</p>

    <div class="section" title="5.1.1. Entity"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-declaration-class"/>5.1.1. Entity</h3></div></div></div>
      

      <p>An entity is a regular Java object (aka POJO) which will be
      persisted by Hibernate.</p>

      <p>To mark an object as an entity in annotations, use the
      <code class="classname">@Entity</code> annotation.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setId</span><span class="java_separator">(</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">id&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

      <p>That's pretty much it, the rest is optional. There are however any
      options to tweak your entity mapping, let's explore them.</p>

      <p><code class="classname">@Table</code> lets you define the table the entity
      will be persisted into. If undefined, the table name is the unqualified
      class name of the entity. You can also optionally define the catalog,
      the schema as well as unique constraints on the table.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
@Table(name="TBL_FLIGHT", 
       schema="AIR_COMMAND", 
       uniqueConstraints=
           @UniqueConstraint(
               name="flight_number", 
               columnNames={"comp_prefix", "flight_number"} ) )
public class Flight implements Serializable {
    @Column(name="comp_prefix")
    public String getCompagnyPrefix() { return companyPrefix; }

    @Column(name="flight_number")
    public String getNumber() { return number; }
}</pre>

      <p>The constraint name is optional (generated if left undefined). The
      column names composing the constraint correspond to the column names as
      defined before the Hibernate <code class="classname">NamingStrategy</code> is
      applied.</p>

      <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Tip</h2>
        <p>Be sure to use the database-level column names for the <code class="literal">columnNames</code>
         property of a <code class="literal">@UniqueConstraint</code>. For example, whilst for simple types the
         database-level column name may be the same as the entity-level property name, this is often
         not the case for relational properties.
        </p>
      </div>

      <p><code class="literal">@Entity.name</code> lets you define the shortcut name
      of the entity you can used in JP-QL and HQL queries. It defaults to the
      unqualified class name of the class.</p>

      <p>Hibernate goes beyond the JPA specification and provide additional
      configurations. Some of them are hosted on
      <code class="classname">@org.hibernate.annotations.Entity</code>:</p>

      <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
          <p><code class="literal">dynamicInsert</code> /
          <code class="literal">dynamicUpdate</code> (defaults to false): specifies that
          <code class="literal">INSERT</code> / <code class="literal">UPDATE</code> SQL should be
          generated at runtime and contain only the columns whose values are
          not null. The <code class="literal">dynamic-update</code> and
          <code class="literal">dynamic-insert</code> settings are not inherited by
          subclasses. Although these settings can increase performance in some
          cases, they can actually decrease performance in others.</p>
        </li><li class="listitem">
          <p><code class="literal">selectBeforeUpdate</code> (defaults to false):
          specifies that Hibernate should <span class="emphasis"><em>never</em></span> perform
          an SQL <code class="literal">UPDATE</code> unless it is certain that an object
          is actually modified. Only when a transient object has been
          associated with a new session using <code class="literal">update()</code>,
          will Hibernate perform an extra SQL <code class="literal">SELECT</code> to
          determine if an <code class="literal">UPDATE</code> is actually required. Use
          of <code class="literal">select-before-update</code> will usually decrease
          performance. It is useful to prevent a database update trigger being
          called unnecessarily if you reattach a graph of detached instances
          to a <code class="literal">Session</code>.</p>
        </li><li class="listitem">
          <p><code class="literal">polymorphisms</code> (defaults to
          <code class="literal">IMPLICIT</code>): determines whether implicit or
          explicit query polymorphisms is used. <span class="emphasis"><em>Implicit</em></span>
          polymorphisms means that instances of the class will be returned by
          a query that names any superclass or implemented interface or class,
          and that instances of any subclass of the class will be returned by
          a query that names the class itself. <span class="emphasis"><em>Explicit</em></span>
          polymorphisms means that class instances will be returned only by
          queries that explicitly name that class. Queries that name the class
          will return only instances of subclasses mapped. For most purposes,
          the default <code class="literal">polymorphisms=IMPLICIT</code> is
          appropriate. Explicit polymorphisms is useful when two different
          classes are mapped to the same table This allows a "lightweight"
          class that contains a subset of the table columns.</p>
        </li><li class="listitem">
          <p><code class="literal">persister</code>: specifies a custom
          <code class="literal">ClassPersister</code>. The <code class="literal">persister</code>
          attribute lets you customize the persistence strategy used for the
          class. You can, for example, specify your own subclass of
          <code class="literal">org.hibernate.persister.EntityPersister</code>, or you
          can even provide a completely new implementation of the interface
          <code class="literal">org.hibernate.persister.ClassPersister</code> that
          implements, for example, persistence via stored procedure calls,
          serialization to flat files or LDAP. See
          <code class="literal">org.hibernate.test.CustomPersister</code> for a simple
          example of "persistence" to a <code class="literal">Hashtable</code>.</p>
        </li><li class="listitem">
          <p><code class="literal">optimisticLock</code> (defaults to
          <code class="literal">VERSION</code>): determines the optimistic locking
          strategy. If you enable <code class="literal">dynamicUpdate</code>, you will
          have a choice of optimistic locking strategies:</p>

          <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
              <p><code class="literal">version</code>: check the version/timestamp
              columns</p>
            </li><li class="listitem">
              <p><code class="literal">all</code>: check all columns</p>
            </li><li class="listitem">
              <p><code class="literal">dirty</code>: check the changed columns,
              allowing some concurrent updates</p>
            </li><li class="listitem">
              <p><code class="literal">none</code>: do not use optimistic
              locking</p>
            </li></ul></div>

          <p>It is <span class="emphasis"><em>strongly</em></span> recommended that you use
          version/timestamp columns for optimistic locking with Hibernate.
          This strategy optimizes performance and correctly handles
          modifications made to detached instances (i.e. when
          <code class="literal">Session.merge()</code> is used).</p>
        </li></ul></div>

      <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Tip</h2>
        <p>Be sure to import
        <code class="classname">@javax.persistence.Entity</code> to mark a class as an
        entity. It's a common mistake to import
        <code class="classname">@org.hibernate.annotations.Entity</code> by
        accident.</p>
      </div>

      <p>Some entities are not mutable. They cannot be updated
      by the application. This allows Hibernate to make some minor performance
      optimizations.. Use the <code class="classname">@Immutable</code>
      annotation.</p>

      <p>You can also alter how Hibernate deals with lazy initialization
      for this class. On <code class="classname">@Proxy</code>, use
      <code class="literal">lazy</code>=false to disable lazy fetching (not
      recommended). You can also specify an interface to use for lazy
      initializing proxies (defaults to the class itself): use
      <code class="literal">proxyClass</code> on <code class="classname">@Proxy</code>.
      Hibernate will initially return proxies ( using bytecode provider defined by <code class="literal">hibernate.bytecode.provider</code>) that
      implement the named interface. The persistent object will load when a
      method of the proxy is invoked. See "Initializing collections and
      proxies" below.</p>

      <p><code class="classname">@BatchSize</code> specifies a "batch size" for
      fetching instances of this class by identifier. Not yet loaded instances
      are loaded batch-size at a time (default 1).</p>

      <p>You can specific an arbitrary SQL WHERE condition to be used when
      retrieving objects of this class. Use <code class="classname">@Where</code> for
      that.</p>

      <p>In the same vein, <code class="classname">@Check</code> lets you define an
      SQL expression used to generate a multi-row <span class="emphasis"><em>check</em></span>
      constraint for automatic schema generation.</p>

      <p>There is no difference between a view and a base table for a
      Hibernate mapping. This is transparent at the database level, although
      some DBMS do not support views properly, especially with updates.
      Sometimes you want to use a view, but you cannot create one in the
      database (i.e. with a legacy schema). In this case, you can map an
      immutable and read-only entity to a given SQL subselect expression using
      <code class="classname">@org.hibernate.annotations.Subselect</code>:</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
@Subselect("select item.name, max(bid.amount), count(*) "
        + "from item "
        + "join bid on bid.item_id = item.id "
        + "group by item.name")
@Synchronize( {"item", "bid"} ) //tables impacted
public class Summary {
    @Id
    public String getId() { return id; }
    ...
}</pre>

      <p>Declare the tables to synchronize this entity with, ensuring that
      auto-flush happens correctly and that queries against the derived entity
      do not return stale data. The <code class="literal">&lt;subselect&gt;</code> is
      available both as an attribute and a nested mapping element.</p>

      <p>We will now explore the same options using the hbm.xml structure.
      You can declare a persistent class using the <code class="literal">class</code>
      element. For example:</p>

      <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class
        name="ClassName"                                   <span class="co" id="class1"><img src="images/callouts/1.png" alt="(1)"/></span>
        table="tableName"                                  <span class="co" id="class2"><img src="images/callouts/2.png" alt="(2)"/></span>
        discriminator-value="discriminator_value"          <span class="co" id="class3"><img src="images/callouts/3.png" alt="(3)"/></span>
        mutable="true|false"                               <span class="co" id="class4"><img src="images/callouts/4.png" alt="(4)"/></span>
        schema="owner"                                     <span class="co" id="class5"><img src="images/callouts/5.png" alt="(5)"/></span>
        catalog="catalog"                                  <span class="co" id="class6"><img src="images/callouts/6.png" alt="(6)"/></span>
        proxy="ProxyInterface"                             <span class="co" id="class7"><img src="images/callouts/7.png" alt="(7)"/></span>
        dynamic-update="true|false"                        <span class="co" id="class8"><img src="images/callouts/8.png" alt="(8)"/></span>
        dynamic-insert="true|false"                        <span class="co" id="class9"><img src="images/callouts/9.png" alt="(9)"/></span>
        select-before-update="true|false"                  <span class="co" id="class10"><img src="images/callouts/10.png" alt="(10)"/></span>
        polymorphism="implicit|explicit"                   <span class="co" id="class11"><img src="images/callouts/11.png" alt="(11)"/></span>
        where="arbitrary sql where condition"              <span class="co" id="class12"><img src="images/callouts/12.png" alt="(12)"/></span>
        persister="PersisterClass"                         <span class="co" id="class13"><img src="images/callouts/13.png" alt="(13)"/></span>
        batch-size="N"                                     <span class="co" id="class14"><img src="images/callouts/14.png" alt="(14)"/></span>
        optimistic-lock="none|version|dirty|all"           <span class="co" id="class15"><img src="images/callouts/15.png" alt="(15)"/></span>
        lazy="true|false"                                  <span class="co" id="class16">(16)</span>
        entity-name="EntityName"                           <span class="co" id="class17">(17)</span>
        check="arbitrary sql check condition"              <span class="co" id="class18">(18)</span>
        rowxml:id="rowid"                                  <span class="co" id="class19">(19)</span>
        subselect="SQL expression"                         <span class="co" id="class20">(20)</span>
        abstract="true|false"                              <span class="co" id="class21">(21)</span>
        node="element-name"
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">name</code> (optional): the fully qualified Java
            class name of the persistent class or interface. If this attribute
            is missing, it is assumed that the mapping is for a non-POJO
            entity.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">table</code> (optional - defaults to the
            unqualified class name): the name of its database table.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">discriminator-value</code> (optional - defaults
            to the class name): a value that distinguishes individual
            subclasses that is used for polymorphic behavior. Acceptable
            values include <code class="literal">null</code> and <code class="literal">not
            null</code>.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">mutable</code> (optional - defaults to
            <code class="literal">true</code>): specifies that instances of the class
            are (not) mutable.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">schema</code> (optional): overrides the schema
            name specified by the root
            <code class="literal">&lt;hibernate-mapping&gt;</code> element.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">catalog</code> (optional): overrides the catalog
            name specified by the root
            <code class="literal">&lt;hibernate-mapping&gt;</code> element.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">proxy</code> (optional): specifies an interface
            to use for lazy initializing proxies. You can specify the name of
            the class itself.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">dynamic-update</code> (optional - defaults to
            <code class="literal">false</code>): specifies that
            <code class="literal">UPDATE</code> SQL should be generated at runtime and
            can contain only those columns whose values have changed.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/9.png" alt="9" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">dynamic-insert</code> (optional - defaults to
            <code class="literal">false</code>): specifies that
            <code class="literal">INSERT</code> SQL should be generated at runtime and
            contain only the columns whose values are not null.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/10.png" alt="10" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">select-before-update</code> (optional - defaults
            to <code class="literal">false</code>): specifies that Hibernate should
            <span class="emphasis"><em>never</em></span> perform an SQL
            <code class="literal">UPDATE</code> unless it is certain that an object is
            actually modified. Only when a transient object has been
            associated with a new session using <code class="literal">update()</code>,
            will Hibernate perform an extra SQL <code class="literal">SELECT</code> to
            determine if an <code class="literal">UPDATE</code> is actually
            required.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/11.png" alt="11" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">polymorphisms</code> (optional - defaults to
            <code class="literal">implicit</code>): determines whether implicit or
            explicit query polymorphisms is used.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/12.png" alt="12" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">where</code> (optional): specifies an arbitrary
            SQL <code class="literal">WHERE</code> condition to be used when retrieving
            objects of this class.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/13.png" alt="13" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">persister</code> (optional): specifies a custom
            <code class="literal">ClassPersister</code>.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/14.png" alt="14" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">batch-size</code> (optional - defaults to
            <code class="literal">1</code>): specifies a "batch size" for fetching
            instances of this class by identifier.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/15.png" alt="15" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">optimistic-lock</code> (optional - defaults to
            <code class="literal">version</code>): determines the optimistic locking
            strategy.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p>(16)</p></td><td valign="top" align="left">
            <p><code class="literal">lazy</code> (optional): lazy fetching can be
            disabled by setting <code class="literal">lazy="false"</code>.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p>(17)</p></td><td valign="top" align="left">
            <p><code class="literal">entity-name</code> (optional - defaults to the
            class name): Hibernate allows a class to be mapped multiple
            times, potentially to different tables. It also allows entity
            mappings that are represented by Maps or XML at the Java level. In
            these cases, you should provide an explicit arbitrary name for the
            entity. See <a class="xref" href="ch04.html#persistent-classes-dynamicmodels" title="4.4. Dynamic models">Section 4.4, “Dynamic models”</a>
            and <a class="xref" href="">???</a> for more information.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p>(18)</p></td><td valign="top" align="left">
            <p><code class="literal">check</code> (optional): an SQL expression used
            to generate a multi-row <span class="emphasis"><em>check</em></span> constraint for
            automatic schema generation.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p>(19)</p></td><td valign="top" align="left">
            <p><code class="literal">rowid</code> (optional): Hibernate can use
            ROWIDs on databases. On Oracle, for example, Hibernate can use the
            <code class="literal">rowid</code> extra column for fast updates once this
            option has been set to <code class="literal">rowid</code>. A ROWID is an
            implementation detail and represents the physical location of a
            stored tuple.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p>(20)</p></td><td valign="top" align="left">
            <p><code class="literal">subselect</code> (optional): maps an immutable
            and read-only entity to a database subselect. This is useful if
            you want to have a view instead of a base table. See below for
            more information.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p>(21)</p></td><td valign="top" align="left">
            <p><code class="literal">abstract</code> (optional): is used to mark
            abstract superclasses in <code class="literal">&lt;union-subclass&gt;</code>
            hierarchies.</p>
          </td></tr></table></div></div>

      <p>It is acceptable for the named persistent class to be an
      interface. You can declare implementing classes of that interface using
      the <code class="literal">&lt;subclass&gt;</code> element. You can persist any
      <span class="emphasis"><em>static</em></span> inner class. Specify the class name using
      the standard form i.e. <code class="literal">e.g.Foo$Bar</code>.</p>

      <p>Here is how to do a virtual view (subselect) in XML:</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Summary"&gt;
    &lt;subselect&gt;
        select item.name, max(bid.amount), count(*)
        from item
        join bid on bid.item_id = item.id
        group by item.name
    &lt;/subselect&gt;
    &lt;synchronize table="item"/&gt;
    &lt;synchronize table="bid"/&gt;
    &lt;id name="name"/&gt;
    ...
&lt;/class&gt;</pre>

      <p>The <code class="literal">&lt;subselect&gt;</code> is available both as an
      attribute and a nested mapping element.</p>
    </div>

    <div class="section" title="5.1.2. Identifiers"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-declaration-id"/>5.1.2. Identifiers</h3></div></div></div>
      

      <p>Mapped classes <span class="emphasis"><em>must</em></span> declare the primary key
      column of the database table. Most classes will also have a
      JavaBeans-style property holding the unique identifier of an
      instance.</p>

      <p>Mark the identifier property with
      <code class="classname">@Id</code>.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
public class Person {
   @Id Integer getId() { ... }
   ...
}</pre>

      <p>In hbm.xml, use the <code class="literal">&lt;id&gt;</code> element which
      defines the mapping from that property to the primary key column.</p>

      <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id
        name="propertyName"                                <span class="co" id="id1"><img src="images/callouts/1.png" alt="(1)"/></span>
        type="typename"                                    <span class="co" id="id2"><img src="images/callouts/2.png" alt="(2)"/></span>
        column="column_name"                               <span class="co" id="id3"><img src="images/callouts/3.png" alt="(3)"/></span>
        unsaved-value="null|any|none|undefined|id_value"   <span class="co" id="id4"><img src="images/callouts/4.png" alt="(4)"/></span>
        access="field|property|ClassName"&gt;                 <span class="co" id="id5"><img src="images/callouts/5.png" alt="(5)"/></span>
        node="element-name|@attribute-name|element/@attribute|."

        &lt;generator class="generatorClass"/&gt;
&lt;/id&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">name</code> (optional): the name of the
            identifier property.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">type</code> (optional): a name that indicates
            the Hibernate type.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">column</code> (optional - defaults to the
            property name): the name of the primary key column.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">unsaved-value</code> (optional - defaults to a
            "sensible" value): an identifier property value that indicates an
            instance is newly instantiated (unsaved), distinguishing it from
            detached instances that were saved or loaded in a previous
            session.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">access</code> (optional - defaults to
            <code class="literal">property</code>): the strategy Hibernate should use
            for accessing the property value.</p>
          </td></tr></table></div></div>

      <p>If the <code class="literal">name</code> attribute is missing, it is assumed
      that the class has no identifier property.</p>

      <p>The <code class="literal">unsaved-value</code> attribute is almost never
      needed in Hibernate and indeed has no corresponding element in
      annotations.</p>

      <p>You can also declare the identifier as a composite identifier.
      This allows access to legacy data with composite keys. Its use is
      strongly discouraged for anything else.</p>

      <div class="section" title="5.1.2.1. Composite identifier"><div class="titlepage"><div><div><h4 class="title"><a id="d5e2288"/>5.1.2.1. Composite identifier</h4></div></div></div>
        

        <p>You can define a composite primary key through several
        syntaxes:</p>

        <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
            <p>use a component type to represent the identifier and map it
            as a property in the entity: you then annotated the property as
            <code class="classname">@EmbeddedId</code>. The component type has to be
            <code class="classname">Serializable</code>.</p>
          </li><li class="listitem">
            <p>map multiple properties as <code class="classname">@Id</code>
            properties: the identifier type is then the entity class itself
            and needs to be <code class="classname">Serializable</code>. This approach
            is unfortunately not standard and only supported by
            Hibernate.</p>
          </li><li class="listitem">
            <p>map multiple properties as <code class="classname">@Id</code>
            properties and declare an external class to be the identifier
            type. This class, which needs to be
            <code class="classname">Serializable</code>, is declared on the entity via
            the <code class="classname">@IdClass</code> annotation. The identifier
            type must contain the same properties as the identifier properties
            of the entity: each property name must be the same, its type must
            be the same as well if the entity property is of a basic type, its
            type must be the type of the primary key of the associated entity
            if the entity property is an association (either a
            <code class="classname">@OneToOne</code> or a
            <code class="classname">@ManyToOne</code>).</p>
          </li></ul></div>

        <p>As you can see the last case is far from obvious. It has been
        inherited from the dark ages of EJB 2 for backward compatibilities and
        we recommend you not to use it (for simplicity sake).</p>

        <p>Let's explore all three cases using examples.</p>

        <div class="section" title="5.1.2.1.1. id as a property using a component type"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2309"/>5.1.2.1.1. id as a property using a component type</h5></div></div></div>
          

          <p>Here is a simple example of
          <code class="classname">@EmbeddedId</code>.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;firstName&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column</span><span class="java_operator">=</span><span class="java_plain">@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;fld_firstname&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>You can notice that the <code class="classname">UserId</code> class is
          serializable. To override the column mapping, use
          <code class="classname">@AttributeOverride</code>.</p>

          <p>An embedded id can itself contains the primary key of an
          associated entity.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;preferredCustomer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">MapsId</span><span class="java_separator">(</span><span class="java_literal">&quot;userId&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumns</span><span class="java_separator">({</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userfirstname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;firstName&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userlastname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;lastName&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">OneToOne</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;userId</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>In the embedded id object, the association is represented as
          the identifier of the associated entity. But you can link its value
          to a regular association in the entity via the
          <code class="classname">@MapsId</code> annotation. The
          <code class="classname">@MapsId</code> value correspond to the property name
          of the embedded id object containing the associated entity's
          identifier. In the database, it means that the
          <code class="literal">Customer.user</code> and the
          <code class="literal">CustomerId.userId</code> properties share the same
          underlying column (<code class="literal">user_fk</code> in this case).</p>

          <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Tip</h2>
            <p>The component type used as identifier must implement
            <code class="methodname">equals()</code> and
            <code class="methodname">hashCode()</code>.</p>
          </div>

          <p>In practice, your code only sets the
          <code class="literal">Customer.user</code> property and the user id value is
          copied by Hibernate into the <code class="literal">CustomerId.userId</code>
          property.</p>

          <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Warning</h2>
            <p>The id value can be copied as late as flush time, don't rely
            on it until after flush time.</p>
          </div>

          <p>While not supported in JPA, Hibernate lets you place your
          association directly in the embedded id component (instead of having
          to use the <code class="classname">@MapsId</code> annotation).</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;preferredCustomer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">OneToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumns</span><span class="java_separator">({</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userfirstname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;firstName&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userlastname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;lastName&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">})</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">;</span>
</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>Let's now rewrite these examples using the hbm.xml
          syntax.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;composite-id
        name="propertyName"
        class="ClassName"
        mapped="true|false"
        access="field|property|ClassName"
        node="element-name|."&gt;

        &lt;key-property name="propertyName" type="typename" column="column_name"/&gt;
        &lt;key-many-to-one name="propertyName" class="ClassName" column="column_name"/&gt;
        ......
&lt;/composite-id&gt;</pre>

          <p>First a simple example:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="User"&gt;
   &lt;composite-id name="id" class="UserId"&gt;
      &lt;key-property name="firstName" column="fld_firstname"/&gt;
      &lt;key-property name="lastName"/&gt;
   &lt;/composite-id&gt;
&lt;/class&gt;</pre>

          <p>Then an example showing how an association can be
          mapped.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Customer"&gt;
   &lt;composite-id name="id" class="CustomerId"&gt;
      &lt;key-property name="firstName" column="userfirstname_fk"/&gt;
      &lt;key-property name="lastName" column="userfirstname_fk"/&gt;
      &lt;key-property name="customerNumber"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="preferredCustomer"/&gt;

   &lt;many-to-one name="user"&gt;
      &lt;column name="userfirstname_fk" updatable="false" insertable="false"/&gt;
      &lt;column name="userlastname_fk" updatable="false" insertable="false"/&gt;
   &lt;/many-to-one&gt;
&lt;/class&gt;

&lt;class name="User"&gt;
   &lt;composite-id name="id" class="UserId"&gt;
      &lt;key-property name="firstName"/&gt;
      &lt;key-property name="lastName"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="age"/&gt;
&lt;/class&gt;</pre>

          <p>Notice a few things in the previous example:</p>

          <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
              <p>the order of the properties (and column) matters. It must
              be the same between the association and the primary key of the
              associated entity</p>
            </li><li class="listitem">
              <p>the many to one uses the same columns as the primary key
              and thus must be marked as read only
              (<code class="literal">insertable</code> and <code class="literal">updatable</code>
              to false).</p>
            </li><li class="listitem">
              <p>unlike with <code class="classname">@MapsId</code>, the id value
              of the associated entity is not transparently copied, check the
              <code class="literal">foreign</code> id generator for more
              information.</p>
            </li></ul></div>

          <p>The last example shows how to map association directly in the
          embedded id component.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Customer"&gt;
   &lt;composite-id name="id" class="CustomerId"&gt;
      &lt;key-many-to-one name="user"&gt;
         &lt;column name="userfirstname_fk"/&gt;
         &lt;column name="userlastname_fk"/&gt;
      &lt;/key-many-to-one&gt;
      &lt;key-property name="customerNumber"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="preferredCustomer"/&gt;
&lt;/class&gt;

&lt;class name="User"&gt;
   &lt;composite-id name="id" class="UserId"&gt;
      &lt;key-property name="firstName"/&gt;
      &lt;key-property name="lastName"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="age"/&gt;
&lt;/class&gt;</pre>

          <p>This is the recommended approach to map composite identifier.
          The following options should not be considered unless some
          constraint are present.</p>
        </div>

        <div class="section" title="5.1.2.1.2. Multiple id properties without identifier type"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2358"/>5.1.2.1.2. Multiple id properties without identifier type</h5></div></div></div>
          

          <p>Another, arguably more natural, approach is to place
          <code class="classname">@Id</code> on multiple properties of your entity.
          This approach is only supported by Hibernate (not JPA compliant) but
          does not require an extra embeddable component.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">OneToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumns</span><span class="java_separator">({</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userfirstname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;firstName&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userlastname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;lastName&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;preferredCustomer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>In this case <code class="classname">Customer</code> is its own
          identifier representation: it must implement
          <code class="classname">Serializable</code> and must implement
          <code class="methodname">equals()</code> and
          <code class="methodname">hashCode()</code>.</p>

          <p>In hbm.xml, the same mapping is:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Customer"&gt;
   &lt;composite-id&gt;
      &lt;key-many-to-one name="user"&gt;
         &lt;column name="userfirstname_fk"/&gt;
         &lt;column name="userlastname_fk"/&gt;
      &lt;/key-many-to-one&gt;
      &lt;key-property name="customerNumber"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="preferredCustomer"/&gt;
&lt;/class&gt;

&lt;class name="User"&gt;
   &lt;composite-id name="id" class="UserId"&gt;
      &lt;key-property name="firstName"/&gt;
      &lt;key-property name="lastName"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="age"/&gt;
&lt;/class&gt;</pre>
        </div>

        <div class="section" title="5.1.2.1.3. Multiple id properties with with a dedicated identifier type"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2370"/>5.1.2.1.3. Multiple id properties with with a dedicated identifier
          type</h5></div></div></div>
          

          <p><code class="classname">@IdClass</code> on an entity points to the
          class (component) representing the identifier of the class. The
          properties marked <code class="classname">@Id</code> on the entity must have
          their corresponding property on the <code class="classname">@IdClass</code>.
          The return type of search twin property must be either identical for
          basic properties or must correspond to the identifier class of the
          associated entity for an association.</p>

          <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Warning</h2>
            <p>This approach is inherited from the EJB 2 days and we
            recommend against its use. But, after all it's your application
            and Hibernate supports it.</p>
          </div>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">IdClass</span><span class="java_separator">(</span><span class="java_type">CustomerId</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">OneToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumns</span><span class="java_separator">({</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userfirstname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;firstName&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userlastname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;lastName&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">})</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;preferredCustomer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p><code class="classname">Customer</code> and
          <code class="classname">CustomerId</code> do have the same properties
          <code class="literal">customerNumber</code> as well as
          <code class="literal">user</code>. <code class="classname">CustomerId</code> must be
          <code class="classname">Serializable</code> and implement
          <code class="classname">equals()</code> and
          <code class="classname">hashCode()</code>.</p>

          <p>While not JPA standard, Hibernate let's you declare the
          vanilla associated property in the
          <code class="classname">@IdClass</code>.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">IdClass</span><span class="java_separator">(</span><span class="java_type">CustomerId</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">OneToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumns</span><span class="java_separator">({</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userfirstname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;firstName&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;userlastname_fk&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;lastName&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">})</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;preferredCustomer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">OneToOne</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;user</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EmbeddedId</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;equals&nbsp;and&nbsp;hashCode</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">UserId</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>This feature is of limited interest though as you are likely
          to have chosen the <code class="classname">@IdClass</code> approach to stay
          JPA compliant or you have a quite twisted mind.</p>

          <p>Here are the equivalent on hbm.xml files:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Customer"&gt;
   &lt;composite-id class="CustomerId" mapped="true"&gt;
      &lt;key-many-to-one name="user"&gt;
         &lt;column name="userfirstname_fk"/&gt;
         &lt;column name="userlastname_fk"/&gt;
      &lt;/key-many-to-one&gt;
      &lt;key-property name="customerNumber"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="preferredCustomer"/&gt;
&lt;/class&gt;

&lt;class name="User"&gt;
   &lt;composite-id name="id" class="UserId"&gt;
      &lt;key-property name="firstName"/&gt;
      &lt;key-property name="lastName"/&gt;
   &lt;/composite-id&gt;

   &lt;property name="age"/&gt;
&lt;/class&gt;</pre>
        </div>
      </div>

      <div class="section" title="5.1.2.2. Identifier generator"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-id-generator"/>5.1.2.2. Identifier generator</h4></div></div></div>
        

        <p>Hibernate can generate and populate identifier values for you
        automatically. This is the recommended approach over "business" or
        "natural" id (especially composite ids).</p>

        <p>Hibernate offers various generation strategies, let's explore
        the most common ones first that happens to be standardized by
        JPA:</p>

        <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
            <p>IDENTITY: supports identity columns in DB2, MySQL, MS SQL
            Server, Sybase and HypersonicSQL. The returned identifier is of
            type <code class="literal">long</code>, <code class="literal">short</code> or
            <code class="literal">int</code>.</p>
          </li><li class="listitem">
            <p>SEQUENCE (called <code class="literal">seqhilo</code> in Hibernate):
            uses a hi/lo algorithm to efficiently generate identifiers of type
            <code class="literal">long</code>, <code class="literal">short</code> or
            <code class="literal">int</code>, given a named database sequence.</p>
          </li><li class="listitem">
            <p>TABLE (called
            <code class="classname">MultipleHiLoPerTableGenerator</code> in Hibernate)
            : uses a hi/lo algorithm to efficiently generate identifiers of
            type <code class="literal">long</code>, <code class="literal">short</code> or
            <code class="literal">int</code>, given a table and column as a source of hi
            values. The hi/lo algorithm generates identifiers that are unique
            only for a particular database.</p>
          </li><li class="listitem">
            <p>AUTO: selects <code class="literal">IDENTITY</code>,
            <code class="literal">SEQUENCE</code> or <code class="literal">TABLE</code> depending
            upon the capabilities of the underlying database.</p>
          </li></ul></div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Important</h2>
          <p>We recommend all new projects to use the new enhanced
          identifier generators. They are deactivated by default for entities
          using annotations but can be activated using
          <code class="code">hibernate.id.new_generator_mappings=true</code>. These new
          generators are more efficient and closer to the JPA 2 specification
          semantic.</p>

          <p>However they are not backward compatible with existing
          Hibernate based application (if a sequence or a table is used for id
          generation). See XXXXXXX <a class="xref" href="">???</a> for
          more information on how to activate them.</p>
        </div>

        <p>To mark an id property as generated, use the
        <code class="classname">@GeneratedValue</code> annotation. You can specify the
        strategy used (default to <code class="literal">AUTO</code>) by setting
        <code class="literal">strategy</code>.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
public class Customer {
   @Id @GeneratedValue
   Integer getId() { ... };
}

@Entity 
public class Invoice {
   @Id @GeneratedValue(strategy=GenerationType.IDENTITY)
   Integer getId() { ... };
}</pre>

        <p><code class="literal">SEQUENCE</code> and <code class="literal">TABLE</code> require
        additional configurations that you can set using
        <code class="classname">@SequenceGenerator</code> and
        <code class="classname">@TableGenerator</code>:</p>

        <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
            <p><code class="literal">name</code>: name of the generator</p>
          </li><li class="listitem">
            <p><code class="literal">table</code> / <code class="literal">sequenceName</code>:
            name of the table or the sequence (defaulting respectively to
            <code class="literal">hibernate_sequences</code> and
            <code class="literal">hibernate_sequence</code>)</p>
          </li><li class="listitem">
            <p><code class="literal">catalog</code> /
            <code class="literal">schema</code>:</p>
          </li><li class="listitem">
            <p><code class="literal">initialValue</code>: the value from which the id
            is to start generating</p>
          </li><li class="listitem">
            <p><code class="literal">allocationSize</code>: the amount to increment
            by when allocating id numbers from the generator</p>
          </li></ul></div>

        <p>In addition, the <code class="classname">TABLE</code> strategy also let
        you customize:</p>

        <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
            <p><code class="literal">pkColumnName</code>: the column name containing
            the entity identifier</p>
          </li><li class="listitem">
            <p><code class="literal">valueColumnName</code>: the column name
            containing the identifier value</p>
          </li><li class="listitem">
            <p><code class="literal">pkColumnValue</code>: the entity
            identifier</p>
          </li><li class="listitem">
            <p><code class="literal">uniqueConstraints</code>: any potential column
            constraint on the table containing the ids</p>
          </li></ul></div>

        <p>To link a table or sequence generator definition with an actual
        generated property, use the same name in both the definition
        <code class="literal">name</code> and the generator value
        <code class="literal">generator</code> as shown below.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Id</span><!-- <br/> --><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GeneratedValue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;strategy</span><span class="java_operator">=</span><span class="java_type">GenerationType</span><span class="java_separator">.</span><span class="java_plain">SEQUENCE</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;generator</span><span class="java_operator">=</span><span class="java_literal">&quot;SEQ_GEN&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@javax</span><span class="java_separator">.</span><span class="java_plain">persistence</span><span class="java_separator">.</span><span class="java_type">SequenceGenerator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;SEQ_GEN&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;sequenceName</span><span class="java_operator">=</span><span class="java_literal">&quot;my_sequence&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;allocationSize</span><span class="java_operator">=</span><span class="java_literal">20</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>The scope of a generator definition can be the application or
        the class. Class-defined generators are not visible outside the class
        and can override application level generators. Application level
        generators are defined in JPA's XML deployment descriptors (see XXXXXX
        <a class="xref" href="">???</a>):</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_plain">table</span><!-- <br/> --><span class="java_operator">-</span><!-- <br/> --><span class="java_plain">generator&nbsp;name</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_literal">&quot;EMP_GEN&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table</span><span class="java_operator">=</span><span class="java_literal">&quot;GENERATOR_TABLE&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk</span><span class="java_operator">-</span><span class="java_plain">column</span><span class="java_operator">-</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;key&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value</span><span class="java_operator">-</span><span class="java_plain">column</span><span class="java_operator">-</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;hi&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk</span><span class="java_operator">-</span><span class="java_plain">column</span><span class="java_operator">-</span><span class="java_plain">value</span><span class="java_operator">=</span><span class="java_literal">&quot;EMP&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allocation</span><span class="java_operator">-</span><span class="java_plain">size</span><span class="java_operator">=</span><span class="java_literal">&quot;20&quot;</span><span class="java_operator">/&gt;</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">and&nbsp;the&nbsp;annotation&nbsp;equivalent</span>
</span>
<!--  --><br/><span class="java_plain">@javax</span><span class="java_separator">.</span><span class="java_plain">persistence</span><span class="java_separator">.</span><span class="java_type">TableGenerator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;EMP_GEN&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;table</span><span class="java_operator">=</span><span class="java_literal">&quot;GENERATOR_TABLE&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;pkColumnName&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;key&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;valueColumnName&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;hi&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;pkColumnValue</span><span class="java_operator">=</span><span class="java_literal">&quot;EMP&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;allocationSize</span><span class="java_operator">=</span><span class="java_literal">20</span>
<!--  --><br/><span class="java_separator">)</span>
</span>
<!--  --><br/><span class="java_operator">&lt;</span><span class="java_plain">sequence</span><span class="java_operator">-</span><span class="java_plain">generator&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;SEQ_GEN&quot;</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;sequence</span><span class="java_operator">-</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;my_sequence&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;allocation</span><span class="java_operator">-</span><span class="java_plain">size</span><span class="java_operator">=</span><span class="java_literal">&quot;20&quot;</span><span class="java_operator">/&gt;</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">and&nbsp;the&nbsp;annotation&nbsp;equivalent</span>
</span>
<!--  --><br/><span class="java_plain">@javax</span><span class="java_separator">.</span><span class="java_plain">persistence</span><span class="java_separator">.</span><span class="java_type">SequenceGenerator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;SEQ_GEN&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;sequenceName</span><span class="java_operator">=</span><span class="java_literal">&quot;my_sequence&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;allocationSize</span><span class="java_operator">=</span><span class="java_literal">20</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>If a JPA XML descriptor (like
        <code class="filename">META-INF/orm.xml</code>) is used to define the
        generators, <code class="literal">EMP_GEN</code> and <code class="literal">SEQ_GEN</code>
        are application level generators.</p>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>Package level definition is not supported by the JPA
          specification. However, you can use the
          <code class="literal">@GenericGenerator</code> at the package level (see <a class="xref" href="">???</a>).</p>
        </div>

        <p>These are the four standard JPA generators. Hibernate goes
        beyond that and provide additional generators or additional options as
        we will see below. You can also write your own custom identifier
        generator by implementing
        <code class="classname">org.hibernate.id.IdentifierGenerator</code>.</p>

        <p>To define a custom generator, use the
        <code class="classname">@GenericGenerator</code> annotation (and its plural
        counter part <code class="classname">@GenericGenerators</code>) that describes
        the class of the identifier generator or its short cut name (as
        described below) and a list of key/value parameters. When using
        <code class="classname">@GenericGenerator</code> and assigning it via
        <code class="classname">@GeneratedValue.generator</code>, the
        <code class="classname">@GeneratedValue.strategy</code> is ignored: leave it
        blank.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Id</span><!-- <br/> --><span class="java_plain">&nbsp;@</span><!-- <br/> --><span class="java_type">GeneratedValue</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">generator</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_literal">&quot;system-uuid&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GenericGenerator</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;system-uuid&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;strategy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;uuid&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span><span class="java_separator">(</span><span class="java_plain">generator</span><span class="java_operator">=</span><span class="java_literal">&quot;trigger-generated&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GenericGenerator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;trigger-generated&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;strategy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;select&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Parameter</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;key&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;socialSecurityNumber&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span></pre>

        <p>The hbm.xml approach uses the optional
        <code class="literal">&lt;generator&gt;</code> child element inside
        <code class="literal">&lt;id&gt;</code>. If any parameters are required to
        configure or initialize the generator instance, they are passed using
        the <code class="literal">&lt;param&gt;</code> element.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="org.hibernate.id.TableHiLoGenerator"&gt;
                &lt;param name="table"&gt;uid_table&lt;/param&gt;
                &lt;param name="column"&gt;next_hi_value_column&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre>

        <div class="section" title="5.1.2.2.1. Various additional generators"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2501"/>5.1.2.2.1. Various additional generators</h5></div></div></div>
          

          <p>All generators implement the interface
          <code class="literal">org.hibernate.id.IdentifierGenerator</code>. This is a
          very simple interface. Some applications can choose to provide their
          own specialized implementations, however, Hibernate provides a range
          of built-in implementations. The shortcut names for the built-in
          generators are as follows: </p><div class="variablelist"><dl><dt><span class="term"><code class="literal">increment</code></span></dt><dd>
                  <p>generates identifiers of type <code class="literal">long</code>,
                  <code class="literal">short</code> or <code class="literal">int</code> that are
                  unique only when no other process is inserting data into the
                  same table. <span class="emphasis"><em>Do not use in a
                  cluster.</em></span></p>
                </dd><dt><span class="term"><code class="literal">identity</code></span></dt><dd>
                  <p>supports identity columns in DB2, MySQL, MS SQL
                  Server, Sybase and HypersonicSQL. The returned identifier is
                  of type <code class="literal">long</code>, <code class="literal">short</code> or
                  <code class="literal">int</code>.</p>
                </dd><dt><span class="term"><code class="literal">sequence</code></span></dt><dd>
                  <p>uses a sequence in DB2, PostgreSQL, Oracle, SAP DB,
                  McKoi or a generator in Interbase. The returned identifier
                  is of type <code class="literal">long</code>, <code class="literal">short</code>
                  or <code class="literal">int</code></p>
                </dd><dt><span class="term"><code class="literal">hilo</code></span></dt><dd>
                  <p><a id="mapping-declaration-id-hilodescription"/>uses a hi/lo algorithm to efficiently generate
                  identifiers of type <code class="literal">long</code>,
                  <code class="literal">short</code> or <code class="literal">int</code>, given a
                  table and column (by default
                  <code class="literal">hibernate_unique_key</code> and
                  <code class="literal">next_hi</code> respectively) as a source of hi
                  values. The hi/lo algorithm generates identifiers that are
                  unique only for a particular database.</p>
                </dd><dt><span class="term"><code class="literal">seqhilo</code></span></dt><dd>
                  <p>uses a hi/lo algorithm to efficiently generate
                  identifiers of type <code class="literal">long</code>,
                  <code class="literal">short</code> or <code class="literal">int</code>, given a
                  named database sequence.</p>
                </dd><dt><span class="term"><code class="literal">uuid</code></span></dt><dd>
                  <p>Generates a 128-bit UUID based on a custom algorithm.
                  The value generated is represented as a string of 32
                  hexidecimal digits. Users can also configure it to use a
                  separator (config parameter "separator") which separates the
                  hexidecimal digits into 8{sep}8{sep}4{sep}8{sep}4. Note
                  specifically that this is different than the IETF RFC 4122
                  representation of 8-4-4-4-12. If you need RFC 4122 compliant
                  UUIDs, consider using "uuid2" generator discussed
                  below.</p>
                </dd><dt><span class="term"><code class="literal">uuid2</code></span></dt><dd>
                  <p>Generates a IETF RFC 4122 compliant (variant 2)
                  128-bit UUID. The exact "version" (the RFC term) generated
                  depends on the pluggable "generation strategy" used (see
                  below). Capable of generating values as
                  <code class="classname">java.util.UUID</code>,
                  <code class="classname">java.lang.String</code> or as a byte array
                  of length 16 (<code class="literal">byte[16]</code>). The "generation
                  strategy" is defined by the interface
                  <code class="interfacename">org.hibernate.id.UUIDGenerationStrategy</code>.
                  The generator defines 2 configuration parameters for
                  defining which generation strategy to use: </p><div class="variablelist"><dl><dt><span class="term"><code class="literal">uuid_gen_strategy_class</code></span></dt><dd>
                          <p>Names the UUIDGenerationStrategy class to
                          use</p>
                        </dd><dt><span class="term"><code class="literal">uuid_gen_strategy</code></span></dt><dd>
                          <p>Names the UUIDGenerationStrategy instance to
                          use</p>
                        </dd></dl></div>

                  <p>Out of the box, comes with the following strategies:
                  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
                        <p><code class="classname">org.hibernate.id.uuid.StandardRandomStrategy</code>
                        (the default) - generates "version 3" (aka, "random")
                        UUID values via the
                        <code class="methodname">randomUUID</code> method of
                        <code class="classname">java.util.UUID</code></p>
                      </li><li class="listitem">
                        <p><code class="classname">org.hibernate.id.uuid.CustomVersionOneStrategy</code>
                        - generates "version 1" UUID values, using IP address
                        since mac address not available. If you need mac
                        address to be used, consider leveraging one of the
                        existing third party UUID generators which sniff out
                        mac address and integrating it via the
                        <code class="interfacename">org.hibernate.id.UUIDGenerationStrategy</code>
                        contract. Two such libraries known at time of this
                        writing include <a class="ulink" href="http://johannburkard.de/software/uuid/">http://johannburkard.de/software/uuid/</a>
                        and <a class="ulink" href="http://commons.apache.org/sandbox/id/uuid.html">http://commons.apache.org/sandbox/id/uuid.html</a>
                        </p>
                      </li></ul></div>
                </dd><dt><span class="term"><code class="literal">guid</code></span></dt><dd>
                  <p>uses a database-generated GUID string on MS SQL Server
                  and MySQL.</p>
                </dd><dt><span class="term"><code class="literal">native</code></span></dt><dd>
                  <p>selects <code class="literal">identity</code>,
                  <code class="literal">sequence</code> or <code class="literal">hilo</code>
                  depending upon the capabilities of the underlying
                  database.</p>
                </dd><dt><span class="term"><code class="literal">assigned</code></span></dt><dd>
                  <p>lets the application assign an identifier to the
                  object before <code class="literal">save()</code> is called. This is
                  the default strategy if no
                  <code class="literal">&lt;generator&gt;</code> element is
                  specified.</p>
                </dd><dt><span class="term"><code class="literal">select</code></span></dt><dd>
                  <p>retrieves a primary key, assigned by a database
                  trigger, by selecting the row by some unique key and
                  retrieving the primary key value.</p>
                </dd><dt><span class="term"><code class="literal">foreign</code></span></dt><dd>
                  <p>uses the identifier of another associated object. It
                  is usually used in conjunction with a
                  <code class="literal">&lt;one-to-one&gt;</code> primary key
                  association.</p>
                </dd><dt><span class="term"><code class="literal">sequence-identity</code></span></dt><dd>
                  <p>a specialized sequence generation strategy that
                  utilizes a database sequence for the actual value
                  generation, but combines this with JDBC3 getGeneratedKeys to
                  return the generated identifier value as part of the insert
                  statement execution. This strategy is only supported on
                  Oracle 10g drivers targeted for JDK 1.4. Comments on these
                  insert statements are disabled due to a bug in the Oracle
                  drivers.</p>
                </dd></dl></div>
        </div>

        <div class="section" title="5.1.2.2.2. Hi/lo algorithm"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-id-hilo"/>5.1.2.2.2. Hi/lo algorithm</h5></div></div></div>
          

          <p>The <code class="literal">hilo</code> and <code class="literal">seqhilo</code>
          generators provide two alternate implementations of the hi/lo
          algorithm. The first implementation requires a "special" database
          table to hold the next available "hi" value. Where supported, the
          second uses an Oracle-style sequence.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="hilo"&gt;
                &lt;param name="table"&gt;hi_value&lt;/param&gt;
                &lt;param name="column"&gt;next_value&lt;/param&gt;
                &lt;param name="max_lo"&gt;100&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="seqhilo"&gt;
                &lt;param name="sequence"&gt;hi_value&lt;/param&gt;
                &lt;param name="max_lo"&gt;100&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre>

          <p>Unfortunately, you cannot use <code class="literal">hilo</code> when
          supplying your own <code class="literal">Connection</code> to Hibernate. When
          Hibernate uses an application server datasource to obtain
          connections enlisted with JTA, you must configure the
          <code class="literal">hibernate.transaction.manager_lookup_class</code>.</p>
        </div>

        <div class="section" title="5.1.2.2.3. UUID algorithm"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-id-uuid"/>5.1.2.2.3. UUID algorithm</h5></div></div></div>
          

          <p>The UUID contains: IP address, startup time of the JVM that is
          accurate to a quarter second, system time and a counter value that
          is unique within the JVM. It is not possible to obtain a MAC address
          or memory address from Java code, so this is the best option without
          using JNI.</p>
        </div>

        <div class="section" title="5.1.2.2.4. Identity columns and sequences"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-id-sequences"/>5.1.2.2.4. Identity columns and sequences</h5></div></div></div>
          

          <p>For databases that support identity columns (DB2, MySQL,
          Sybase, MS SQL), you can use <code class="literal">identity</code> key
          generation. For databases that support sequences (DB2, Oracle,
          PostgreSQL, Interbase, McKoi, SAP DB) you can use
          <code class="literal">sequence</code> style key generation. Both of these
          strategies require two SQL queries to insert a new object. For
          example:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id name="id" type="long" column="person_id"&gt;
        &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;person_id_sequence&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id name="id" type="long" column="person_id" unsaved-value="0"&gt;
        &lt;generator class="identity"/&gt;
&lt;/id&gt;</pre>

          <p>For cross-platform development, the <code class="literal">native</code>
          strategy will, depending on the capabilities of the underlying
          database, choose from the <code class="literal">identity</code>,
          <code class="literal">sequence</code> and <code class="literal">hilo</code>
          strategies.</p>
        </div>

        <div class="section" title="5.1.2.2.5. Assigned identifiers"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-id-assigned"/>5.1.2.2.5. Assigned identifiers</h5></div></div></div>
          

          <p>If you want the application to assign identifiers, as opposed
          to having Hibernate generate them, you can use the
          <code class="literal">assigned</code> generator. This special generator uses
          the identifier value already assigned to the object's identifier
          property. The generator is used when the primary key is a natural
          key instead of a surrogate key. This is the default behavior if you
          do not specify <code class="classname">@GeneratedValue</code> nor
          <code class="literal">&lt;generator&gt;</code> elements.</p>

          <p>The <code class="literal">assigned</code> generator makes Hibernate use
          <code class="literal">unsaved-value="undefined"</code>. This forces Hibernate
          to go to the database to determine if an instance is transient or
          detached, unless there is a version or timestamp property, or you
          define <code class="literal">Interceptor.isUnsaved()</code>.</p>
        </div>

        <div class="section" title="5.1.2.2.6. Primary keys assigned by triggers"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-id-select"/>5.1.2.2.6. Primary keys assigned by triggers</h5></div></div></div>
          

          <p>Hibernate does not generate DDL with triggers. It is for
          legacy schemas only.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;id name="id" type="long" column="person_id"&gt;
        &lt;generator class="select"&gt;
                &lt;param name="key"&gt;socialSecurityNumber&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre>

          <p>In the above example, there is a unique valued property named
          <code class="literal">socialSecurityNumber</code>. It is defined by the class,
          as a natural key and a surrogate key named
          <code class="literal">person_id</code>, whose value is generated by a
          trigger.</p>
        </div>

        <div class="section" title="5.1.2.2.7. Identity copy (foreign generator)"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2666"/>5.1.2.2.7. Identity copy (foreign generator)</h5></div></div></div>
          

          <p>Finally, you can ask Hibernate to copy the identifier from
          another associated entity. In the Hibernate jargon, it is known as a
          foreign generator but the JPA mapping reads better and is
          encouraged.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MedicalHistory</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">OneToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;person_id&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;patient</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>Or alternatively</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MedicalHistory</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">MapsId</span><span class="java_plain">&nbsp;@</span><span class="java_type">OneToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;patient_id&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;patient</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>In hbm.xml use the following approach:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="MedicalHistory"&gt;
   &lt;id name="id"&gt;
      &lt;generator class="foreign"&gt;
         &lt;param name="property"&gt;patient&lt;/param&gt;
      &lt;/generator&gt;
   &lt;/id&gt;
   &lt;one-to-one name="patient" class="Person" constrained="true"/&gt;
&lt;/class&gt;</pre>
        </div>
      </div>

      <div class="section" title="5.1.2.3. Enhanced identifier generators"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-id-enhanced"/>5.1.2.3. Enhanced identifier generators</h4></div></div></div>
        

        <p>Starting with release 3.2.3, there are 2 new generators which
        represent a re-thinking of 2 different aspects of identifier
        generation. The first aspect is database portability; the second is
        optimization Optimization means that you do not have to query the
        database for every request for a new identifier value. These two new
        generators are intended to take the place of some of the named
        generators described above, starting in 3.3.x. However, they are
        included in the current releases and can be referenced by FQN.</p>

        <p>The first of these new generators is
        <code class="literal">org.hibernate.id.enhanced.SequenceStyleGenerator</code>
        which is intended, firstly, as a replacement for the
        <code class="literal">sequence</code> generator and, secondly, as a better
        portability generator than <code class="literal">native</code>. This is because
        <code class="literal">native</code> generally chooses between
        <code class="literal">identity</code> and <code class="literal">sequence</code> which have
        largely different semantics that can cause subtle issues in
        applications eyeing portability.
        <code class="literal">org.hibernate.id.enhanced.SequenceStyleGenerator</code>,
        however, achieves portability in a different manner. It chooses
        between a table or a sequence in the database to store its
        incrementing values, depending on the capabilities of the dialect
        being used. The difference between this and <code class="literal">native</code>
        is that table-based and sequence-based storage have the same exact
        semantic. In fact, sequences are exactly what Hibernate tries to
        emulate with its table-based generators. This generator has a number
        of configuration parameters: </p><div class="itemizedlist"><ul class="itemizedlist" compact="compact"><li class="listitem">
              <p><code class="literal">sequence_name</code> (optional, defaults to
              <code class="literal">hibernate_sequence</code>): the name of the sequence
              or table to be used.</p>
            </li><li class="listitem">
              <p><code class="literal">initial_value</code> (optional, defaults to
              <code class="literal">1</code>): the initial value to be retrieved from
              the sequence/table. In sequence creation terms, this is
              analogous to the clause typically named "STARTS WITH".</p>
            </li><li class="listitem">
              <p><code class="literal">increment_size</code> (optional - defaults to
              <code class="literal">1</code>): the value by which subsequent calls to
              the sequence/table should differ. In sequence creation terms,
              this is analogous to the clause typically named "INCREMENT
              BY".</p>
            </li><li class="listitem">
              <p><code class="literal">force_table_use</code> (optional - defaults to
              <code class="literal">false</code>): should we force the use of a table as
              the backing structure even though the dialect might support
              sequence?</p>
            </li><li class="listitem">
              <p><code class="literal">value_column</code> (optional - defaults to
              <code class="literal">next_val</code>): only relevant for table
              structures, it is the name of the column on the table which is
              used to hold the value.</p>
            </li><li class="listitem">
              <p><code class="literal">prefer_sequence_per_entity</code> (optional -
              defaults to <code class="literal">false</code>): should we create
              separate sequence for each entity that share current generator
              based on its name?</p>
            </li><li class="listitem">
              <p><code class="literal">sequence_per_entity_suffix</code> (optional -
              defaults to <code class="literal">_SEQ</code>): suffix added to the name
              of a dedicated sequence.</p>
            </li><li class="listitem">
              <p><code class="literal">optimizer</code> (optional - defaults to
              <code class="literal">none</code>): See <a class="xref" href="ch05.html#mapping-declaration-id-enhanced-optimizers" title="5.1.2.3.1. Identifier generator optimization">Section 5.1.2.3.1, “Identifier generator optimization”</a></p>
            </li></ul></div>

        <p>The second of these new generators is
        <code class="literal">org.hibernate.id.enhanced.TableGenerator</code>, which is
        intended, firstly, as a replacement for the <code class="literal">table</code>
        generator, even though it actually functions much more like
        <code class="literal">org.hibernate.id.MultipleHiLoPerTableGenerator</code>, and
        secondly, as a re-implementation of
        <code class="literal">org.hibernate.id.MultipleHiLoPerTableGenerator</code> that
        utilizes the notion of pluggable optimizers. Essentially this
        generator defines a table capable of holding a number of different
        increment values simultaneously by using multiple distinctly keyed
        rows. This generator has a number of configuration parameters:
        </p><div class="itemizedlist"><ul class="itemizedlist" compact="compact"><li class="listitem">
              <p><code class="literal">table_name</code> (optional - defaults to
              <code class="literal">hibernate_sequences</code>): the name of the table
              to be used.</p>
            </li><li class="listitem">
              <p><code class="literal">value_column_name</code> (optional - defaults
              to <code class="literal">next_val</code>): the name of the column on the
              table that is used to hold the value.</p>
            </li><li class="listitem">
              <p><code class="literal">segment_column_name</code> (optional -
              defaults to <code class="literal">sequence_name</code>): the name of the
              column on the table that is used to hold the "segment key". This
              is the value which identifies which increment value to
              use.</p>
            </li><li class="listitem">
              <p><code class="literal">segment_value</code> (optional - defaults to
              <code class="literal">default</code>): The "segment key" value for the
              segment from which we want to pull increment values for this
              generator.</p>
            </li><li class="listitem">
              <p><code class="literal">segment_value_length</code> (optional -
              defaults to <code class="literal">255</code>): Used for schema generation;
              the column size to create this segment key column.</p>
            </li><li class="listitem">
              <p><code class="literal">initial_value</code> (optional - defaults to
              <code class="literal">1</code>): The initial value to be retrieved from
              the table.</p>
            </li><li class="listitem">
              <p><code class="literal">increment_size</code> (optional - defaults to
              <code class="literal">1</code>): The value by which subsequent calls to
              the table should differ.</p>
            </li><li class="listitem">
              <p><code class="literal">optimizer</code> (optional - defaults to
              <code class="literal">??</code>): See <a class="xref" href="ch05.html#mapping-declaration-id-enhanced-optimizers" title="5.1.2.3.1. Identifier generator optimization">Section 5.1.2.3.1, “Identifier generator optimization”</a>.</p>
            </li></ul></div>

        <div class="section" title="5.1.2.3.1. Identifier generator optimization"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-id-enhanced-optimizers"/>5.1.2.3.1. Identifier generator optimization</h5></div></div></div>
          

          <p>For identifier generators that store values in the database,
          it is inefficient for them to hit the database on each and every
          call to generate a new identifier value. Instead, you can group a
          bunch of them in memory and only hit the database when you have
          exhausted your in-memory value group. This is the role of the
          pluggable optimizers. Currently only the two enhanced generators
          (<a class="xref" href="ch05.html#mapping-declaration-id-enhanced" title="5.1.2.3. Enhanced identifier generators">Section 5.1.2.3, “Enhanced identifier generators”</a> support this
          operation.</p>

          <div class="itemizedlist"><ul class="itemizedlist" compact="compact"><li class="listitem">
              <p><code class="literal">none</code> (generally this is the default if
              no optimizer was specified): this will not perform any
              optimizations and hit the database for each and every
              request.</p>
            </li><li class="listitem">
              <p><code class="literal">hilo</code>: applies a hi/lo algorithm around
              the database retrieved values. The values from the database for
              this optimizer are expected to be sequential. The values
              retrieved from the database structure for this optimizer
              indicates the "group number". The
              <code class="literal">increment_size</code> is multiplied by that value in
              memory to define a group "hi value".</p>
            </li><li class="listitem">
              <p><code class="literal">pooled</code>: as with the case of
              <code class="literal">hilo</code>, this optimizer attempts to minimize the
              number of hits to the database. Here, however, we simply store
              the starting value for the "next group" into the database
              structure rather than a sequential value in combination with an
              in-memory grouping algorithm. Here,
              <code class="literal">increment_size</code> refers to the values coming
              from the database.</p>
            </li></ul></div>
        </div>
      </div>

      <div class="section" title="5.1.2.4. Partial identifier generation"><div class="titlepage"><div><div><h4 class="title"><a id="d5e2776"/>5.1.2.4. Partial identifier generation</h4></div></div></div>
        

        <p>Hibernate supports the automatic generation of some of the
        identifier properties. Simply use the
        <code class="classname">@GeneratedValue</code> annotation on one or several id
        properties.</p>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Warning</h2>
          <p>The Hibernate team has always felt such a construct as
          fundamentally wrong. Try hard to fix your data model before using
          this feature.</p>
        </div>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CustomerInventory</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">Id</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">TableGenerator</span><span class="java_separator">(</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;inventory&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;table&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;U_SEQUENCES&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;pkColumnName&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;S_ID&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;valueColumnName&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;S_NEXTNUM&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;pkColumnValue&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;inventory&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;allocationSize&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">1000</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">GeneratedValue</span><span class="java_separator">(</span><span class="java_plain">strategy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">GenerationType</span><span class="java_separator">.</span><span class="java_plain">TABLE</span><span class="java_separator">,</span><span class="java_plain">&nbsp;generator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;inventory&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">ManyToOne</span><span class="java_separator">(</span><span class="java_plain">cascade&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">MERGE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>You can also generate properties inside an
        <code class="classname">@EmbeddedId</code> class.</p>
      </div>
    </div>

    <div class="section" title="5.1.3. Optimistic locking properties (optional)"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2785"/>5.1.3. Optimistic locking properties (optional)</h3></div></div></div>
      

      <p>When using long transactions or conversations that span several
      database transactions, it is useful to store versioning data to ensure
      that if the same entity is updated by two conversations, the last to
      commit changes will be informed and not override the other
      conversation's work. It guarantees some isolation while still allowing
      for good scalability and works particularly well in read-often
      write-sometimes situations.</p>

      <p>You can use two approaches: a dedicated version number or a
      timestamp.</p>

      <p>A version or timestamp property should never be null for a
      detached instance. Hibernate will detect any instance with a null
      version or timestamp as transient, irrespective of what other
      <code class="literal">unsaved-value</code> strategies are specified.
      <span class="emphasis"><em>Declaring a nullable version or timestamp property is an easy
      way to avoid problems with transitive reattachment in Hibernate. It is
      especially useful for people using assigned identifiers or composite
      keys</em></span>.</p>

      <div class="section" title="5.1.3.1. Version number"><div class="titlepage"><div><div><h4 class="title"><a id="entity-mapping-entity-version"/>5.1.3.1. Version number</h4></div></div></div>
        

        <p>You can add optimistic locking capability to an entity using the
        <code class="literal">@Version</code> annotation:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Version</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;OPTLOCK&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;getVersion</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>The version property will be mapped to the
        <code class="literal">OPTLOCK</code> column, and the entity manager will use it
        to detect conflicting updates (preventing lost updates you might
        otherwise see with the last-commit-wins strategy).</p>

        <p>The version column may be a numeric. Hibernate supports any kind
        of type provided that you define and implement the appropriate
        <code class="classname">UserVersionType</code>.</p>

        <p>The application must not alter the version number set up by
        Hibernate in any way. To artificially increase the version number,
        check in Hibernate Entity Manager's reference documentation
        <code class="literal">LockModeType.OPTIMISTIC_FORCE_INCREMENT</code> or
        <code class="literal">LockModeType.PESSIMISTIC_FORCE_INCREMENT</code>.</p>

        <p>If the version number is generated by the database (via a
        trigger for example), make sure to use
        <code class="code">@org.hibernate.annotations.Generated(GenerationTime.ALWAYS).</code></p>

        <p>To declare a version property in hbm.xml, use:</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;version
        column="version_column"                            <span class="co" id="version1"><img src="images/callouts/1.png" alt="(1)"/></span>
        name="propertyName"                                <span class="co" id="version2"><img src="images/callouts/2.png" alt="(2)"/></span>
        type="typename"                                    <span class="co" id="version3"><img src="images/callouts/3.png" alt="(3)"/></span>
        access="field|property|ClassName"                  <span class="co" id="version4"><img src="images/callouts/4.png" alt="(4)"/></span>
        unsaved-value="null|negative|undefined"            <span class="co" id="version5"><img src="images/callouts/5.png" alt="(5)"/></span>
        generated="never|always"                           <span class="co" id="version6"><img src="images/callouts/6.png" alt="(6)"/></span>
        insert="true|false"                                <span class="co" id="version7"><img src="images/callouts/7.png" alt="(7)"/></span>
        node="element-name|@attribute-name|element/@attribute|."
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">column</code> (optional - defaults to the
              property name): the name of the column holding the version
              number.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the name of a property of the
              persistent class.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">type</code> (optional - defaults to
              <code class="literal">integer</code>): the type of the version
              number.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">access</code> (optional - defaults to
              <code class="literal">property</code>): the strategy Hibernate uses to
              access the property value.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">unsaved-value</code> (optional - defaults to
              <code class="literal">undefined</code>): a version property value that
              indicates that an instance is newly instantiated (unsaved),
              distinguishing it from detached instances that were saved or
              loaded in a previous session. <code class="literal">Undefined</code>
              specifies that the identifier property value should be
              used.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">generated</code> (optional - defaults to
              <code class="literal">never</code>): specifies that this version property
              value is generated by the database. See the discussion of <a class="link" href="ch05.html#mapping-generated" title="5.5. Generated properties">generated properties</a> for more
              information.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">insert</code> (optional - defaults to
              <code class="literal">true</code>): specifies whether the version column
              should be included in SQL insert statements. It can be set to
              <code class="literal">false</code> if the database column is defined with
              a default value of <code class="literal">0</code>.</p>
            </td></tr></table></div></div>
      </div>

      <div class="section" title="5.1.3.2. Timestamp"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-timestamp"/>5.1.3.2. Timestamp</h4></div></div></div>
        

        <p>Alternatively, you can use a timestamp. Timestamps are a less
        safe implementation of optimistic locking. However, sometimes an
        application might use the timestamps in other ways as well.</p>

        <p>Simply mark a property of type <code class="classname">Date</code> or
        <code class="classname">Calendar</code> as
        <code class="classname">@Version</code>.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Version</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;getLastUpdate</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>When using timestamp versioning you can tell Hibernate where to
        retrieve the timestamp value from - database or JVM - by optionally
        adding the <code class="classname">@org.hibernate.annotations.Source</code>
        annotation to the property. Possible values for the value attribute of
        the annotation are
        <code class="classname">org.hibernate.annotations.SourceType.VM</code> and
        <code class="classname">org.hibernate.annotations.SourceType.DB</code>. The
        default is <code class="classname">SourceType.DB</code> which is also used in
        case there is no <code class="classname">@Source</code> annotation at
        all.</p>

        <p>Like in the case of version numbers, the timestamp can also be
        generated by the database instead of Hibernate. To do that, use
        <code class="code">@org.hibernate.annotations.Generated(GenerationTime.ALWAYS).</code></p>

        <p>In hbm.xml, use the <code class="literal">&lt;timestamp&gt;</code>
        element:</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;timestamp
        column="timestamp_column"                          <span class="co" id="timestamp1"><img src="images/callouts/1.png" alt="(1)"/></span>
        name="propertyName"                                <span class="co" id="timestamp2"><img src="images/callouts/2.png" alt="(2)"/></span>
        access="field|property|ClassName"                  <span class="co" id="timestamp3"><img src="images/callouts/3.png" alt="(3)"/></span>
        unsaved-value="null|undefined"                     <span class="co" id="timestamp4"><img src="images/callouts/4.png" alt="(4)"/></span>
        source="vm|db"                                     <span class="co" id="timestamp5"><img src="images/callouts/5.png" alt="(5)"/></span>
        generated="never|always"                           <span class="co" id="timestamp6"><img src="images/callouts/6.png" alt="(6)"/></span>
        node="element-name|@attribute-name|element/@attribute|."
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">column</code> (optional - defaults to the
              property name): the name of a column holding the
              timestamp.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the name of a JavaBeans style
              property of Java type <code class="literal">Date</code> or
              <code class="literal">Timestamp</code> of the persistent class.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">access</code> (optional - defaults to
              <code class="literal">property</code>): the strategy Hibernate uses for
              accessing the property value.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">unsaved-value</code> (optional - defaults to
              <code class="literal">null</code>): a version property value that
              indicates that an instance is newly instantiated (unsaved),
              distinguishing it from detached instances that were saved or
              loaded in a previous session. <code class="literal">Undefined</code>
              specifies that the identifier property value should be
              used.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">source</code> (optional - defaults to
              <code class="literal">vm</code>): Where should Hibernate retrieve the
              timestamp value from? From the database, or from the current
              JVM? Database-based timestamps incur an overhead because
              Hibernate must hit the database in order to determine the "next
              value". It is safer to use in clustered environments. Not all
              <code class="literal">Dialects</code> are known to support the retrieval
              of the database's current timestamp. Others may also be unsafe
              for usage in locking due to lack of precision (Oracle 8, for
              example).</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">generated</code> (optional - defaults to
              <code class="literal">never</code>): specifies that this timestamp
              property value is actually generated by the database. See the
              discussion of <a class="link" href="ch05.html#mapping-generated" title="5.5. Generated properties">generated
              properties</a> for more information.</p>
            </td></tr></table></div></div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          

          <p><code class="literal">&lt;Timestamp&gt;</code> is equivalent to
          <code class="literal">&lt;version type="timestamp"&gt;</code>. And
          <code class="literal">&lt;timestamp source="db"&gt;</code> is equivalent to
          <code class="literal">&lt;version type="dbtimestamp"&gt;</code></p>
        </div>
      </div>
    </div>

    <div class="section" title="5.1.4. Property"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-declaration-property"/>5.1.4. Property</h3></div></div></div>
      

      <p>You need to decide which property needs to be made persistent in a
      given entity. This differs slightly between the annotation driven
      metadata and the hbm.xml files.</p>

      <div class="section" title="5.1.4.1. Property mapping with annotations"><div class="titlepage"><div><div><h4 class="title"><a id="d5e2913"/>5.1.4.1. Property mapping with annotations</h4></div></div></div>
        

        <p>In the annotations world, every non static non transient
        property (field or method depending on the access type) of an entity
        is considered persistent, unless you annotate it as
        <code class="literal">@Transient</code>. Not having an annotation for your
        property is equivalent to the appropriate <code class="literal">@Basic</code>
        annotation.</p>

        <p>The <code class="literal">@Basic</code> annotation allows you to declare
        the fetching strategy for a property. If set to
        <code class="literal">LAZY</code>, specifies that this property should be
        fetched lazily when the instance variable is first accessed. It
        requires build-time bytecode instrumentation, if your classes are not
        instrumented, property level lazy loading is silently ignored. The
        default is <code class="literal">EAGER</code>. You can also mark a property as
        not optional thanks to the <code class="classname">@Basic.optional</code>
        attribute. This will ensure that the underlying column are not
        nullable (if possible). Note that a better approach is to use the
        <code class="classname">@NotNull</code> annotation of the Bean Validation
        specification.</p>

        <p>Let's look at a few examples:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">transient</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">int</span><!-- <br/> --><span class="java_plain">&nbsp;counter</span><!-- <br/> --><span class="java_separator">;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_keyword">transient</span><!-- <br/> --><span class="java_plain">&nbsp;property</span>
</span>
<!--  --><br/><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstname</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">persistent&nbsp;property</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Transient</span>
<!--  --><br/><span class="java_type">String</span><span class="java_plain">&nbsp;getLengthInMeter</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">transient</span><span class="java_plain">&nbsp;property</span>
</span>
<!--  --><br/><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;persistent&nbsp;property</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Basic</span>
<!--  --><br/><span class="java_type">int</span><span class="java_plain">&nbsp;getLength</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;persistent&nbsp;property</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Basic</span><span class="java_separator">(</span><span class="java_plain">fetch&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">FetchType</span><span class="java_separator">.</span><span class="java_plain">LAZY</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_type">String</span><span class="java_plain">&nbsp;getDetailedComment</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;persistent&nbsp;property</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Temporal</span><span class="java_separator">(</span><span class="java_type">TemporalType</span><span class="java_separator">.</span><span class="java_plain">TIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">Date</span><span class="java_plain">&nbsp;getDepartureTime</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;persistent&nbsp;property&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Enumerated</span><span class="java_separator">(</span><span class="java_type">EnumType</span><span class="java_separator">.</span><span class="java_plain">STRING</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_type">Starred</span><span class="java_plain">&nbsp;getNote</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">enum&nbsp;persisted&nbsp;as&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;in&nbsp;database</span></pre>

        <p><code class="literal">counter</code>, a transient field, and
        <code class="literal">lengthInMeter</code>, a method annotated as
        <code class="literal">@Transient</code>, and will be ignored by the Hibernate.
        <code class="literal">name</code>, <code class="literal">length</code>, and
        <code class="literal">firstname</code> properties are mapped persistent and
        eagerly fetched (the default for simple properties). The
        <code class="literal">detailedComment</code> property value will be lazily
        fetched from the database once a lazy property of the entity is
        accessed for the first time. Usually you don't need to lazy simple
        properties (not to be confused with lazy association fetching). The
        recommended alternative is to use the projection capability of JP-QL
        (Java Persistence Query Language) or Criteria queries.</p>

        <p>JPA support property mapping of all basic types supported by
        Hibernate (all basic Java types , their respective wrappers and
        serializable classes). Hibernate Annotations supports out of the box
        enum type mapping either into a ordinal column (saving the enum
        ordinal) or a string based column (saving the enum string
        representation): the persistence representation, defaulted to ordinal,
        can be overridden through the <code class="literal">@Enumerated</code>
        annotation as shown in the <code class="literal">note</code> property
        example.</p>

        <p>In plain Java APIs, the temporal precision of time is not
        defined. When dealing with temporal data you might want to describe
        the expected precision in database. Temporal data can have
        <code class="literal">DATE</code>, <code class="literal">TIME</code>, or
        <code class="literal">TIMESTAMP</code> precision (ie the actual date, only the
        time, or both). Use the <code class="literal">@Temporal</code> annotation to
        fine tune that.</p>

        <p><code class="literal">@Lob</code> indicates that the property should be
        persisted in a Blob or a Clob depending on the property type:
        <code class="classname">java.sql.Clob</code>,
        <code class="classname">Character[]</code>, <code class="classname">char[]</code> and
        java.lang.<code class="classname">String</code> will be persisted in a Clob.
        <code class="classname">java.sql.Blob</code>, <code class="classname">Byte[]</code>,
        <code class="classname">byte[] </code>and <code class="classname">Serializable</code>
        type will be persisted in a Blob.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Lob</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getFullText</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;fullText</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Lob</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">byte</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;getFullCode</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;fullCode</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>If the property type implements
        <code class="classname">java.io.Serializable</code> and is not a basic type,
        and if the property is not annotated with <code class="literal">@Lob</code>,
        then the Hibernate <code class="literal">serializable</code> type is
        used.</p>

        <div class="section" title="5.1.4.1.1. Type"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2957"/>5.1.4.1.1. Type</h5></div></div></div>
          

          <p>You can also manually specify a type using the
          <code class="literal">@org.hibernate.annotations.Type</code> and some
          parameters if needed. <code class="classname">@Type.type</code> could
          be:</p>

          <div class="orderedlist"><ol class="orderedlist" type="1" compact="compact"><li class="listitem">
              <p>The name of a Hibernate basic type: <code class="literal">integer,
              string, character, date, timestamp, float, binary, serializable,
              object, blob</code> etc.</p>
            </li><li class="listitem">
              <p>The name of a Java class with a default basic type:
              <code class="literal">int, float, char, java.lang.String, java.util.Date,
              java.lang.Integer, java.sql.Clob</code> etc.</p>
            </li><li class="listitem">
              <p>The name of a serializable Java class.</p>
            </li><li class="listitem">
              <p>The class name of a custom type:
              <code class="literal">com.illflow.type.MyCustomType</code> etc.</p>
            </li></ol></div>

          <p>If you do not specify a type, Hibernate will use reflection
          upon the named property and guess the correct Hibernate type.
          Hibernate will attempt to interpret the name of the return class of
          the property getter using, in order, rules 2, 3, and 4.</p>

          <p><code class="literal">@org.hibernate.annotations.TypeDef</code> and
          <code class="literal">@org.hibernate.annotations.TypeDefs</code> allows you to
          declare type definitions. These annotations can be placed at the
          class or package level. Note that these definitions are global for
          the session factory (even when defined at the class level). If the
          type is used on a single entity, you can place the definition on the
          entity itself. Otherwise, it is recommended to place the definition
          at the package level. In the example below, when Hibernate
          encounters a property of class <code class="literal">PhoneNumer</code>, it
          delegates the persistence strategy to the custom mapping type
          <code class="literal">PhoneNumberType</code>. However, properties belonging to
          other classes, too, can delegate their persistence strategy to
          <code class="literal">PhoneNumberType</code>, by explicitly using the
          <code class="literal">@Type</code> annotation.</p>

          <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
            <p>Package level annotations are placed in a file named
            <code class="filename">package-info.java</code> in the appropriate package.
            Place your annotations before the package declaration.</p>
          </div>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">TypeDef</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;phoneNumber&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;defaultForType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">PhoneNumber</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;typeClass&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">PhoneNumberType</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">)</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ContactDetails</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">[...]</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">PhoneNumber</span><span class="java_plain">&nbsp;localPhoneNumber</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Type</span><span class="java_separator">(</span><span class="java_plain">type</span><span class="java_operator">=</span><span class="java_literal">&quot;phoneNumber&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">OverseasPhoneNumber</span><span class="java_plain">&nbsp;overseasPhoneNumber</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_separator">[...]</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>The following example shows the usage of the
          <code class="literal">parameters</code> attribute to customize the
          TypeDef.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">in&nbsp;org</span><!-- <br/> --><span class="java_operator">/</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_operator">/</span><!-- <br/> --><span class="java_plain">test</span><!-- <br/> --><span class="java_operator">/</span><!-- <br/> --><span class="java_plain">annotations</span><!-- <br/> --><span class="java_operator">/</span><!-- <br/> --><span class="java_plain">entity</span><!-- <br/> --><span class="java_operator">/</span><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_operator">-</span><!-- <br/> --><span class="java_plain">info</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">java</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">TypeDefs</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">TypeDef</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;caster&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;typeClass&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CasterStringType</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Parameter</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;cast&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;value</span><span class="java_operator">=</span><span class="java_literal">&quot;lower&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">package</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">test</span><span class="java_separator">.</span><span class="java_plain">annotations</span><span class="java_separator">.</span><span class="java_plain">entity</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">in&nbsp;org</span><span class="java_operator">/</span><span class="java_plain">hibernate</span><span class="java_operator">/</span><span class="java_plain">test</span><span class="java_operator">/</span><span class="java_plain">annotations</span><span class="java_operator">/</span><span class="java_plain">entity</span><span class="java_operator">/</span><span class="java_type">Forest</span><span class="java_separator">.</span><span class="java_plain">java</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Forest</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Type</span><span class="java_separator">(</span><span class="java_plain">type</span><span class="java_operator">=</span><span class="java_literal">&quot;caster&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getSmallText</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

          <p>When using composite user type, you will have to express
          column definitions. The <code class="literal">@Columns</code> has been
          introduced for that purpose.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Type</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">type</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_literal">&quot;org.hibernate.test.annotations.entity.MonetaryAmountUserType&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Columns</span><span class="java_separator">(</span><span class="java_plain">columns&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;r_amount&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;r_currency&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">MonetaryAmount</span><span class="java_plain">&nbsp;getAmount</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;amount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MonetaryAmount</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">BigDecimal</span><span class="java_plain">&nbsp;amount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Currency</span><span class="java_plain">&nbsp;currency</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre>
        </div>

        <div class="section" title="5.1.4.1.2. Access type"><div class="titlepage"><div><div><h5 class="title"><a id="d5e2992"/>5.1.4.1.2. Access type</h5></div></div></div>
          

          <p>By default the access type of a class hierarchy is defined by
          the position of the <code class="classname">@Id</code> or
          <code class="classname">@EmbeddedId</code> annotations. If these annotations
          are on a field, then only fields are considered for persistence and
          the state is accessed via the field. If these annotations are on a
          getter, then only the getters are considered for persistence and the
          state is accessed via the getter/setter. That works well in practice
          and is the recommended approach.</p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
              <p>The placement of annotations within a class hierarchy has
              to be consistent (either field or on property) to be able to
              determine the default access type. It is recommended to stick to
              one single annotation placement strategy throughout your whole
              application.</p>
            </div>

          <p>However in some situations, you need to:</p>

          <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
              <p>force the access type of the entity hierarchy</p>
            </li><li class="listitem">
              <p>override the access type of a specific entity in the class
              hierarchy</p>
            </li><li class="listitem">
              <p>override the access type of an embeddable type</p>
            </li></ul></div>

          <p>The best use case is an embeddable class used by several
          entities that might not use the same access type. In this case it is
          better to force the access type at the embeddable class
          level.</p>

          <p>To force the access type on a given class, use the
          <code class="classname">@Access</code> annotation as showed below:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Order</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setId</span><span class="java_separator">(</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">id&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Embedded</span><span class="java_plain">&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;address</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;getAddress</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;address</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setAddress</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">address&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;address</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">User</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setId</span><span class="java_separator">(</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">id&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;address</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Embedded</span><span class="java_plain">&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;getAddress</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;address</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setAddress</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">address&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;address</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Access</span><span class="java_separator">(</span><span class="java_type">AcessType</span><span class="java_separator">.</span><span class="java_plain">PROPERTY</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;street1</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getStreet1</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;street1</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setStreet1</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">street1&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;street1</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;hashCode</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">not&nbsp;persistent</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>You can also override the access type of a single property
          while keeping the other properties standard.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Order</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setId</span><span class="java_separator">(</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">id&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Transient</span><span class="java_plain">&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;userId</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Transient</span><span class="java_plain">&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;orderId</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Access</span><span class="java_separator">(</span><span class="java_type">AccessType</span><span class="java_separator">.</span><span class="java_plain">PROPERTY</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getOrderNumber</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;userId&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;:&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;orderId</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setOrderNumber</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">userId&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">...;</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">orderId&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">...;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre>

          <p>In this example, the default access type is
          <code class="classname">FIELD</code> except for the
          <code class="literal">orderNumber</code> property. Note that the corresponding
          field, if any must be marked as <code class="classname">@Transient</code> or
          <code class="code">transient</code>.</p>

          <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>@org.hibernate.annotations.AccessType</h2>
            

            <p>The annotation
            <code class="classname">@org.hibernate.annotations.AccessType</code>
            should be considered deprecated for FIELD and PROPERTY access. It
            is still useful however if you need to use a custom access
            type.</p>
          </div>
        </div>

        <div class="section" title="5.1.4.1.3. Optimistic lock"><div class="titlepage"><div><div><h5 class="title"><a id="d5e3022"/>5.1.4.1.3. Optimistic lock</h5></div></div></div>
          

          <p>It is sometimes useful to avoid increasing the version number
          even if a given property is dirty (particularly collections). You
          can do that by annotating the property (or collection) with
          <code class="literal">@OptimisticLock(excluded=true)</code>.</p>

          <p>More formally, specifies that updates to this property do not
          require acquisition of the optimistic lock.</p>
        </div>

        <div class="section" title="5.1.4.1.4. Declaring column attributes"><div class="titlepage"><div><div><h5 class="title"><a id="entity-mapping-property-column"/>5.1.4.1.4. Declaring column attributes</h5></div></div></div>
          

          <p>The column(s) used for a property mapping can be defined using
          the <code class="literal">@Column</code> annotation. Use it to override
          default values (see the JPA specification for more information on
          the defaults). You can use this annotation at the property level for
          properties that are:</p>

          <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
              <p>not annotated at all</p>
            </li><li class="listitem">
              <p>annotated with <code class="literal">@Basic</code></p>
            </li><li class="listitem">
              <p>annotated with <code class="literal">@Version</code></p>
            </li><li class="listitem">
              <p>annotated with <code class="literal">@Lob</code></p>
            </li><li class="listitem">
              <p>annotated with <code class="literal">@Temporal</code></p>
            </li></ul></div>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"></span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">updatable&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">false</span><span class="java_separator">,</span><span class="java_plain">&nbsp;name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;flight_name&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;nullable&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">false</span><span class="java_separator">,</span><span class="java_plain">&nbsp;length</span><span class="java_operator">=</span><span class="java_literal">50</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

          <p>The <code class="literal">name</code> property is mapped to the
          <code class="literal">flight_name</code> column, which is not nullable, has a
          length of 50 and is not updatable (making the property
          immutable).</p>

          <p>This annotation can be applied to regular properties as well
          as <code class="literal">@Id</code> or <code class="literal">@Version</code>
          properties.</p>

          <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Column(
    name="columnName";                                     <span class="co" id="hm1"><img src="images/callouts/1.png" alt="(1)"/></span>
    boolean unique() default false;                        <span class="co" id="hm2"><img src="images/callouts/2.png" alt="(2)"/></span>
    boolean nullable() default true;                       <span class="co" id="hm3"><img src="images/callouts/3.png" alt="(3)"/></span>
    boolean insertable() default true;                     <span class="co" id="hm4"><img src="images/callouts/4.png" alt="(4)"/></span>
    boolean updatable() default true;                      <span class="co" id="hm5"><img src="images/callouts/5.png" alt="(5)"/></span>
    String columnDefinition() default "";                  <span class="co" id="hm6"><img src="images/callouts/6.png" alt="(6)"/></span>
    String table() default "";                             <span class="co" id="hm7"><img src="images/callouts/7.png" alt="(7)"/></span>
    int length() default 255;                              <span class="co" id="hm8"><img src="images/callouts/8.png" alt="(8)"/></span>
    int precision() default 0; // decimal precision        <span class="co" id="hm9"><img src="images/callouts/9.png" alt="(9)"/></span>
    int scale() default 0; // decimal scale</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">name</code> (optional): the column name
                (default to the property name)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">unique</code> (optional): set a unique
                constraint on this column or not (default false)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">nullable</code> (optional): set the column
                as nullable (default true).</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">insertable</code> (optional): whether or not
                the column will be part of the insert statement (default
                true)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">updatable</code> (optional): whether or not
                the column will be part of the update statement (default
                true)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">columnDefinition</code> (optional): override
                the sql DDL fragment for this particular column (non
                portable)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">table</code> (optional): define the targeted
                table (default primary table)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">length</code> (optional):
                column length (default 255)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">precision</code>
                (optional): column decimal precision (default 0)</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/10.png" alt="10" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">scale</code> (optional):
                column decimal scale if useful (default 0)</p>
              </td></tr></table></div></div>
        </div>

        <div class="section" title="5.1.4.1.5. Formula"><div class="titlepage"><div><div><h5 class="title"><a id="d5e3097"/>5.1.4.1.5. Formula</h5></div></div></div>
          

          <p>Sometimes, you want the Database to do some computation for
          you rather than in the JVM, you might also create some kind of
          virtual column. You can use a SQL fragment (aka formula) instead of
          mapping a property into a column. This kind of property is read only
          (its value is calculated by your formula fragment).</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Formula</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;obj_length&nbsp;*&nbsp;obj_height&nbsp;*&nbsp;obj_width&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">long</span><span class="java_plain">&nbsp;getObjectVolume</span><span class="java_separator">()</span></pre>

          <p>The SQL fragment can be as complex as you want and even
          include subselects.</p>
        </div>

        <div class="section" title="5.1.4.1.6. Non-annotated property defaults"><div class="titlepage"><div><div><h5 class="title"><a id="d5e3102"/>5.1.4.1.6. Non-annotated property defaults</h5></div></div></div>
          

          <p>If a property is not annotated, the following rules
          apply:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
                <p>If the property is of a single type, it is mapped as
                @Basic</p>
              </li><li class="listitem">
                <p>Otherwise, if the type of the property is annotated as
                @Embeddable, it is mapped as @Embedded</p>
              </li><li class="listitem">
                <p>Otherwise, if the type of the property is
                <code class="classname">Serializable</code>, it is mapped as
                <code class="classname">@Basic</code> in a column holding the object
                in its serialized version</p>
              </li><li class="listitem">
                <p>Otherwise, if the type of the property is
                <code class="classname">java.sql.Clob</code> or
                <code class="classname">java.sql.Blob</code>, it is mapped as
                <code class="classname">@Lob</code> with the appropriate
                <code class="classname">LobType</code></p>
              </li></ul></div>
        </div>
      </div>

      <div class="section" title="5.1.4.2. Property mapping with hbm.xml"><div class="titlepage"><div><div><h4 class="title"><a id="d5e3120"/>5.1.4.2. Property mapping with hbm.xml</h4></div></div></div>
        

        <p>The <code class="literal">&lt;property&gt;</code> element declares a
        persistent JavaBean style property of the class.</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;property
        name="propertyName"                                <span class="co" id="property1"><img src="images/callouts/1.png" alt="(1)"/></span>
        column="column_name"                               <span class="co" id="property2"><img src="images/callouts/2.png" alt="(2)"/></span>
        type="typename"                                    <span class="co" id="property3"><img src="images/callouts/3.png" alt="(3)"/></span>
        update="true|false"                                <span class="co" id="property4"><img src="images/callouts/4.png" alt="(4)"/></span>
        insert="true|false"                                <span class="co" id="property5"><img src="images/callouts/4.png" alt="(4)"/></span>
        formula="arbitrary SQL expression"                 <span class="co" id="property6"><img src="images/callouts/5.png" alt="(5)"/></span>
        access="field|property|ClassName"                  <span class="co" id="property7"><img src="images/callouts/6.png" alt="(6)"/></span>
        lazy="true|false"                                  <span class="co" id="property8"><img src="images/callouts/7.png" alt="(7)"/></span>
        unique="true|false"                                <span class="co" id="property9"><img src="images/callouts/8.png" alt="(8)"/></span>
        not-null="true|false"                              <span class="co" id="property10"><img src="images/callouts/9.png" alt="(9)"/></span>
        optimistic-lock="true|false"                       <span class="co" id="property11"><img src="images/callouts/10.png" alt="(10)"/></span>
        generated="never|insert|always"                    <span class="co" id="property12"><img src="images/callouts/11.png" alt="(11)"/></span>
        node="element-name|@attribute-name|element/@attribute|."
        index="index_name"
        unique_key="unique_key_id"
        length="L"
        precision="P"
        scale="S"
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the name of the property, with an
              initial lowercase letter.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">column</code> (optional - defaults to the
              property name): the name of the mapped database table column.
              This can also be specified by nested
              <code class="literal">&lt;column&gt;</code> element(s).</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">type</code> (optional): a name that indicates
              the Hibernate type.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">update, insert</code> (optional - defaults to
              <code class="literal">true</code>): specifies that the mapped columns
              should be included in SQL <code class="literal">UPDATE</code> and/or
              <code class="literal">INSERT</code> statements. Setting both to
              <code class="literal">false</code> allows a pure "derived" property whose
              value is initialized from some other property that maps to the
              same column(s), or by a trigger or other application.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">formula</code> (optional): an SQL expression
              that defines the value for a <span class="emphasis"><em>computed</em></span>
              property. Computed properties do not have a column mapping of
              their own.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">access</code> (optional - defaults to
              <code class="literal">property</code>): the strategy Hibernate uses for
              accessing the property value.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">lazy</code> (optional - defaults to
              <code class="literal">false</code>): specifies that this property should
              be fetched lazily when the instance variable is first accessed.
              It requires build-time bytecode instrumentation.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">unique</code> (optional): enables the DDL
              generation of a unique constraint for the columns. Also, allow
              this to be the target of a
              <code class="literal">property-ref</code>.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/9.png" alt="9" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">not-null</code> (optional): enables the DDL
              generation of a nullability constraint for the columns.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/10.png" alt="10" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">optimistic-lock</code> (optional - defaults to
              <code class="literal">true</code>): specifies that updates to this
              property do or do not require acquisition of the optimistic
              lock. In other words, it determines if a version increment
              should occur when this property is dirty.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/11.png" alt="11" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">generated</code> (optional - defaults to
              <code class="literal">never</code>): specifies that this property value is
              actually generated by the database. See the discussion of <a class="link" href="ch05.html#mapping-generated" title="5.5. Generated properties">generated properties</a> for more
              information.</p>
            </td></tr></table></div></div>

        <p><span class="emphasis"><em>typename</em></span> could be:</p>

        <div class="orderedlist"><ol class="orderedlist" type="1" compact="compact"><li class="listitem">
            <p>The name of a Hibernate basic type: <code class="literal">integer,
            string, character, date, timestamp, float, binary, serializable,
            object, blob</code> etc.</p>
          </li><li class="listitem">
            <p>The name of a Java class with a default basic type:
            <code class="literal">int, float, char, java.lang.String, java.util.Date,
            java.lang.Integer, java.sql.Clob</code> etc.</p>
          </li><li class="listitem">
            <p>The name of a serializable Java class.</p>
          </li><li class="listitem">
            <p>The class name of a custom type:
            <code class="literal">com.illflow.type.MyCustomType</code> etc.</p>
          </li></ol></div>

        <p>If you do not specify a type, Hibernate will use reflection upon
        the named property and guess the correct Hibernate type. Hibernate
        will attempt to interpret the name of the return class of the property
        getter using, in order, rules 2, 3, and 4. In certain cases you will
        need the <code class="literal">type</code> attribute. For example, to
        distinguish between <code class="literal">Hibernate.DATE</code> and
        <code class="literal">Hibernate.TIMESTAMP</code>, or to specify a custom
        type.</p>

        <p>The <code class="literal">access</code> attribute allows you to control
        how Hibernate accesses the property at runtime. By default, Hibernate
        will call the property get/set pair. If you specify
        <code class="literal">access="field"</code>, Hibernate will bypass the get/set
        pair and access the field directly using reflection. You can specify
        your own strategy for property access by naming a class that
        implements the interface
        <code class="literal">org.hibernate.property.PropertyAccessor</code>.</p>

        <p>A powerful feature is derived properties. These properties are
        by definition read-only. The property value is computed at load time.
        You declare the computation as an SQL expression. This then translates
        to a <code class="literal">SELECT</code> clause subquery in the SQL query that
        loads an instance:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">
&lt;property name="totalPrice"
    formula="( SELECT SUM (li.quantity*p.price) FROM LineItem li, Product p
                WHERE li.productId = p.productId
                AND li.customerId = customerId
                AND li.orderNumber = orderNumber )"/&gt;</pre>

        <p>You can reference the entity table by not declaring an alias on
        a particular column. This would be <code class="literal">customerId</code> in
        the given example. You can also use the nested
        <code class="literal">&lt;formula&gt;</code> mapping element if you do not want
        to use the attribute.</p>
      </div>
    </div>

    <div class="section" title="5.1.5. Embedded objects (aka components)"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-declaration-component"/>5.1.5. Embedded objects (aka components)</h3></div></div></div>
      

      <p>Embeddable objects (or components) are objects whose properties
      are mapped to the same table as the owning entity's table. Components
      can, in turn, declare their own properties, components or
      collections</p>

      <p>It is possible to declare an embedded component inside an entity
      and even override its column mapping. Component classes have to be
      annotated at the class level with the <code class="literal">@Embeddable</code>
      annotation. It is possible to override the column mapping of an embedded
      object for a particular entity using the <code class="literal">@Embedded</code>
      and <code class="literal">@AttributeOverride</code> annotation in the associated
      property:</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Persistent</span><span class="java_plain">&nbsp;component&nbsp;using&nbsp;defaults</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;homeAddress</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Embedded</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverrides</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;iso2&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;bornIso2&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;name&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;bornCountryName&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Country</span><span class="java_plain">&nbsp;bornIn</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;city</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Country</span><span class="java_plain">&nbsp;nationality</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">no&nbsp;overriding&nbsp;here</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Embeddable</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Country</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;iso2</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;countryName&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getIso2</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;iso2</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setIso2</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;iso2</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">iso2&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;iso2</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setName</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

      <p>An embeddable object inherits the access type of its owning entity
      (note that you can override that using the <code class="literal">@Access</code>
      annotation).</p>

      <p>The <code class="literal">Person</code> entity has two component properties,
      <code class="literal">homeAddress</code> and <code class="literal">bornIn</code>.
      <code class="literal">homeAddress</code> property has not been annotated, but
      Hibernate will guess that it is a persistent component by looking for
      the <code class="literal">@Embeddable</code> annotation in the Address class. We
      also override the mapping of a column name (to
      <code class="literal">bornCountryName</code>) with the
      <code class="literal">@Embedded</code> and <code class="literal">@AttributeOverride
      </code>annotations for each mapped attribute of
      <code class="literal">Country</code>. As you can see, <code class="literal">Country
      </code>is also a nested component of <code class="literal">Address</code>,
      again using auto-detection by Hibernate and JPA defaults. Overriding
      columns of embedded objects of embedded objects is through dotted
      expressions.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><!-- <br/> --><span class="java_type">Embedded</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverrides</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;city&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;fld_city&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;nationality.iso2&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;nat_Iso2&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;nationality.name&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;nat_CountryName&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">nationality&nbsp;columns&nbsp;in&nbsp;homeAddress&nbsp;are&nbsp;overridden</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Address</span><span class="java_plain">&nbsp;homeAddress</span><span class="java_separator">;</span></pre>

      <p>Hibernate Annotations supports something that is not explicitly
      supported by the JPA specification. You can annotate a embedded object
      with the <code class="literal">@MappedSuperclass</code> annotation to make the
      superclass properties persistent (see
      <code class="literal">@MappedSuperclass</code> for more informations).</p>

      <p>You can also use association annotations in an embeddable object
      (ie <code class="literal">@OneToOne</code>, <code class="classname">@ManyToOne</code>,
      <code class="classname">@OneToMany</code> or <code class="literal">@ManyToMany</code>). To
      override the association columns you can use
      <code class="literal">@AssociationOverride</code>.</p>

      <p>If you want to have the same embeddable object type twice in the
      same entity, the column name defaulting will not work as several
      embedded objects would share the same set of columns. In plain JPA, you
      need to override at least one set of columns. Hibernate, however, allows
      you to enhance the default naming mechanism through the
      <code class="classname">NamingStrategy</code> interface. You can write a
      strategy that prevent name clashing in such a situation.
      <code class="classname">DefaultComponentSafeNamingStrategy</code> is an example
      of this.</p>

      <p>If a property of the embedded object points back to the owning
      entity, annotate it with the <code class="classname">@Parent</code> annotation.
      Hibernate will make sure this property is properly loaded with the
      entity reference.</p>

      <p>In XML, use the <code class="literal">&lt;component&gt;</code>
      element.</p>

      <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;component
        name="propertyName"                                <span class="co" id="component1"><img src="images/callouts/1.png" alt="(1)"/></span>
        class="className"                                  <span class="co" id="component2"><img src="images/callouts/2.png" alt="(2)"/></span>
        insert="true|false"                                <span class="co" id="component3"><img src="images/callouts/3.png" alt="(3)"/></span>
        update="true|false"                                <span class="co" id="component4"><img src="images/callouts/4.png" alt="(4)"/></span>
        access="field|property|ClassName"                  <span class="co" id="component5"><img src="images/callouts/5.png" alt="(5)"/></span>
        lazy="true|false"                                  <span class="co" id="component6"><img src="images/callouts/6.png" alt="(6)"/></span>
        optimistic-lock="true|false"                       <span class="co" id="component7"><img src="images/callouts/7.png" alt="(7)"/></span>
        unique="true|false"                                <span class="co" id="component8"><img src="images/callouts/8.png" alt="(8)"/></span>
        node="element-name|."
&gt;

        &lt;property ...../&gt;
        &lt;many-to-one .... /&gt;
        ........
&lt;/component&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">name</code>: the name of the property.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">class</code> (optional - defaults to the
            property type determined by reflection): the name of the component
            (child) class.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">insert</code>: do the mapped columns appear in
            SQL <code class="literal">INSERTs</code>?</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">update</code>: do the mapped columns appear in
            SQL <code class="literal">UPDATEs</code>?</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">access</code> (optional - defaults to
            <code class="literal">property</code>): the strategy Hibernate uses for
            accessing the property value.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">lazy</code> (optional - defaults to
            <code class="literal">false</code>): specifies that this component should be
            fetched lazily when the instance variable is first accessed. It
            requires build-time bytecode instrumentation.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">optimistic-lock</code> (optional - defaults to
            <code class="literal">true</code>): specifies that updates to this component
            either do or do not require acquisition of the optimistic lock. It
            determines if a version increment should occur when this property
            is dirty.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">unique</code> (optional - defaults to
            <code class="literal">false</code>): specifies that a unique constraint
            exists upon all mapped columns of the component.</p>
          </td></tr></table></div></div>

      <p>The child <code class="literal">&lt;property&gt;</code> tags map properties
      of the child class to table columns.</p>

      <p>The <code class="literal">&lt;component&gt;</code> element allows a
      <code class="literal">&lt;parent&gt;</code> subelement that maps a property of the
      component class as a reference back to the containing entity.</p>

      <p>The <code class="literal">&lt;dynamic-component&gt;</code> element allows a
      <code class="literal">Map</code> to be mapped as a component, where the property
      names refer to keys of the map. See <a class="xref" href="ch09.html#components-dynamic" title="9.5. Dynamic components">Section 9.5, “Dynamic components”</a> for more information. This feature is
      not supported in annotations.</p>
    </div>

    <div class="section" title="5.1.6. Inheritance strategy"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3306"/>5.1.6. Inheritance strategy</h3></div></div></div>
      

      <p>Java is a language supporting polymorphism: a class can inherit
      from another. Several strategies are possible to persist a class
      hierarchy:</p>

      <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
          <p>Single table per class hierarchy strategy: a single table
          hosts all the instances of a class hierarchy</p>
        </li><li class="listitem">
          <p>Joined subclass strategy: one table per class and subclass is
          present and each table persist the properties specific to a given
          subclass. The state of the entity is then stored in its
          corresponding class table and all its superclasses</p>
        </li><li class="listitem">
          <p>Table per class strategy: one table per concrete class and
          subclass is present and each table persist the properties of the
          class and its superclasses. The state of the entity is then stored
          entirely in the dedicated table for its class.</p>
        </li></ul></div>

      <div class="section" title="5.1.6.1. Single table per class hierarchy strategy"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-subclass"/>5.1.6.1. Single table per class hierarchy strategy</h4></div></div></div>
        

        <p>With this approach the properties of all the subclasses in a
        given mapped class hierarchy are stored in a single table.</p>

        <p>Each subclass declares its own persistent properties and
        subclasses. Version and id properties are assumed to be inherited from
        the root class. Each subclass in a hierarchy must define a unique
        discriminator value. If this is not specified, the fully qualified
        Java class name is used.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Inheritance</span><span class="java_separator">(</span><span class="java_plain">strategy</span><span class="java_operator">=</span><span class="java_type">InheritanceType</span><span class="java_separator">.</span><span class="java_plain">SINGLE_TABLE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">DiscriminatorColumn</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;planetype&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;discriminatorType</span><span class="java_operator">=</span><span class="java_type">DiscriminatorType</span><span class="java_separator">.</span><span class="java_plain">STRING</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">DiscriminatorValue</span><span class="java_separator">(</span><span class="java_literal">&quot;Plane&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Plane</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">DiscriminatorValue</span><span class="java_separator">(</span><span class="java_literal">&quot;A320&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;A320&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Plane</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>In hbm.xml, for the table-per-class-hierarchy mapping strategy,
        the <code class="literal">&lt;subclass&gt;</code> declaration is used. For
        example:</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;subclass
        name="ClassName"                                   <span class="co" id="subclass1"><img src="images/callouts/1.png" alt="(1)"/></span>
        discriminator-value="discriminator_value"          <span class="co" id="subclass2"><img src="images/callouts/2.png" alt="(2)"/></span>
        proxy="ProxyInterface"                             <span class="co" id="subclass3"><img src="images/callouts/3.png" alt="(3)"/></span>
        lazy="true|false"                                  <span class="co" id="subclass4"><img src="images/callouts/4.png" alt="(4)"/></span>
        dynamic-update="true|false"
        dynamic-insert="true|false"
        entity-name="EntityName"
        node="element-name"
        extends="SuperclassName"&gt;

        &lt;property .... /&gt;
        .....
&lt;/subclass&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the fully qualified class name of
              the subclass.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">discriminator-value</code> (optional -
              defaults to the class name): a value that distinguishes
              individual subclasses.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">proxy</code> (optional): specifies a class or
              interface used for lazy initializing proxies.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">lazy</code> (optional - defaults to
              <code class="literal">true</code>): setting
              <code class="literal">lazy="false"</code> disables the use of lazy
              fetching.</p>
            </td></tr></table></div></div>

        <p>For information about inheritance mappings see <a class="xref" href="ch10.html" title="Chapter 10. Inheritance mapping">Chapter 10, <em>Inheritance mapping</em></a>.</p>

        <div class="section" title="5.1.6.1.1. Discriminator"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-discriminator"/>5.1.6.1.1. Discriminator</h5></div></div></div>
          

          <p>Discriminators are required for polymorphic persistence using
          the table-per-class-hierarchy mapping strategy. It declares a
          discriminator column of the table. The discriminator column contains
          marker values that tell the persistence layer what subclass to
          instantiate for a particular row. Hibernate Core supports the
          follwoing restricted set of types as discriminator column:
          <code class="literal">string</code>, <code class="literal">character</code>,
          <code class="literal">integer</code>, <code class="literal">byte</code>,
          <code class="literal">short</code>, <code class="literal">boolean</code>,
          <code class="literal">yes_no</code>, <code class="literal">true_false</code>.</p>

          <p>Use the <code class="classname">@DiscriminatorColumn</code> to define
          the discriminator column as well as the discriminator type. </p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
              <p><code class="classname">The enum DiscriminatorType</code> used in
              <code class="classname">javax.persitence.DiscriminatorColumn</code> only
              contains the values <code class="constant">STRING</code>,
              <code class="constant">CHAR</code> and <code class="constant">INTEGER</code> which
              means that not all Hibernate supported types are available via
              the <code class="classname">@DiscriminatorColumn</code>
              annotation.</p>
            </div><p>You can also use
          <code class="classname">@DiscriminatorFormula</code> to express in SQL a
          virtual discriminator column. This is particularly useful when the
          discriminator value can be extracted from one or more columns of the
          table. Both <code class="classname">@DiscriminatorColumn</code> and
          <code class="classname">@DiscriminatorFormula</code> are to be set on the
          root entity (once per persisted hierarchy).</p>

          <p><code class="classname">@org.hibernate.annotations.DiscriminatorOptions</code>
          allows to optionally specify Hibernate specific discriminator
          options which are not standardized in JPA. The available options are
          <code class="literal">force</code> and <code class="literal">insert</code>. The
          <code class="literal">force</code> attribute is useful if the table contains
          rows with "extra" discriminator values that are not mapped to a
          persistent class. This could for example occur when working with a
          legacy database. If <code class="literal">force</code> is set to
          <code class="constant">true</code> Hibernate will specify the allowed
          discriminator values in the <code class="literal">SELECT</code> query, even
          when retrieving all instances of the root class. The second option -
          <code class="literal">insert</code> - tells Hibernate whether or not to
          include the discriminator column in SQL <code class="literal">INSERTs</code>.
          Usually the column should be part of the <code class="literal">INSERT</code>
          statement, but if your discriminator column is also part of a mapped
          composite identifier you have to set this option to
          <code class="constant">false</code>.</p><div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Tip</h2>
              <p>There is also a
              <code class="classname">@org.hibernate.annotations.ForceDiscriminator</code>
              annotation which is deprecated since version 3.6. Use
              <code class="classname">@DiscriminatorOptions</code> instead.</p>
            </div>

          <p>Finally, use <code class="classname">@DiscriminatorValue</code> on
          each class of the hierarchy to specify the value stored in the
          discriminator column for a given entity. If you do not set
          <code class="classname">@DiscriminatorValue</code> on a class, the fully
          qualified class name is used.</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Inheritance</span><span class="java_separator">(</span><span class="java_plain">strategy</span><span class="java_operator">=</span><span class="java_type">InheritanceType</span><span class="java_separator">.</span><span class="java_plain">SINGLE_TABLE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">DiscriminatorColumn</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;planetype&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;discriminatorType</span><span class="java_operator">=</span><span class="java_type">DiscriminatorType</span><span class="java_separator">.</span><span class="java_plain">STRING</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">DiscriminatorValue</span><span class="java_separator">(</span><span class="java_literal">&quot;Plane&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Plane</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">DiscriminatorValue</span><span class="java_separator">(</span><span class="java_literal">&quot;A320&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;A320&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Plane</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

          <p>In hbm.xml, the <code class="literal">&lt;discriminator&gt;</code>
          element is used to define the discriminator column or
          formula:</p>

          <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;discriminator
        column="discriminator_column"                      <span class="co" id="discriminator1"><img src="images/callouts/1.png" alt="(1)"/></span>
        type="discriminator_type"                          <span class="co" id="discriminator2"><img src="images/callouts/2.png" alt="(2)"/></span>
        force="true|false"                                 <span class="co" id="discriminator3"><img src="images/callouts/3.png" alt="(3)"/></span>
        insert="true|false"                                <span class="co" id="discriminator4"><img src="images/callouts/4.png" alt="(4)"/></span>
        formula="arbitrary sql expression"                 <span class="co" id="discriminator5"><img src="images/callouts/5.png" alt="(5)"/></span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">column</code> (optional - defaults to
                <code class="literal">class</code>): the name of the discriminator
                column.</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">type</code> (optional - defaults to
                <code class="literal">string</code>): a name that indicates the
                Hibernate type</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">force</code> (optional - defaults to
                <code class="literal">false</code>): "forces" Hibernate to specify the
                allowed discriminator values, even when retrieving all
                instances of the root class.</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">insert</code> (optional - defaults to
                <code class="literal">true</code>): set this to <code class="literal">false</code>
                if your discriminator column is also part of a mapped
                composite identifier. It tells Hibernate not to include the
                column in SQL <code class="literal">INSERTs</code>.</p>
              </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
                <p><code class="literal">formula</code> (optional): an arbitrary SQL
                expression that is executed when a type has to be evaluated.
                It allows content-based discrimination.</p>
              </td></tr></table></div></div>

          <p>Actual values of the discriminator column are specified by the
          <code class="literal">discriminator-value</code> attribute of the
          <code class="literal">&lt;class&gt;</code> and
          <code class="literal">&lt;subclass&gt;</code> elements.</p>

          <p>The <code class="literal">formula</code> attribute allows you to declare
          an arbitrary SQL expression that will be used to evaluate the type
          of a row. For example:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;discriminator
    formula="case when CLASS_TYPE in ('a', 'b', 'c') then 0 else 1 end"
    type="integer"/&gt;</pre>
        </div>
      </div>

      <div class="section" title="5.1.6.2. Joined subclass strategy"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-joinedsubclass"/>5.1.6.2. Joined subclass strategy</h4></div></div></div>
        

        <p>Each subclass can also be mapped to its own table. This is
        called the table-per-subclass mapping strategy. An inherited state is
        retrieved by joining with the table of the superclass. A discriminator
        column is not required for this mapping strategy. Each subclass must,
        however, declare a table column holding the object identifier. The
        primary key of this table is also a foreign key to the superclass
        table and described by the
        <code class="classname">@PrimaryKeyJoinColumn</code>s or the
        <code class="literal">&lt;key&gt;</code> element.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span><!-- <br/> --><span class="java_plain">&nbsp;@</span><!-- <br/> --><span class="java_type">Table</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">name</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_literal">&quot;CATS&quot;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Inheritance</span><span class="java_separator">(</span><span class="java_plain">strategy</span><span class="java_operator">=</span><span class="java_type">InheritanceType</span><span class="java_separator">.</span><span class="java_plain">JOINED</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span><span class="java_separator">(</span><span class="java_plain">generator</span><span class="java_operator">=</span><span class="java_literal">&quot;cat-uuid&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">GenericGenerator</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;cat-uuid&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;strategy</span><span class="java_operator">=</span><span class="java_literal">&quot;uuid&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;@</span><span class="java_type">Table</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;DOMESTIC_CATS&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">PrimaryKeyJoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;CAT&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">DomesticCat</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>The table name still defaults to the non qualified class name.
          Also if <code class="classname">@PrimaryKeyJoinColumn</code> is not set, the
          primary key / foreign key columns are assumed to have the same names
          as the primary key columns of the primary table of the
          superclass.</p>
        </div>

        <p>In hbm.xml, use the <code class="literal">&lt;joined-subclass&gt;</code>
        element. For example:</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;joined-subclass
        name="ClassName"                                   <span class="co" id="joinedsubclass1"><img src="images/callouts/1.png" alt="(1)"/></span>
        table="tablename"                                  <span class="co" id="joinedsubclass2"><img src="images/callouts/2.png" alt="(2)"/></span>
        proxy="ProxyInterface"                             <span class="co" id="joinedsubclass3"><img src="images/callouts/3.png" alt="(3)"/></span>
        lazy="true|false"                                  <span class="co" id="joinedsubclass4"><img src="images/callouts/4.png" alt="(4)"/></span>
        dynamic-update="true|false"
        dynamic-insert="true|false"
        schema="schema"
        catalog="catalog"
        extends="SuperclassName"
        persister="ClassName"
        subselect="SQL expression"
        entity-name="EntityName"
        node="element-name"&gt;

        &lt;key .... &gt;

        &lt;property .... /&gt;
        .....
&lt;/joined-subclass&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the fully qualified class name of
              the subclass.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">table</code>: the name of the subclass
              table.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">proxy</code> (optional): specifies a class or
              interface to use for lazy initializing proxies.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">lazy</code> (optional, defaults to
              <code class="literal">true</code>): setting
              <code class="literal">lazy="false"</code> disables the use of lazy
              fetching.</p>
            </td></tr></table></div></div>

        <p>Use the <code class="literal">&lt;key&gt;</code> element to declare the
        primary key / foreign key column. The mapping at the start of the
        chapter would then be re-written as:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;

        &lt;class name="Cat" table="CATS"&gt;
                &lt;id name="id" column="uid" type="long"&gt;
                        &lt;generator class="hilo"/&gt;
                &lt;/id&gt;
                &lt;property name="birthdate" type="date"/&gt;
                &lt;property name="color" not-null="true"/&gt;
                &lt;property name="sex" not-null="true"/&gt;
                &lt;property name="weight"/&gt;
                &lt;many-to-one name="mate"/&gt;
                &lt;set name="kittens"&gt;
                        &lt;key column="MOTHER"/&gt;
                        &lt;one-to-many class="Cat"/&gt;
                &lt;/set&gt;
                &lt;joined-subclass name="DomesticCat" table="DOMESTIC_CATS"&gt;
                    &lt;key column="CAT"/&gt;
                    &lt;property name="name" type="string"/&gt;
                &lt;/joined-subclass&gt;
        &lt;/class&gt;

        &lt;class name="eg.Dog"&gt;
                &lt;!-- mapping for Dog could go here --&gt;
        &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre>

        <p>For information about inheritance mappings see <a class="xref" href="ch10.html" title="Chapter 10. Inheritance mapping">Chapter 10, <em>Inheritance mapping</em></a>.</p>
      </div>

      <div class="section" title="5.1.6.3. Table per class strategy"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-unionsubclass"/>5.1.6.3. Table per class strategy</h4></div></div></div>
        

        <p>A third option is to map only the concrete classes of an
        inheritance hierarchy to tables. This is called the
        table-per-concrete-class strategy. Each table defines all persistent
        states of the class, including the inherited state. In Hibernate, it
        is not necessary to explicitly map such inheritance hierarchies. You
        can map each class as a separate entity root. However, if you wish use
        polymorphic associations (e.g. an association to the superclass of
        your hierarchy), you need to use the union subclass mapping.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Inheritance</span><span class="java_separator">(</span><span class="java_plain">strategy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">InheritanceType</span><span class="java_separator">.</span><span class="java_plain">TABLE_PER_CLASS</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>Or in hbm.xml:</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;union-subclass
        name="ClassName"                                   <span class="co" id="unionsubclass1"><img src="images/callouts/1.png" alt="(1)"/></span>
        table="tablename"                                  <span class="co" id="unionsubclass2"><img src="images/callouts/2.png" alt="(2)"/></span>
        proxy="ProxyInterface"                             <span class="co" id="unionsubclass3"><img src="images/callouts/3.png" alt="(3)"/></span>
        lazy="true|false"                                  <span class="co" id="unionsubclass4"><img src="images/callouts/4.png" alt="(4)"/></span>
        dynamic-update="true|false"
        dynamic-insert="true|false"
        schema="schema"
        catalog="catalog"
        extends="SuperclassName"
        abstract="true|false"
        persister="ClassName"
        subselect="SQL expression"
        entity-name="EntityName"
        node="element-name"&gt;

        &lt;property .... /&gt;
        .....
&lt;/union-subclass&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the fully qualified class name of
              the subclass.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">table</code>: the name of the subclass
              table.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">proxy</code> (optional): specifies a class or
              interface to use for lazy initializing proxies.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">lazy</code> (optional, defaults to
              <code class="literal">true</code>): setting
              <code class="literal">lazy="false"</code> disables the use of lazy
              fetching.</p>
            </td></tr></table></div></div>

        <p>No discriminator column or key column is required for this
        mapping strategy.</p>

        <p>For information about inheritance mappings see <a class="xref" href="ch10.html" title="Chapter 10. Inheritance mapping">Chapter 10, <em>Inheritance mapping</em></a>.</p>
      </div>

      <div class="section" title="5.1.6.4. Inherit properties from superclasses"><div class="titlepage"><div><div><h4 class="title"><a id="d5e3498"/>5.1.6.4. Inherit properties from superclasses</h4></div></div></div>
        

        <p>This is sometimes useful to share common properties through a
        technical or a business superclass without including it as a regular
        mapped entity (ie no specific table for this entity). For that purpose
        you can map them as <code class="literal">@MappedSuperclass</code>.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">MappedSuperclass</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">BaseEntity</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Basic</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Temporal</span><span class="java_separator">(</span><span class="java_type">TemporalType</span><span class="java_separator">.</span><span class="java_plain">TIMESTAMP</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;getLastUpdate</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getLastUpdater</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Order</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">BaseEntity</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>In database, this hierarchy will be represented as an
        <code class="literal">Order</code> table having the <code class="literal">id</code>,
        <code class="literal">lastUpdate</code> and <code class="literal">lastUpdater</code>
        columns. The embedded superclass property mappings are copied into
        their entity subclasses. Remember that the embeddable superclass is
        not the root of the hierarchy though.</p>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>Properties from superclasses not mapped as
          <code class="literal">@MappedSuperclass</code> are ignored.</p>
        </div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>The default access type (field or methods) is used, unless you
          use the <code class="literal">@Access</code> annotation.</p>
        </div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>The same notion can be applied to
          <code class="literal">@Embeddable</code> objects to persist properties from
          their superclasses. You also need to use
          <code class="literal">@MappedSuperclass</code> to do that (this should not be
          considered as a standard EJB3 feature though)</p>
        </div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>It is allowed to mark a class as
          <code class="literal">@MappedSuperclass</code> in the middle of the mapped
          inheritance hierarchy.</p>
        </div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>Any class in the hierarchy non annotated with
          <code class="literal">@MappedSuperclass</code> nor <code class="literal">@Entity</code>
          will be ignored.</p>
        </div>

        <p>You can override columns defined in entity superclasses at the
        root entity level using the <code class="literal">@AttributeOverride</code>
        annotation.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">MappedSuperclass</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">FlyingObject</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;getAltitude</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;altitude</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Transient</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;getMetricAltitude</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;metricAltitude</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">PropulsionType</span><span class="java_plain">&nbsp;getPropulsion</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;metricAltitude</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">AttributeOverride</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;altitude&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;fld_altitude&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">AssociationOverride</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;propulsion&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;joinColumns&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;fld_propulsion_fk&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Plane</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">FlyingObject</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>The <code class="literal">altitude</code> property will be persisted in an
        <code class="literal">fld_altitude</code> column of table
        <code class="literal">Plane</code> and the propulsion association will be
        materialized in a <code class="literal">fld_propulsion_fk</code> foreign key
        column.</p>

        <p>You can define <code class="literal">@AttributeOverride</code>(s) and
        <code class="literal">@AssociationOverride</code>(s) on
        <code class="literal">@Entity</code> classes,
        <code class="literal">@MappedSuperclass</code> classes and properties pointing
        to an <code class="literal">@Embeddable</code> object.</p>

        <p>In hbm.xml, simply map the properties of the superclass in the
        <code class="literal">&lt;class&gt;</code> element of the entity that needs to
        inherit them.</p>
      </div>

      <div class="section" title="5.1.6.5. Mapping one entity to several tables"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-join"/>5.1.6.5. Mapping one entity to several tables</h4></div></div></div>
        

        <p>While not recommended for a fresh schema, some legacy databases
        force your to map a single entity on several tables.</p>

        <p>Using the <code class="literal">@SecondaryTable</code> or
        <code class="literal">@SecondaryTables</code> class level annotations. To
        express that a column is in a particular table, use the
        <code class="literal">table</code> parameter of <code class="literal">@Column</code> or
        <code class="literal">@JoinColumn</code>.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Table</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;MainCat&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">SecondaryTables</span><span class="java_separator">({</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">SecondaryTable</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat1&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;pkJoinColumns</span><span class="java_operator">=</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">PrimaryKeyJoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;cat_id&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;referencedColumnName</span><span class="java_operator">=</span><span class="java_literal">&quot;id&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">SecondaryTable</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat2&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;uniqueConstraints</span><span class="java_operator">=</span><span class="java_separator">{</span><span class="java_plain">@</span><span class="java_type">UniqueConstraint</span><span class="java_separator">(</span><span class="java_plain">columnNames</span><span class="java_operator">=</span><span class="java_separator">{</span><span class="java_literal">&quot;storyPart2&quot;</span><span class="java_separator">})})</span>
<!--  --><br/><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;storyPart1</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;storyPart2</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">table</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getStoryPart1</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;storyPart1</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">table</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat2&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getStoryPart2</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;storyPart2</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>In this example, <code class="literal">name</code> will be in
        <code class="literal">MainCat</code>. <code class="literal">storyPart1</code> will be in
        <code class="literal">Cat1</code> and <code class="literal">storyPart2</code> will be in
        <code class="literal">Cat2</code>. <code class="literal">Cat1</code> will be joined to
        <code class="literal">MainCat</code> using the <code class="literal">cat_id</code> as a
        foreign key, and <code class="literal">Cat2</code> using <code class="literal">id</code>
        (ie the same column name, the <code class="literal">MainCat</code> id column
        has). Plus a unique constraint on <code class="literal">storyPart2</code> has
        been set.</p>

        <p>There is also additional tuning accessible via the
        <code class="classname">@org.hibernate.annotations.Table</code>
        annotation:</p>

        <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
            <p><code class="literal">fetch</code>: If set to JOIN, the default,
            Hibernate will use an inner join to retrieve a secondary table
            defined by a class or its superclasses and an outer join for a
            secondary table defined by a subclass. If set to
            <code class="classname">SELECT</code> then Hibernate will use a sequential
            select for a secondary table defined on a subclass, which will be
            issued only if a row turns out to represent an instance of the
            subclass. Inner joins will still be used to retrieve a secondary
            defined by the class and its superclasses.</p>
          </li><li class="listitem">
            <p><code class="literal">inverse</code>: If true, Hibernate will not try
            to insert or update the properties defined by this join. Default
            to false.</p>
          </li><li class="listitem">
            <p><code class="literal">optional</code>: If enabled (the default),
            Hibernate will insert a row only if the properties defined by this
            join are non-null and will always use an outer join to retrieve
            the properties.</p>
          </li><li class="listitem">
            <p><code class="literal">foreignKey</code>: defines the Foreign Key name
            of a secondary table pointing back to the primary table.</p>
          </li></ul></div>

        <p>Make sure to use the secondary table name in the
        <code class="methodname">appliesto</code> property</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Table</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;MainCat&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">SecondaryTable</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">annotations</span><span class="java_separator">.</span><span class="java_type">Table</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;appliesTo</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat1&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;fetch</span><span class="java_operator">=</span><span class="java_type">FetchMode</span><span class="java_separator">.</span><span class="java_plain">SELECT</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;optional</span><span class="java_operator">=</span><span class="java_literal">true</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;storyPart1</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;storyPart2</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">table</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getStoryPart1</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;storyPart1</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">table</span><span class="java_operator">=</span><span class="java_literal">&quot;Cat2&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getStoryPart2</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;storyPart2</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>In hbm.xml, use the <code class="literal">&lt;join&gt;</code>
        element.</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;join
        table="tablename"                                  <span class="co" id="join1"><img src="images/callouts/1.png" alt="(1)"/></span>
        schema="owner"                                     <span class="co" id="join2"><img src="images/callouts/2.png" alt="(2)"/></span>
        catalog="catalog"                                  <span class="co" id="join3"><img src="images/callouts/3.png" alt="(3)"/></span>
        fetch="join|select"                                <span class="co" id="join4"><img src="images/callouts/4.png" alt="(4)"/></span>
        inverse="true|false"                               <span class="co" id="join5"><img src="images/callouts/5.png" alt="(5)"/></span>
        optional="true|false"&gt;                             <span class="co" id="join6"><img src="images/callouts/6.png" alt="(6)"/></span>

        &lt;key ... /&gt;

        &lt;property ... /&gt;
        ...
&lt;/join&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">table</code>: the name of the joined
              table.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">schema</code> (optional): overrides the schema
              name specified by the root
              <code class="literal">&lt;hibernate-mapping&gt;</code> element.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">catalog</code> (optional): overrides the
              catalog name specified by the root
              <code class="literal">&lt;hibernate-mapping&gt;</code> element.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">fetch</code> (optional - defaults to
              <code class="literal">join</code>): if set to <code class="literal">join</code>, the
              default, Hibernate will use an inner join to retrieve a
              <code class="literal">&lt;join&gt;</code> defined by a class or its
              superclasses. It will use an outer join for a
              <code class="literal">&lt;join&gt;</code> defined by a subclass. If set to
              <code class="literal">select</code> then Hibernate will use a sequential
              select for a <code class="literal">&lt;join&gt;</code> defined on a
              subclass. This will be issued only if a row represents an
              instance of the subclass. Inner joins will still be used to
              retrieve a <code class="literal">&lt;join&gt;</code> defined by the class
              and its superclasses.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">inverse</code> (optional - defaults to
              <code class="literal">false</code>): if enabled, Hibernate will not insert
              or update the properties defined by this join.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">optional</code> (optional - defaults to
              <code class="literal">false</code>): if enabled, Hibernate will insert a
              row only if the properties defined by this join are non-null. It
              will always use an outer join to retrieve the properties.</p>
            </td></tr></table></div></div>

        <p>For example, address information for a person can be mapped to a
        separate table while preserving value type semantics for all
        properties:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Person"
    table="PERSON"&gt;

    &lt;id name="id" column="PERSON_ID"&gt;...&lt;/id&gt;

    &lt;join table="ADDRESS"&gt;
        &lt;key column="ADDRESS_ID"/&gt;
        &lt;property name="address"/&gt;
        &lt;property name="zip"/&gt;
        &lt;property name="country"/&gt;
    &lt;/join&gt;
    ...</pre>

        <p>This feature is often only useful for legacy data models. We
        recommend fewer tables than classes and a fine-grained domain model.
        However, it is useful for switching between inheritance mapping
        strategies in a single hierarchy, as explained later.</p>
      </div>
    </div>

    <div class="section" title="5.1.7. Mapping one to one and one to many associations"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3628"/>5.1.7. Mapping one to one and one to many associations</h3></div></div></div>
      

      <p>To link one entity to an other, you need to map the association
      property as a to one association. In the relational model, you can
      either use a foreign key or an association table, or (a bit less common)
      share the same primary key value between the two entities.</p>

      <p>To mark an association, use either
      <code class="classname">@ManyToOne</code> or
      <code class="classname">@OnetoOne</code>.</p>

      <p><code class="literal">@ManyToOne</code> and <code class="classname">@OneToOne</code>
      have a parameter named <code class="literal">targetEntity</code> which describes
      the target entity name. You usually don't need this parameter since the
      default value (the type of the property that stores the association) is
      good in almost all cases. However this is useful when you want to use
      interfaces as the return type instead of the regular entity.</p>

      <p>Setting a value of the <code class="literal">cascade</code> attribute to any
      meaningful value other than nothing will propagate certain operations to
      the associated object. The meaningful values are divided into three
      categories.</p>

      <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
          <p>basic operations, which include: <code class="literal">persist, merge,
          delete, save-update, evict, replicate, lock and
          refresh</code>;</p>
        </li><li class="listitem">
          <p>special values: <code class="literal">delete-orphan</code> or
          <code class="literal">all</code> ;</p>
        </li><li class="listitem">
          <p>comma-separated combinations of operation names:
          <code class="literal">cascade="persist,merge,evict"</code> or
          <code class="literal">cascade="all,delete-orphan"</code>. See <a class="xref" href="ch11.html#objectstate-transitive" title="11.11. Transitive persistence">Section 11.11, “Transitive persistence”</a> for a full explanation. Note
          that single valued many-to-one associations do not support orphan
          delete.</p>
        </li></ol></div>

      <p>By default, single point associations are eagerly fetched in JPA
      2. You can mark it as lazily fetched by using
      <code class="classname">@ManyToOne(fetch=FetchType.LAZY) </code>in which case
      Hibernate will proxy the association and load it when the state of the
      associated entity is reached. You can force Hibernate not to use a proxy
      by using <code class="classname">@LazyToOne(NO_PROXY)</code>. In this case, the
      property is fetched lazily when the instance variable is first accessed.
      This requires build-time bytecode instrumentation. lazy="false"
      specifies that the association will always be eagerly fetched.</p>

      <p>With the default JPA options, single-ended associations are loaded
      with a subsequent select if set to <code class="literal">LAZY</code>, or a SQL
      JOIN is used for <code class="literal">EAGER</code> associations. You can however
      adjust the fetching strategy, ie how data is fetched by using
      <code class="literal">@Fetch</code>. <code class="literal">FetchMode</code> can be
      <code class="literal">SELECT</code> (a select is triggered when the association
      needs to be loaded) or <code class="literal">JOIN</code> (use a SQL JOIN to load
      the association while loading the owner entity). <code class="literal">JOIN</code>
      overrides any lazy attribute (an association loaded through a
      <code class="literal">JOIN</code> strategy cannot be lazy).</p>

      <div class="section" title="5.1.7.1. Using a foreign key or an association table"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-manytoone"/>5.1.7.1. Using a foreign key or an association table</h4></div></div></div>
        

        <p>An ordinary association to another persistent class is declared
        using a</p>

        <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
            <p><code class="classname">@ManyToOne</code> if several entities can
            point to the the target entity</p>
          </li><li class="listitem">
            <p><code class="classname">@OneToOne</code> if only a single entity can
            point to the the target entity</p>
          </li></ul></div>

        <p>and a foreign key in one table is referencing the primary key
        column(s) of the target table.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span><span class="java_separator">(</span><span class="java_plain">&nbsp;cascade&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">PERSIST</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">MERGE</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;COMP_ID&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Company</span><span class="java_plain">&nbsp;getCompany</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;company</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <p>The <code class="literal">@JoinColumn</code> attribute is optional, the
        default value(s) is the concatenation of the name of the relationship
        in the owner side, <span class="keycap"><strong>_</strong></span> (underscore), and the name of
        the primary key column in the owned side. In this example
        <code class="literal">company_id</code> because the property name is
        <code class="literal">company</code> and the column id of Company is
        <code class="literal">id</code>.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span><span class="java_separator">(</span><span class="java_plain">&nbsp;cascade&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">PERSIST</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">MERGE</span><span class="java_separator">},</span><span class="java_plain">&nbsp;targetEntity</span><span class="java_operator">=</span><span class="java_type">CompanyImpl</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;COMP_ID&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Company</span><span class="java_plain">&nbsp;getCompany</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;company</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Company</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre>

        <p>You can also map a to one association through an association
        table. This association table described by the
        <code class="literal">@JoinTable</code> annotation will contains a foreign key
        referencing back the entity table (through
        <code class="literal">@JoinTable.joinColumns</code>) and a a foreign key
        referencing the target entity table (through
        <code class="literal">@JoinTable.inverseJoinColumns</code>).</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Flight</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span><span class="java_separator">(</span><span class="java_plain">&nbsp;cascade&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">PERSIST</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">MERGE</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinTable</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;Flight_Company&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joinColumns&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;FLIGHT_ID&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inverseJoinColumns&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;COMP_ID&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Company</span><span class="java_plain">&nbsp;getCompany</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;company</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>You can use a SQL fragment to simulate a physical join column
          using the <code class="classname">@JoinColumnOrFormula</code> /
          <code class="classname">@JoinColumnOrformulas</code> annotations (just like
          you can use a SQL fragment to simulate a property column via the
          <code class="classname">@Formula</code> annotation).</p>

          <pre xmlns="" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Ticket</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Serializable</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumnOrFormula</span><span class="java_separator">(</span><span class="java_plain">formula</span><span class="java_operator">=</span><span class="java_literal">&quot;(firstname&nbsp;+&nbsp;'&nbsp;'&nbsp;+&nbsp;lastname)&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;getOwner</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;person</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>
        </div>

        <p>You can mark an association as mandatory by using the
        <code class="literal">optional=false</code> attribute. We recommend to use Bean
        Validation's <code class="classname">@NotNull</code> annotation as a better
        alternative however. As a consequence, the foreign key column(s) will
        be marked as not nullable (if possible).</p>

        <p>When Hibernate cannot resolve the association because the
        expected associated element is not in database (wrong id on the
        association column), an exception is raised. This might be
        inconvenient for legacy and badly maintained schemas. You can ask
        Hibernate to ignore such elements instead of raising an exception
        using the <code class="literal">@NotFound</code> annotation.</p>

        <div class="example"><a id="d5e3700"/><p class="title"><strong>Example 5.1. @NotFound annotation</strong></p><div class="example-contents">
          

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Child</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotFound</span><span class="java_separator">(</span><span class="java_plain">action</span><span class="java_operator">=</span><span class="java_type">NotFoundAction</span><span class="java_separator">.</span><span class="java_plain">IGNORE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Parent</span><span class="java_plain">&nbsp;getParent</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre>
        </div></div><br class="example-break"/>

        <p>Sometimes you want to delegate to your database the deletion of
        cascade when a given entity is deleted. In this case Hibernate
        generates a cascade delete constraint at the database level.</p>

        <div class="example"><a id="d5e3704"/><p class="title"><strong>Example 5.2. @OnDelete annotation</strong></p><div class="example-contents">
          

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Child</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">OnDelete</span><span class="java_separator">(</span><span class="java_plain">action</span><span class="java_operator">=</span><span class="java_type">OnDeleteAction</span><span class="java_separator">.</span><span class="java_plain">CASCADE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Parent</span><span class="java_plain">&nbsp;getParent</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre>
        </div></div><br class="example-break"/>

        <p>Foreign key constraints, while generated by Hibernate, have a
        fairly unreadable name. You can override the constraint name using
        <code class="literal">@ForeignKey</code>.</p>

        <div class="example"><a id="d5e3709"/><p class="title"><strong>Example 5.3. @ForeignKey annotation</strong></p><div class="example-contents">
          

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Child</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ForeignKey</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;FK_PARENT&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Parent</span><span class="java_plain">&nbsp;getParent</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">alter&nbsp;table&nbsp;</span><span class="java_type">Child</span><span class="java_plain">&nbsp;add&nbsp;constraint&nbsp;FK_PARENT&nbsp;foreign&nbsp;key&nbsp;</span><span class="java_separator">(</span><span class="java_plain">parent_id</span><span class="java_separator">)</span><span class="java_plain">&nbsp;references&nbsp;</span><span class="java_type">Parent</span></pre>
        </div></div><br class="example-break"/>

        <p>Sometimes, you want to link one entity to an other not by the
        target entity primary key but by a different unique key. You can
        achieve that by referencing the unique key column(s) in
        <code class="methodname">@JoinColumn.referenceColumnName</code>.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
class Person {
   @Id Integer personNumber;
   String firstName;
   @Column(name="I")
   String initial;
   String lastName;
}

@Entity
class Home {
   @ManyToOne
   @JoinColumns({
      @JoinColumn(name="first_name", referencedColumnName="firstName"),
      @JoinColumn(name="init", referencedColumnName="I"),
      @JoinColumn(name="last_name", referencedColumnName="lastName"),
   })
   Person owner
}</pre>

        <p>This is not encouraged however and should be reserved to legacy
        mappings.</p>

        <p>In hbm.xml, mapping an association is similar. The main
        difference is that a <code class="classname">@OneToOne</code> is mapped as
        <code class="literal">&lt;many-to-one unique="true"/&gt;</code>, let's dive into
        the subject.</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;many-to-one
        name="propertyName"                                <span class="co" id="manytoone1"><img src="images/callouts/1.png" alt="(1)"/></span>
        column="column_name"                               <span class="co" id="manytoone2"><img src="images/callouts/2.png" alt="(2)"/></span>
        class="ClassName"                                  <span class="co" id="manytoone3"><img src="images/callouts/3.png" alt="(3)"/></span>
        cascade="cascade_style"                            <span class="co" id="manytoone4"><img src="images/callouts/4.png" alt="(4)"/></span>
        fetch="join|select"                                <span class="co" id="manytoone5"><img src="images/callouts/5.png" alt="(5)"/></span>
        update="true|false"                                <span class="co" id="manytoone6"><img src="images/callouts/6.png" alt="(6)"/></span>
        insert="true|false"                                <span class="co" id="manytoone7"><img src="images/callouts/6.png" alt="(6)"/></span>
        property-ref="propertyNameFromAssociatedClass"     <span class="co" id="manytoone8"><img src="images/callouts/7.png" alt="(7)"/></span>
        access="field|property|ClassName"                  <span class="co" id="manytoone9"><img src="images/callouts/8.png" alt="(8)"/></span>
        unique="true|false"                                <span class="co" id="manytoone10"><img src="images/callouts/9.png" alt="(9)"/></span>
        not-null="true|false"                              <span class="co" id="manytoone11"><img src="images/callouts/10.png" alt="(10)"/></span>
        optimistic-lock="true|false"                       <span class="co" id="manytoone12"><img src="images/callouts/11.png" alt="(11)"/></span>
        lazy="proxy|no-proxy|false"                        <span class="co" id="manytoone13"><img src="images/callouts/12.png" alt="(12)"/></span>
        not-found="ignore|exception"                       <span class="co" id="manytoone14"><img src="images/callouts/13.png" alt="(13)"/></span>
        entity-name="EntityName"                           <span class="co" id="manytoone15"><img src="images/callouts/14.png" alt="(14)"/></span>
        formula="arbitrary SQL expression"                 <span class="co" id="manytoone16"><img src="images/callouts/15.png" alt="(15)"/></span>
        node="element-name|@attribute-name|element/@attribute|."
        embed-xml="true|false"
        index="index_name"
        unique_key="unique_key_id"
        foreign-key="foreign_key_name"
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the name of the property.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">column</code> (optional): the name of the
              foreign key column. This can also be specified by nested
              <code class="literal">&lt;column&gt;</code> element(s).</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">class</code> (optional - defaults to the
              property type determined by reflection): the name of the
              associated class.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">cascade</code> (optional): specifies which
              operations should be cascaded from the parent object to the
              associated object.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">fetch</code> (optional - defaults to
              <code class="literal">select</code>): chooses between outer-join fetching
              or sequential select fetching.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">update, insert</code> (optional - defaults to
              <code class="literal">true</code>): specifies that the mapped columns
              should be included in SQL <code class="literal">UPDATE</code> and/or
              <code class="literal">INSERT</code> statements. Setting both to
              <code class="literal">false</code> allows a pure "derived" association
              whose value is initialized from another property that maps to
              the same column(s), or by a trigger or other application.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">property-ref</code> (optional): the name of a
              property of the associated class that is joined to this foreign
              key. If not specified, the primary key of the associated class
              is used.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">access</code> (optional - defaults to
              <code class="literal">property</code>): the strategy Hibernate uses for
              accessing the property value.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/9.png" alt="9" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">unique</code> (optional): enables the DDL
              generation of a unique constraint for the foreign-key column. By
              allowing this to be the target of a
              <code class="literal">property-ref</code>, you can make the association
              multiplicity one-to-one.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/10.png" alt="10" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">not-null</code> (optional): enables the DDL
              generation of a nullability constraint for the foreign key
              columns.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/11.png" alt="11" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">optimistic-lock</code> (optional - defaults to
              <code class="literal">true</code>): specifies that updates to this
              property do or do not require acquisition of the optimistic
              lock. In other words, it determines if a version increment
              should occur when this property is dirty.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/12.png" alt="12" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">lazy</code> (optional - defaults to
              <code class="literal">proxy</code>): by default, single point associations
              are proxied. <code class="literal">lazy="no-proxy"</code> specifies that
              the property should be fetched lazily when the instance variable
              is first accessed. This requires build-time bytecode
              instrumentation. <code class="literal">lazy="false"</code> specifies that
              the association will always be eagerly fetched.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/13.png" alt="13" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">not-found</code> (optional - defaults to
              <code class="literal">exception</code>): specifies how foreign keys that
              reference missing rows will be handled.
              <code class="literal">ignore</code> will treat a missing row as a null
              association.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/14.png" alt="14" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">entity-name</code> (optional): the entity name
              of the associated class.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/15.png" alt="15" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">formula</code> (optional): an SQL expression
              that defines the value for a <span class="emphasis"><em>computed</em></span>
              foreign key.</p>
            </td></tr></table></div></div>

        <p>Setting a value of the <code class="literal">cascade</code> attribute to
        any meaningful value other than <code class="literal">none</code> will propagate
        certain operations to the associated object. The meaningful values are
        divided into three categories. First, basic operations, which include:
        <code class="literal">persist, merge, delete, save-update, evict, replicate, lock
        and refresh</code>; second, special values:
        <code class="literal">delete-orphan</code>; and third,<code class="literal">all</code>
        comma-separated combinations of operation names:
        <code class="literal">cascade="persist,merge,evict"</code> or
        <code class="literal">cascade="all,delete-orphan"</code>. See <a class="xref" href="ch11.html#objectstate-transitive" title="11.11. Transitive persistence">Section 11.11, “Transitive persistence”</a> for a full explanation. Note that
        single valued, many-to-one and one-to-one, associations do not support
        orphan delete.</p>

        <p>Here is an example of a typical <code class="literal">many-to-one</code>
        declaration:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;many-to-one name="product" class="Product" column="PRODUCT_ID"/&gt;</pre>

        <p>The <code class="literal">property-ref</code> attribute should only be
        used for mapping legacy data where a foreign key refers to a unique
        key of the associated table other than the primary key. This is a
        complicated and confusing relational model. For example, if the
        <code class="literal">Product</code> class had a unique serial number that is
        not the primary key. The <code class="literal">unique</code> attribute controls
        Hibernate's DDL generation with the SchemaExport tool.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;property name="serialNumber" unique="true" type="string" column="SERIAL_NUMBER"/&gt;</pre>

        <p>Then the mapping for <code class="literal">OrderItem</code> might
        use:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;many-to-one name="product" property-ref="serialNumber" column="PRODUCT_SERIAL_NUMBER"/&gt;</pre>

        <p>This is not encouraged, however.</p>

        <p>If the referenced unique key comprises multiple properties of
        the associated entity, you should map the referenced properties inside
        a named <code class="literal">&lt;properties&gt;</code> element.</p>

        <p>If the referenced unique key is the property of a component, you
        can specify a property path:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;many-to-one name="owner" property-ref="identity.ssn" column="OWNER_SSN"/&gt;</pre>
      </div>

      <div class="section" title="5.1.7.2. Sharing the primary key with the associated entity"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-onetoone"/>5.1.7.2. Sharing the primary key with the associated entity</h4></div></div></div>
        

        <p>The second approach is to ensure an entity and its associated
        entity share the same primary key. In this case the primary key column
        is also a foreign key and there is no extra column. These associations
        are always one to one.</p>

        <div class="example"><a id="d5e3828"/><p class="title"><strong>Example 5.4. One to One association</strong></p><div class="example-contents">
          

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Body</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span><span class="java_plain">&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">OneToOne</span><span class="java_separator">(</span><span class="java_plain">cascade&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CascadeType</span><span class="java_separator">.</span><span class="java_plain">ALL</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">MapsId</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Heart</span><span class="java_plain">&nbsp;getHeart</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;heart</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Heart</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;getId</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">...}</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>
        </div></div><br class="example-break"/>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>Many people got confused by these primary key based one to one
          associations. They can only be lazily loaded if Hibernate knows that
          the other side of the association is always present. To indicate to
          Hibernate that it is the case, use
          <code class="classname">@OneToOne(optional=false)</code>.</p>
        </div>

        <p>In hbm.xml, use the following mapping.</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;one-to-one
        name="propertyName"                                <span class="co" id="onetoone1"><img src="images/callouts/1.png" alt="(1)"/></span>
        class="ClassName"                                  <span class="co" id="onetoone2"><img src="images/callouts/2.png" alt="(2)"/></span>
        cascade="cascade_style"                            <span class="co" id="onetoone3"><img src="images/callouts/3.png" alt="(3)"/></span>
        constrained="true|false"                           <span class="co" id="onetoone4"><img src="images/callouts/4.png" alt="(4)"/></span>
        fetch="join|select"                                <span class="co" id="onetoone5"><img src="images/callouts/5.png" alt="(5)"/></span>
        property-ref="propertyNameFromAssociatedClass"     <span class="co" id="onetoone6"><img src="images/callouts/6.png" alt="(6)"/></span>
        access="field|property|ClassName"                  <span class="co" id="onetoone7"><img src="images/callouts/7.png" alt="(7)"/></span>
        formula="any SQL expression"                       <span class="co" id="onetoone8"><img src="images/callouts/8.png" alt="(8)"/></span>
        lazy="proxy|no-proxy|false"                        <span class="co" id="onetoone9"><img src="images/callouts/9.png" alt="(9)"/></span>
        entity-name="EntityName"                           <span class="co" id="onetoone10"><img src="images/callouts/10.png" alt="(10)"/></span>
        node="element-name|@attribute-name|element/@attribute|."
        embed-xml="true|false"
        foreign-key="foreign_key_name"
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">name</code>: the name of the property.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">class</code> (optional - defaults to the
              property type determined by reflection): the name of the
              associated class.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">cascade</code> (optional): specifies which
              operations should be cascaded from the parent object to the
              associated object.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">constrained</code> (optional): specifies that
              a foreign key constraint on the primary key of the mapped table
              and references the table of the associated class. This option
              affects the order in which <code class="literal">save()</code> and
              <code class="literal">delete()</code> are cascaded, and determines whether
              the association can be proxied. It is also used by the schema
              export tool.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">fetch</code> (optional - defaults to
              <code class="literal">select</code>): chooses between outer-join fetching
              or sequential select fetching.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">property-ref</code> (optional): the name of a
              property of the associated class that is joined to the primary
              key of this class. If not specified, the primary key of the
              associated class is used.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">access</code> (optional - defaults to
              <code class="literal">property</code>): the strategy Hibernate uses for
              accessing the property value.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/8.png" alt="8" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">formula</code> (optional): almost all
              one-to-one associations map to the primary key of the owning
              entity. If this is not the case, you can specify another column,
              columns or expression to join on using an SQL formula. See
              <code class="literal">org.hibernate.test.onetooneformula</code> for an
              example.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/9.png" alt="9" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">lazy</code> (optional - defaults to
              <code class="literal">proxy</code>): by default, single point associations
              are proxied. <code class="literal">lazy="no-proxy"</code> specifies that
              the property should be fetched lazily when the instance variable
              is first accessed. It requires build-time bytecode
              instrumentation. <code class="literal">lazy="false"</code> specifies that
              the association will always be eagerly fetched. <span class="emphasis"><em>Note
              that if <code class="literal">constrained="false"</code>, proxying is
              impossible and Hibernate will eagerly fetch the
              association</em></span>.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/10.png" alt="10" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">entity-name</code> (optional): the entity name
              of the associated class.</p>
            </td></tr></table></div></div>

        <p>Primary key associations do not need an extra table column. If
        two rows are related by the association, then the two table rows share
        the same primary key value. To relate two objects by a primary key
        association, ensure that they are assigned the same identifier
        value.</p>

        <p>For a primary key association, add the following mappings to
        <code class="literal">Employee</code> and <code class="literal">Person</code>
        respectively:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;one-to-one name="person" class="Person"/&gt;</pre>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;one-to-one name="employee" class="Employee" constrained="true"/&gt;</pre>

        <p>Ensure that the primary keys of the related rows in the PERSON
        and EMPLOYEE tables are equal. You use a special Hibernate identifier
        generation strategy called <code class="literal">foreign</code>:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="person" table="PERSON"&gt;
    &lt;id name="id" column="PERSON_ID"&gt;
        &lt;generator class="foreign"&gt;
            &lt;param name="property"&gt;employee&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;
    ...
    &lt;one-to-one name="employee"
        class="Employee"
        constrained="true"/&gt;
&lt;/class&gt;</pre>

        <p>A newly saved instance of <code class="literal">Person</code> is assigned
        the same primary key value as the <code class="literal">Employee</code> instance
        referred with the <code class="literal">employee</code> property of that
        <code class="literal">Person</code>.</p>
      </div>
    </div>

    <div class="section" title="5.1.8. Natural-id"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-declaration-naturalid"/>5.1.8. Natural-id</h3></div></div></div>
      

      <p>Although we recommend the use of surrogate keys as primary keys,
      you should try to identify natural keys for all entities. A natural key
      is a property or combination of properties that is unique and non-null.
      It is also immutable. Map the properties of the natural key as
      <code class="classname">@NaturalId</code> or map them inside the
      <code class="literal">&lt;natural-id&gt;</code> element. Hibernate will generate
      the necessary unique key and nullability constraints and, as a result,
      your mapping will be more self-documenting.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Citizen</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">GeneratedValue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;firstname</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastname</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NaturalId</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ManyToOne</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">State</span><span class="java_plain">&nbsp;state</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NaturalId</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;ssn</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">and&nbsp;later&nbsp;on&nbsp;query</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;results&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;s</span><span class="java_separator">.</span><span class="java_plain">createCriteria</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Citizen</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Restrictions</span><span class="java_separator">.</span><span class="java_plain">naturalId</span><span class="java_separator">().</span><span class="java_plain">set</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;ssn&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;1234&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">set</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;state&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ste&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">list</span><span class="java_separator">();</span></pre>

      <p>Or in XML,</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;natural-id mutable="true|false"/&gt;
        &lt;property ... /&gt;
        &lt;many-to-one ... /&gt;
        ......
&lt;/natural-id&gt;</pre>

      <p>It is recommended that you implement <code class="literal">equals()</code>
      and <code class="literal">hashCode()</code> to compare the natural key properties
      of the entity.</p>

      <p>This mapping is not intended for use with entities that have
      natural primary keys.</p>

      <div class="itemizedlist"><ul class="itemizedlist" compact="compact"><li class="listitem">
          <p><code class="literal">mutable</code> (optional - defaults to
          <code class="literal">false</code>): by default, natural identifier properties
          are assumed to be immutable (constant).</p>
        </li></ul></div>
    </div>

    <div class="section" title="5.1.9. Any"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-types-anymapping"/>5.1.9. Any</h3></div></div></div>
      

      <p>There is one more type of property mapping. The
      <code class="classname">@Any</code> mapping defines a polymorphic association to
      classes from multiple tables. This type of mapping requires more than
      one column. The first column contains the type of the associated entity.
      The remaining columns contain the identifier. It is impossible to
      specify a foreign key constraint for this kind of association. This is
      not the usual way of mapping polymorphic associations and you should use
      this only in special cases. For example, for audit logs, user session
      data, etc.</p>

      <p>The <code class="classname">@Any</code> annotation describes the column
      holding the metadata information. To link the value of the metadata
      information and an actual entity type, The
      <code class="classname">@AnyDef</code> and <code class="classname">@AnyDefs</code>
      annotations are used. The <code class="literal">metaType</code> attribute allows
      the application to specify a custom type that maps database column
      values to persistent classes that have identifier properties of the type
      specified by <code class="literal">idType</code>. You must specify the mapping
      from values of the <code class="literal">metaType</code> to class names.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Any</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;metaColumn&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;@</span><!-- <br/> --><span class="java_type">Column</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;name&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;property_type&quot;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">),</span><!-- <br/> --><span class="java_plain">&nbsp;fetch</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_type">FetchType</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">EAGER&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">AnyMetaDef</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;idType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;integer&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;metaType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;string&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;metaValues&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">MetaValue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;S&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;targetEntity&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">StringProperty</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">MetaValue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;I&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;targetEntity&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">IntegerProperty</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;property_id&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Property</span><span class="java_plain">&nbsp;getMainProperty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;mainProperty</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre>

      <p>Note that <code class="classname">@AnyDef</code> can be mutualized and
      reused. It is recommended to place it as a package metadata in this
      case.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">on&nbsp;a&nbsp;</span><!-- <br/> --><span class="java_keyword">package</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">AnyMetaDef</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name</span><span class="java_operator">=</span><span class="java_literal">&quot;property&quot;</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;idType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;integer&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;metaType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;string&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;metaValues&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">MetaValue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;S&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;targetEntity&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">StringProperty</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">MetaValue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;I&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;targetEntity&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">IntegerProperty</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">package</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">test</span><span class="java_separator">.</span><span class="java_plain">annotations</span><span class="java_separator">.</span><span class="java_plain">any</span><span class="java_separator">;</span>
</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">in&nbsp;a&nbsp;</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Any</span><span class="java_separator">(</span><span class="java_plain">&nbsp;metaDef</span><span class="java_operator">=</span><span class="java_literal">&quot;property&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;metaColumn&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;@</span><span class="java_type">Column</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;property_type&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span><span class="java_plain">&nbsp;fetch</span><span class="java_operator">=</span><span class="java_type">FetchType</span><span class="java_separator">.</span><span class="java_plain">EAGER&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">JoinColumn</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;property_id&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Property</span><span class="java_plain">&nbsp;getMainProperty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;mainProperty</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span></pre>

      <p>The hbm.xml equivalent is:</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;any name="being" id-type="long" meta-type="string"&gt;
    &lt;meta-value value="TBL_ANIMAL" class="Animal"/&gt;
    &lt;meta-value value="TBL_HUMAN" class="Human"/&gt;
    &lt;meta-value value="TBL_ALIEN" class="Alien"/&gt;
    &lt;column name="table_name"/&gt;
    &lt;column name="id"/&gt;
&lt;/any&gt;</pre>

      <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
        <p>You cannot mutualize the metadata in hbm.xml as you can in
        annotations.</p>
      </div>

      <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;any
        name="propertyName"                                <span class="co" id="any1"><img src="images/callouts/1.png" alt="(1)"/></span>
        id-type="idtypename"                               <span class="co" id="any2"><img src="images/callouts/2.png" alt="(2)"/></span>
        meta-type="metatypename"                           <span class="co" id="any3"><img src="images/callouts/3.png" alt="(3)"/></span>
        cascade="cascade_style"                            <span class="co" id="any4"><img src="images/callouts/4.png" alt="(4)"/></span>
        access="field|property|ClassName"                  <span class="co" id="any5"><img src="images/callouts/5.png" alt="(5)"/></span>
        optimistic-lock="true|false"                       <span class="co" id="any6"><img src="images/callouts/6.png" alt="(6)"/></span>
&gt;
        &lt;meta-value ... /&gt;
        &lt;meta-value ... /&gt;
        .....
        &lt;column .... /&gt;
        &lt;column .... /&gt;
        .....
&lt;/any&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">name</code>: the property name.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">id-type</code>: the identifier type.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">meta-type</code> (optional - defaults to
            <code class="literal">string</code>): any type that is allowed for a
            discriminator mapping.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">cascade</code> (optional- defaults to
            <code class="literal">none</code>): the cascade style.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">access</code> (optional - defaults to
            <code class="literal">property</code>): the strategy Hibernate uses for
            accessing the property value.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">optimistic-lock</code> (optional - defaults to
            <code class="literal">true</code>): specifies that updates to this property
            either do or do not require acquisition of the optimistic lock. It
            defines whether a version increment should occur if this property
            is dirty.</p>
          </td></tr></table></div></div>
    </div>

    <div class="section" title="5.1.10. Properties"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-declaration-properties"/>5.1.10. Properties</h3></div></div></div>
      

      <p>The <code class="literal">&lt;properties&gt;</code> element allows the
      definition of a named, logical grouping of the properties of a class.
      The most important use of the construct is that it allows a combination
      of properties to be the target of a <code class="literal">property-ref</code>. It
      is also a convenient way to define a multi-column unique constraint. For
      example:</p>

      <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;properties
        name="logicalName"                                 <span class="co" id="properties1"><img src="images/callouts/1.png" alt="(1)"/></span>
        insert="true|false"                                <span class="co" id="properties2"><img src="images/callouts/2.png" alt="(2)"/></span>
        update="true|false"                                <span class="co" id="properties3"><img src="images/callouts/3.png" alt="(3)"/></span>
        optimistic-lock="true|false"                       <span class="co" id="properties4"><img src="images/callouts/4.png" alt="(4)"/></span>
        unique="true|false"                                <span class="co" id="properties5"><img src="images/callouts/5.png" alt="(5)"/></span>
&gt;

        &lt;property ...../&gt;
        &lt;many-to-one .... /&gt;
        ........
&lt;/properties&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">name</code>: the logical name of the grouping.
            It is <span class="emphasis"><em>not</em></span> an actual property name.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">insert</code>: do the mapped columns appear in
            SQL <code class="literal">INSERTs</code>?</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">update</code>: do the mapped columns appear in
            SQL <code class="literal">UPDATEs</code>?</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">optimistic-lock</code> (optional - defaults to
            <code class="literal">true</code>): specifies that updates to these
            properties either do or do not require acquisition of the
            optimistic lock. It determines if a version increment should occur
            when these properties are dirty.</p>
          </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
            <p><code class="literal">unique</code> (optional - defaults to
            <code class="literal">false</code>): specifies that a unique constraint
            exists upon all mapped columns of the component.</p>
          </td></tr></table></div></div>

      <p>For example, if we have the following
      <code class="literal">&lt;properties&gt;</code> mapping:</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Person"&gt;
    &lt;id name="personNumber"/&gt;

    ...
    &lt;properties name="name"
            unique="true" update="false"&gt;
        &lt;property name="firstName"/&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="lastName"/&gt;
    &lt;/properties&gt;
&lt;/class&gt;</pre>

      <p>You might have some legacy data association that refers to this
      unique key of the <code class="literal">Person</code> table, instead of to the
      primary key:</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;many-to-one name="owner"
         class="Person" property-ref="name"&gt;
    &lt;column name="firstName"/&gt;
    &lt;column name="initial"/&gt;
    &lt;column name="lastName"/&gt;
&lt;/many-to-one&gt;</pre>

      <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
        <p>When using annotations as a mapping strategy, such construct is
        not necessary as the binding between a column and its related column
        on the associated table is done directly</p>

        <pre xmlns="" class="">@Entity
class Person {
   @Id Integer personNumber;
   String firstName;
   @Column(name="I")
   String initial;
   String lastName;
}

@Entity
class Home {
   @ManyToOne
   @JoinColumns({
      @JoinColumn(name="first_name", referencedColumnName="firstName"),
      @JoinColumn(name="init", referencedColumnName="I"),
      @JoinColumn(name="last_name", referencedColumnName="lastName"),
   })
   Person owner
}</pre>
      </div>

      <p>The use of this outside the context of mapping legacy data is not
      recommended.</p>
    </div>

    <div class="section" title="5.1.11. Some hbm.xml specificities"><div class="titlepage"><div><div><h3 class="title"><a id="d5e4015"/>5.1.11. Some hbm.xml specificities</h3></div></div></div>
      

      <p>The hbm.xml structure has some specificities naturally not present
      when using annotations, let's describe them briefly.</p>

      <div class="section" title="5.1.11.1. Doctype"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-doctype"/>5.1.11.1. Doctype</h4></div></div></div>
        

        <p>All XML mappings should declare the doctype shown. The actual
        DTD can be found at the URL above, in the directory
        <code class="literal">hibernate-x.x.x/src/org/hibernate </code>, or in
        <code class="literal">hibernate3.jar</code>. Hibernate will always look for the
        DTD in its classpath first. If you experience lookups of the DTD using
        an Internet connection, check the DTD declaration against the contents
        of your classpath.</p>

        <div class="section" title="5.1.11.1.1. EntityResolver"><div class="titlepage"><div><div><h5 class="title"><a id="mapping-declaration-entity-resolution"/>5.1.11.1.1. EntityResolver</h5></div></div></div>
          

          <p>Hibernate will first attempt to resolve DTDs in its classpath.
          It does this is by registering a custom
          <code class="literal">org.xml.sax.EntityResolver</code> implementation with
          the SAXReader it uses to read in the xml files. This custom
          <code class="literal">EntityResolver</code> recognizes two different systemId
          namespaces:</p>

          <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
              <p>a <code class="literal">hibernate namespace</code> is recognized
              whenever the resolver encounters a systemId starting with
              <code class="literal">http://www.hibernate.org/dtd/</code>. The resolver
              attempts to resolve these entities via the classloader which
              loaded the Hibernate classes.</p>
            </li><li class="listitem">
              <p>a <code class="literal">user namespace</code> is recognized whenever
              the resolver encounters a systemId using a
              <code class="literal">classpath://</code> URL protocol. The resolver will
              attempt to resolve these entities via (1) the current thread
              context classloader and (2) the classloader which loaded the
              Hibernate classes.</p>
            </li></ul></div>

          <p>The following is an example of utilizing user
          namespacing:</p>

          <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain"></span><br />
<span class="xml_processing_instruction">&lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_plain">!</span><span class="xml_attribute_name">DOCTYPE</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">hibernate-mapping</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">PUBLIC</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_value">&quot;-//Hibernate/Hibernate&nbsp;Mapping&nbsp;DTD&nbsp;3.0//EN&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_value">&quot;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd&quot;</span><span class="xml_plain">&nbsp;[</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&lt;!</span><span class="xml_attribute_name">ENTITY</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">types</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">SYSTEM</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_value">&quot;classpath://your/domain/types.xml&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">]&gt;</span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">hibernate-mapping</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">package</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;your.domain&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">class</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;MyEntity&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">id</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;id&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;my-custom-id-type&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">id</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&amp;types;</span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">hibernate-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
</pre>

          <p>Where <code class="literal">types.xml</code> is a resource in the
          <code class="literal">your.domain</code> package and contains a custom <a class="link" href="ch05.html#mapping-types-custom" title="5.2.3. Custom value types">typedef</a>.</p>
        </div>
      </div>

      <div class="section" title="5.1.11.2. Hibernate-mapping"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-mapping"/>5.1.11.2. Hibernate-mapping</h4></div></div></div>
        

        <p>This element has several optional attributes. The
        <code class="literal">schema</code> and <code class="literal">catalog</code> attributes
        specify that tables referred to in this mapping belong to the named
        schema and/or catalog. If they are specified, tablenames will be
        qualified by the given schema and catalog names. If they are missing,
        tablenames will be unqualified. The <code class="literal">default-cascade</code>
        attribute specifies what cascade style should be assumed for
        properties and collections that do not specify a
        <code class="literal">cascade</code> attribute. By default, the
        <code class="literal">auto-import</code> attribute allows you to use unqualified
        class names in the query language.</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;hibernate-mapping
         schema="schemaName"                               <span class="co" id="hm1"><img src="images/callouts/1.png" alt="(1)"/></span>
         catalog="catalogName"                             <span class="co" id="hm2"><img src="images/callouts/2.png" alt="(2)"/></span>
         default-cascade="cascade_style"                   <span class="co" id="hm3"><img src="images/callouts/3.png" alt="(3)"/></span>
         default-access="field|property|ClassName"         <span class="co" id="hm4"><img src="images/callouts/4.png" alt="(4)"/></span>
         default-lazy="true|false"                         <span class="co" id="hm5"><img src="images/callouts/5.png" alt="(5)"/></span>
         auto-import="true|false"                          <span class="co" id="hm6"><img src="images/callouts/6.png" alt="(6)"/></span>
         package="package.name"                            <span class="co" id="hm7"><img src="images/callouts/7.png" alt="(7)"/></span>
 /&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">schema</code> (optional): the name of a
              database schema.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">catalog</code> (optional): the name of a
              database catalog.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">default-cascade</code> (optional - defaults to
              <code class="literal">none</code>): a default cascade style.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">default-access</code> (optional - defaults to
              <code class="literal">property</code>): the strategy Hibernate should use
              for accessing all properties. It can be a custom implementation
              of <code class="literal">PropertyAccessor</code>.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">default-lazy</code> (optional - defaults to
              <code class="literal">true</code>): the default value for unspecified
              <code class="literal">lazy</code> attributes of class and collection
              mappings.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">auto-import</code> (optional - defaults to
              <code class="literal">true</code>): specifies whether we can use
              unqualified class names of classes in this mapping in the query
              language.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/7.png" alt="7" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">package</code> (optional): specifies a package
              prefix to use for unqualified class names in the mapping
              document.</p>
            </td></tr></table></div></div>

        <p>If you have two persistent classes with the same unqualified
        name, you should set <code class="literal">auto-import="false"</code>. An
        exception will result if you attempt to assign two classes to the same
        "imported" name.</p>

        <p>The <code class="literal">hibernate-mapping</code> element allows you to
        nest several persistent <code class="literal">&lt;class&gt;</code> mappings, as
        shown above. It is, however, good practice (and expected by some
        tools) to map only a single persistent class, or a single class
        hierarchy, in one mapping file and name it after the persistent
        superclass. For example, <code class="literal">Cat.hbm.xml</code>,
        <code class="literal">Dog.hbm.xml</code>, or if using inheritance,
        <code class="literal">Animal.hbm.xml</code>.</p>
      </div>

      <div class="section" title="5.1.11.3. Key"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-key"/>5.1.11.3. Key</h4></div></div></div>
        

        <p>The <code class="literal">&lt;key&gt;</code> element is featured a few
        times within this guide. It appears anywhere the parent mapping
        element defines a join to a new table that references the primary key
        of the original table. It also defines the foreign key in the joined
        table:</p>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;key
        column="columnname"                                <span class="co" id="key1"><img src="images/callouts/1.png" alt="(1)"/></span>
        on-delete="noaction|cascade"                       <span class="co" id="key2"><img src="images/callouts/2.png" alt="(2)"/></span>
        property-ref="propertyName"                        <span class="co" id="key3"><img src="images/callouts/3.png" alt="(3)"/></span>
        not-null="true|false"                              <span class="co" id="key4"><img src="images/callouts/4.png" alt="(4)"/></span>
        update="true|false"                                <span class="co" id="key5"><img src="images/callouts/5.png" alt="(5)"/></span>
        unique="true|false"                                <span class="co" id="key6"><img src="images/callouts/6.png" alt="(6)"/></span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">column</code> (optional): the name of the
              foreign key column. This can also be specified by nested
              <code class="literal">&lt;column&gt;</code> element(s).</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">on-delete</code> (optional - defaults to
              <code class="literal">noaction</code>): specifies whether the foreign key
              constraint has database-level cascade delete enabled.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/3.png" alt="3" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">property-ref</code> (optional): specifies that
              the foreign key refers to columns that are not the primary key
              of the original table. It is provided for legacy data.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/4.png" alt="4" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">not-null</code> (optional): specifies that the
              foreign key columns are not nullable. This is implied whenever
              the foreign key is also part of the primary key.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/5.png" alt="5" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">update</code> (optional): specifies that the
              foreign key should never be updated. This is implied whenever
              the foreign key is also part of the primary key.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/6.png" alt="6" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">unique</code> (optional): specifies that the
              foreign key should have a unique constraint. This is implied
              whenever the foreign key is also the primary key.</p>
            </td></tr></table></div></div>

        <p>For systems where delete performance is important, we recommend
        that all keys should be defined
        <code class="literal">on-delete="cascade"</code>. Hibernate uses a
        database-level <code class="literal">ON CASCADE DELETE</code> constraint,
        instead of many individual <code class="literal">DELETE</code> statements. Be
        aware that this feature bypasses Hibernate's usual optimistic locking
        strategy for versioned data.</p>

        <p>The <code class="literal">not-null</code> and <code class="literal">update</code>
        attributes are useful when mapping a unidirectional one-to-many
        association. If you map a unidirectional one-to-many association to a
        non-nullable foreign key, you <span class="emphasis"><em>must</em></span> declare the
        key column using <code class="literal">&lt;key
        not-null="true"&gt;</code>.</p>
      </div>

      <div class="section" title="5.1.11.4. Import"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-declaration-import"/>5.1.11.4. Import</h4></div></div></div>
        

        <p>If your application has two persistent classes with the same
        name, and you do not want to specify the fully qualified package name
        in Hibernate queries, classes can be "imported" explicitly, rather
        than relying upon <code class="literal">auto-import="true"</code>. You can also
        import classes and interfaces that are not explicitly mapped:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;import class="java.lang.Object" rename="Universe"/&gt;</pre>

        <div class="programlistingco"><pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;import
        class="ClassName"                                  <span class="co" id="import1"><img src="images/callouts/1.png" alt="(1)"/></span>
        rename="ShortName"                                 <span class="co" id="import2"><img src="images/callouts/2.png" alt="(2)"/></span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/1.png" alt="1" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">class</code>: the fully qualified class name
              of any Java class.</p>
            </td></tr><tr><td width="5%" valign="top" align="left"><p><img src="images/callouts/2.png" alt="2" border="0"/></p></td><td valign="top" align="left">
              <p><code class="literal">rename</code> (optional - defaults to the
              unqualified class name): a name that can be used in the query
              language.</p>
            </td></tr></table></div></div>

        <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
          <p>This feature is unique to hbm.xml and is not supported in
          annotations.</p>
        </div>
      </div>

      <div class="section" title="5.1.11.5. Column and formula elements"><div class="titlepage"><div><div><h4 class="title"><a id="mapping-column"/>5.1.11.5. Column and formula elements</h4></div></div></div>
        

        <p>Mapping elements which accept a <code class="literal">column</code>
        attribute will alternatively accept a
        <code class="literal">&lt;column&gt;</code> subelement. Likewise,
        <code class="literal">&lt;formula&gt;</code> is an alternative to the
        <code class="literal">formula</code> attribute. For example:</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;column
        name="column_name"
        length="N"
        precision="N"
        scale="N"
        not-null="true|false"
        unique="true|false"
        unique-key="multicolumn_unique_key_name"
        index="index_name"
        sql-type="sql_type_name"
        check="SQL expression"
        default="SQL expression"
        read="SQL expression"
        write="SQL expression"/&gt;</pre>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;formula&gt;SQL expression&lt;/formula&gt;</pre>

        <p>Most of the attributes on <code class="literal">column</code> provide a
        means of tailoring the DDL during automatic schema generation. The
        <code class="literal">read</code> and <code class="literal">write</code> attributes allow
        you to specify custom SQL that Hibernate will use to access the
        column's value. For more on this, see the discussion of <a class="link" href="ch05.html#mapping-column-read-and-write" title="5.6. Column transformers: read and write expressions">column read and write
        expressions</a>.</p>

        <p>The <code class="literal">column</code> and <code class="literal">formula</code>
        elements can even be combined within the same property or association
        mapping to express, for example, exotic join conditions.</p>

        <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;many-to-one name="homeAddress" class="Address"
        insert="false" update="false"&gt;
    &lt;column name="person_id" not-null="true" length="10"/&gt;
    &lt;formula&gt;'MAILING'&lt;/formula&gt;
&lt;/many-to-one&gt;</pre>
      </div>
    </div>
  </div>

  <div class="section" title="5.2. Hibernate types"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-types"/>5.2. Hibernate types</h2></div></div></div>
    

    <div class="section" title="5.2.1. Entities and values"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-types-entitiesvalues"/>5.2.1. Entities and values</h3></div></div></div>
      

      <p>In relation to the persistence service, Java language-level
      objects are classified into two groups:</p>

      <p>An <span class="emphasis"><em>entity</em></span> exists independently of any other
      objects holding references to the entity. Contrast this with the usual
      Java model, where an unreferenced object is garbage collected. Entities
      must be explicitly saved and deleted. Saves and deletions, however, can
      be <span class="emphasis"><em>cascaded</em></span> from a parent entity to its children.
      This is different from the ODMG model of object persistence by
      reachability and corresponds more closely to how application objects are
      usually used in large systems. Entities support circular and shared
      references. They can also be versioned.</p>

      <p>An entity's persistent state consists of references to other
      entities and instances of <span class="emphasis"><em>value</em></span> types. Values are
      primitives: collections (not what is inside a collection), components
      and certain immutable objects. Unlike entities, values in particular
      collections and components, <span class="emphasis"><em>are</em></span> persisted and
      deleted by reachability. Since value objects and primitives are
      persisted and deleted along with their containing entity, they cannot be
      independently versioned. Values have no independent identity, so they
      cannot be shared by two entities or collections.</p>

      <p>Until now, we have been using the term "persistent class" to refer
      to entities. We will continue to do that. Not all user-defined classes
      with a persistent state, however, are entities. A
      <span class="emphasis"><em>component</em></span> is a user-defined class with value
      semantics. A Java property of type <code class="literal">java.lang.String</code>
      also has value semantics. Given this definition, all types (classes)
      provided by the JDK have value type semantics in Java, while
      user-defined types can be mapped with entity or value type semantics.
      This decision is up to the application developer. An entity class in a
      domain model will normally have shared references to a single instance
      of that class, while composition or aggregation usually translates to a
      value type.</p>

      <p>We will revisit both concepts throughout this reference
      guide.</p>

      <p>The challenge is to map the Java type system, and the developers'
      definition of entities and value types, to the SQL/database type system.
      The bridge between both systems is provided by Hibernate. For entities,
      <code class="literal">&lt;class&gt;</code>, <code class="literal">&lt;subclass&gt;</code>
      and so on are used. For value types we use
      <code class="literal">&lt;property&gt;</code>,
      <code class="literal">&lt;component&gt;</code>etc., that usually have a
      <code class="literal">type</code> attribute. The value of this attribute is the
      name of a Hibernate <span class="emphasis"><em>mapping type</em></span>. Hibernate
      provides a range of mappings for standard JDK value types out of the
      box. You can write your own mapping types and implement your own custom
      conversion strategies.</p>

      <p>With the exception of collections, all built-in Hibernate types
      support null semantics.</p>
    </div>

    <div class="section" title="5.2.2. Basic value types"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-types-basictypes"/>5.2.2. Basic value types</h3></div></div></div>
      

      <p>The built-in <span class="emphasis"><em>basic mapping types</em></span> can be
      roughly categorized into the following: </p><div class="variablelist"><dl><dt><span class="term"><code class="literal">integer, long, short, float, double, character,
            byte, boolean, yes_no, true_false</code></span></dt><dd>
              <p>Type mappings from Java primitives or wrapper classes to
              appropriate (vendor-specific) SQL column types.
              <code class="literal">boolean, yes_no</code> and
              <code class="literal">true_false</code> are all alternative encodings for
              a Java <code class="literal">boolean</code> or
              <code class="literal">java.lang.Boolean</code>.</p>
            </dd><dt><span class="term"><code class="literal">string</code></span></dt><dd>
              <p>A type mapping from <code class="literal">java.lang.String</code> to
              <code class="literal">VARCHAR</code> (or Oracle
              <code class="literal">VARCHAR2</code>).</p>
            </dd><dt><span class="term"><code class="literal">date, time, timestamp</code></span></dt><dd>
              <p>Type mappings from <code class="literal">java.util.Date</code> and
              its subclasses to SQL types <code class="literal">DATE</code>,
              <code class="literal">TIME</code> and <code class="literal">TIMESTAMP</code> (or
              equivalent).</p>
            </dd><dt><span class="term"><code class="literal">calendar, calendar_date</code></span></dt><dd>
              <p>Type mappings from <code class="literal">java.util.Calendar</code>
              to SQL types <code class="literal">TIMESTAMP</code> and
              <code class="literal">DATE</code> (or equivalent).</p>
            </dd><dt><span class="term"><code class="literal">big_decimal, big_integer</code></span></dt><dd>
              <p>Type mappings from <code class="literal">java.math.BigDecimal</code>
              and <code class="literal">java.math.BigInteger</code> to
              <code class="literal">NUMERIC</code> (or Oracle
              <code class="literal">NUMBER</code>).</p>
            </dd><dt><span class="term"><code class="literal">locale, timezone, currency</code></span></dt><dd>
              <p>Type mappings from <code class="literal">java.util.Locale</code>,
              <code class="literal">java.util.TimeZone</code> and
              <code class="literal">java.util.Currency</code> to
              <code class="literal">VARCHAR</code> (or Oracle
              <code class="literal">VARCHAR2</code>). Instances of
              <code class="literal">Locale</code> and <code class="literal">Currency</code> are
              mapped to their ISO codes. Instances of
              <code class="literal">TimeZone</code> are mapped to their
              <code class="literal">ID</code>.</p>
            </dd><dt><span class="term"><code class="literal">class</code></span></dt><dd>
              <p>A type mapping from <code class="literal">java.lang.Class</code> to
              <code class="literal">VARCHAR</code> (or Oracle
              <code class="literal">VARCHAR2</code>). A <code class="literal">Class</code> is
              mapped to its fully qualified name.</p>
            </dd><dt><span class="term"><code class="literal">binary</code></span></dt><dd>
              <p>Maps byte arrays to an appropriate SQL binary type.</p>
            </dd><dt><span class="term"><code class="literal">text</code></span></dt><dd>
              <p>Maps long Java strings to a SQL <code class="literal">LONGVARCHAR</code> or
              <code class="literal">TEXT</code> type.</p>
            </dd><dt><span class="term"><code class="literal">image</code></span></dt><dd>
              <p>Maps long byte arrays to a SQL <code class="literal">LONGVARBINARY</code>.</p>
            </dd><dt><span class="term"><code class="literal">serializable</code></span></dt><dd>
              <p>Maps serializable Java types to an appropriate SQL binary
              type. You can also indicate the Hibernate type
              <code class="literal">serializable</code> with the name of a serializable
              Java class or interface that does not default to a basic
              type.</p>
            </dd><dt><span class="term"><code class="literal">clob, blob</code></span></dt><dd>
              <p>Type mappings for the JDBC classes
              <code class="literal">java.sql.Clob</code> and
              <code class="literal">java.sql.Blob</code>. These types can be
              inconvenient for some applications, since the blob or clob
              object cannot be reused outside of a transaction. Driver support
              is patchy and inconsistent.</p>
            </dd><dt><span class="term"><code class="literal">materialized_clob</code></span></dt><dd>
              <p>Maps long Java strings to a SQL <code class="literal">CLOB</code> 
              type. When read, the <code class="literal">CLOB</code> value is
              immediately materialized into a Java string. Some drivers 
              require the <code class="literal">CLOB</code> value to be read within
              a transaction. Once materialized, the Java string is 
              available outside of the transaction.</p>
            </dd><dt><span class="term"><code class="literal">materialized_blob</code></span></dt><dd>
              <p>Maps long Java byte arrays to a SQL <code class="literal">BLOB</code> 
              type. When read, the <code class="literal">BLOB</code> value is
              immediately materialized into a byte array. Some drivers 
              require the <code class="literal">BLOB</code> value to be read within
              a transaction. Once materialized, the byte array is 
              available outside of the transaction.</p>
            </dd><dt><span class="term"><code class="literal">imm_date, imm_time, imm_timestamp, imm_calendar,
            imm_calendar_date, imm_serializable, imm_binary</code></span></dt><dd>
              <p>Type mappings for what are considered mutable Java types.
              This is where Hibernate makes certain optimizations appropriate
              only for immutable Java types, and the application treats the
              object as immutable. For example, you should not call
              <code class="literal">Date.setTime()</code> for an instance mapped as
              <code class="literal">imm_timestamp</code>. To change the value of the
              property, and have that change made persistent, the application
              must assign a new, nonidentical, object to the property.</p>
            </dd></dl></div>

      <p>Unique identifiers of entities and collections can be of any basic
      type except <code class="literal">binary</code>, <code class="literal">blob</code> and
      <code class="literal">clob</code>. Composite identifiers are also allowed. See
      below for more information.</p>

      <p>The basic value types have corresponding <code class="literal">Type</code>
      constants defined on <code class="literal">org.hibernate.Hibernate</code>. For
      example, <code class="literal">Hibernate.STRING</code> represents the
      <code class="literal">string</code> type.</p>
    </div>

    <div class="section" title="5.2.3. Custom value types"><div class="titlepage"><div><div><h3 class="title"><a id="mapping-types-custom"/>5.2.3. Custom value types</h3></div></div></div>
      

      <p>It is relatively easy for developers to create their own value
      types. For example, you might want to persist properties of type
      <code class="literal">java.lang.BigInteger</code> to <code class="literal">VARCHAR</code>
      columns. Hibernate does not provide a built-in type for this. Custom
      types are not limited to mapping a property, or collection element, to a
      single table column. So, for example, you might have a Java property
      <code class="literal">getName()</code>/<code class="literal">setName()</code> of type
      <code class="literal">java.lang.String</code> that is persisted to the columns
      <code class="literal">FIRST_NAME</code>, <code class="literal">INITIAL</code>,
      <code class="literal">SURNAME</code>.</p>

      <p>To implement a custom type, implement either
      <code class="literal">org.hibernate.UserType</code> or
      <code class="literal">org.hibernate.CompositeUserType</code> and declare
      properties using the fully qualified classname of the type. View
      <code class="literal">org.hibernate.test.DoubleStringType</code> to see the kind
      of things that are possible.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;property name="twoStrings" type="org.hibernate.test.DoubleStringType"&gt;
    &lt;column name="first_string"/&gt;
    &lt;column name="second_string"/&gt;
&lt;/property&gt;</pre>

      <p>Notice the use of <code class="literal">&lt;column&gt;</code> tags to map a
      property to multiple columns.</p>

      <p>The <code class="literal">CompositeUserType</code>,
      <code class="literal">EnhancedUserType</code>,
      <code class="literal">UserCollectionType</code>, and
      <code class="literal">UserVersionType</code> interfaces provide support for more
      specialized uses.</p>

      <p>You can even supply parameters to a <code class="literal">UserType</code> in
      the mapping file. To do this, your <code class="literal">UserType</code> must
      implement the
      <code class="literal">org.hibernate.usertype.ParameterizedType</code> interface.
      To supply parameters to your custom type, you can use the
      <code class="literal">&lt;type&gt;</code> element in your mapping files.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;property name="priority"&gt;
    &lt;type name="com.mycompany.usertypes.DefaultValueIntegerType"&gt;
        &lt;param name="default"&gt;0&lt;/param&gt;
    &lt;/type&gt;
&lt;/property&gt;</pre>

      <p>The <code class="literal">UserType</code> can now retrieve the value for the
      parameter named <code class="literal">default</code> from the
      <code class="literal">Properties</code> object passed to it.</p>

      <p>If you regularly use a certain <code class="literal">UserType</code>, it is
      useful to define a shorter name for it. You can do this using the
      <code class="literal">&lt;typedef&gt;</code> element. Typedefs assign a name to a
      custom type, and can also contain a list of default parameter values if
      the type is parameterized.</p>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;typedef class="com.mycompany.usertypes.DefaultValueIntegerType" name="default_zero"&gt;
    &lt;param name="default"&gt;0&lt;/param&gt;
&lt;/typedef&gt;</pre>

      <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;property name="priority" type="default_zero"/&gt;</pre>

      <p>It is also possible to override the parameters supplied in a
      typedef on a case-by-case basis by using type parameters on the property
      mapping.</p>

      <p>Even though Hibernate's rich range of built-in types and support
      for components means you will rarely need to use a custom type, it is
      considered good practice to use custom types for non-entity classes that
      occur frequently in your application. For example, a
      <code class="literal">MonetaryAmount</code> class is a good candidate for a
      <code class="literal">CompositeUserType</code>, even though it could be mapped as
      a component. One reason for this is abstraction. With a custom type,
      your mapping documents would be protected against changes to the way
      monetary values are represented.</p>
    </div>
  </div>

  <div class="section" title="5.3. Mapping a class more than once"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-entityname"/>5.3. Mapping a class more than once</h2></div></div></div>
    

    <p>It is possible to provide more than one mapping for a particular
    persistent class. In this case, you must specify an <span class="emphasis"><em>entity
    name</em></span> to disambiguate between instances of the two mapped
    entities. By default, the entity name is the same as the class name.
    Hibernate lets you specify the entity name when working with persistent
    objects, when writing queries, or when mapping associations to the named
    entity.</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;class name="Contract" table="Contracts"
        entity-name="CurrentContract"&gt;
    ...
    &lt;set name="history" inverse="true"
            order-by="effectiveEndDate desc"&gt;
        &lt;key column="currentContractId"/&gt;
        &lt;one-to-many entity-name="HistoricalContract"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="Contract" table="ContractHistory"
        entity-name="HistoricalContract"&gt;
    ...
    &lt;many-to-one name="currentContract"
            column="currentContractId"
            entity-name="CurrentContract"/&gt;
&lt;/class&gt;</pre>

    <p>Associations are now specified using <code class="literal">entity-name</code>
    instead of <code class="literal">class</code>.</p>

    <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
      <p>This feature is not supported in Annotations</p>
    </div>
  </div>

  <div class="section" title="5.4. SQL quoted identifiers"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-quotedidentifiers"/>5.4. SQL quoted identifiers</h2></div></div></div>
    

    <p>You can force Hibernate to quote an identifier in the generated SQL
    by enclosing the table or column name in backticks in the mapping
    document. Hibernate will use the correct quotation style for the SQL
    <code class="literal">Dialect</code>. This is usually double quotes, but the SQL
    Server uses brackets and MySQL uses backticks.</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity @Table(name="`Line Item`")
class LineItem {
   @id @Column(name="`Item Id`") Integer id;
   @Column(name="`Item #`") int itemNumber
}

&lt;class name="LineItem" table="`Line Item`"&gt;
    &lt;id name="id" column="`Item Id`"/&gt;&lt;generator class="assigned"/&gt;&lt;/id&gt;
    &lt;property name="itemNumber" column="`Item #`"/&gt;
    ...
&lt;/class&gt;</pre>
  </div>

  <div class="section" title="5.5. Generated properties"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-generated"/>5.5. Generated properties</h2></div></div></div>
    

    <p>Generated properties are properties that have their values generated
    by the database. Typically, Hibernate applications needed to
    <code class="literal">refresh</code> objects that contain any properties for which
    the database was generating values. Marking properties as generated,
    however, lets the application delegate this responsibility to Hibernate.
    When Hibernate issues an SQL INSERT or UPDATE for an entity that has
    defined generated properties, it immediately issues a select afterwards to
    retrieve the generated values.</p>

    <p>Properties marked as generated must additionally be non-insertable
    and non-updateable. Only <a class="link" href="">versions</a>, <a class="link" href="ch05.html#mapping-declaration-timestamp" title="5.1.3.2. Timestamp">timestamps</a>, and <a class="link" href="ch05.html#mapping-declaration-property" title="5.1.4. Property">simple properties</a>, can be
    marked as generated.</p>

    <p><code class="literal">never</code> (the default): the given property value is
    not generated within the database.</p>

    <p><code class="literal">insert</code>: the given property value is generated on
    insert, but is not regenerated on subsequent updates. Properties like
    created-date fall into this category. Even though <a class="link" href="">version</a> and <a class="link" href="ch05.html#mapping-declaration-timestamp" title="5.1.3.2. Timestamp">timestamp</a> properties can be
    marked as generated, this option is not available.</p>

    <p><code class="literal">always</code>: the property value is generated both on
    insert and on update.</p>

    <p>To mark a property as generated, use
    <code class="classname">@Generated</code>.</p>
  </div>

  <div class="section" title="5.6. Column transformers: read and write expressions"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-column-read-and-write"/>5.6. Column transformers: read and write expressions</h2></div></div></div>
    

    <p>Hibernate allows you to customize the SQL it uses to read and write
    the values of columns mapped to <a class="link" href="ch05.html#mapping-declaration-property" title="5.1.4. Property">simple properties</a>. For
    example, if your database provides a set of data encryption functions, you
    can invoke them for individual columns like this:</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
class CreditCard {
   @Column(name="credit_card_num")
   @ColumnTransformer(
      read="decrypt(credit_card_num)", 
      write="encrypt(?)")
   public String getCreditCardNumber() { return creditCardNumber; }
   public void setCreditCardNumber(String number) { this.creditCardNumber = number; }
   private String creditCardNumber;
}</pre>

    <p>or in XML</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;property name="creditCardNumber"&gt;
        &lt;column 
          name="credit_card_num"
          read="decrypt(credit_card_num)"
          write="encrypt(?)"/&gt;
&lt;/property&gt;</pre>

    <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
      <p>You can use the plural form
      <code class="classname">@ColumnTransformers</code> if more than one columns need
      to define either of these rules.</p>
    </div>

    <p>If a property uses more that one column, you must use the
    <code class="literal">forColumn</code> attribute to specify which column, the
    expressions are targeting.</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">@Entity
class User {
   @Type(type="com.acme.type.CreditCardType")
   @Columns( {
      @Column(name="credit_card_num"),
      @Column(name="exp_date") } )
   @ColumnTransformer(
      forColumn="credit_card_num", 
      read="decrypt(credit_card_num)", 
      write="encrypt(?)")
   public CreditCard getCreditCard() { return creditCard; }
   public void setCreditCard(CreditCard card) { this.creditCard = card; }
   private CreditCard creditCard;
}</pre>

    <p>Hibernate applies the custom expressions automatically whenever the
    property is referenced in a query. This functionality is similar to a
    derived-property <code class="literal">formula</code> with two differences:
    </p><div class="itemizedlist"><ul class="itemizedlist" compact="compact"><li class="listitem">
          <p>The property is backed by one or more columns that are
          exported as part of automatic schema generation.</p>
        </li><li class="listitem">
          <p>The property is read-write, not read-only.</p>
        </li></ul></div>

    <p>The <code class="literal">write</code> expression, if specified, must contain
    exactly one '?' placeholder for the value.</p>
  </div>

  <div class="section" title="5.7. Auxiliary database objects"><div class="titlepage"><div><div><h2 class="title"><a id="mapping-database-object"/>5.7. Auxiliary database objects</h2></div></div></div>
    

    <p>Auxiliary database objects allow for the CREATE and DROP of
    arbitrary database objects. In conjunction with Hibernate's schema
    evolution tools, they have the ability to fully define a user schema
    within the Hibernate mapping files. Although designed specifically for
    creating and dropping things like triggers or stored procedures, any SQL
    command that can be run via a
    <code class="literal">java.sql.Statement.execute()</code> method is valid (for
    example, ALTERs, INSERTS, etc.). There are essentially two modes for
    defining auxiliary database objects:</p>

    <p>The first mode is to explicitly list the CREATE and DROP commands in
    the mapping file:</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;hibernate-mapping&gt;
    ...
    &lt;database-object&gt;
        &lt;create&gt;CREATE TRIGGER my_trigger ...&lt;/create&gt;
        &lt;drop&gt;DROP TRIGGER my_trigger&lt;/drop&gt;
    &lt;/database-object&gt;
&lt;/hibernate-mapping&gt;</pre>

    <p>The second mode is to supply a custom class that constructs the
    CREATE and DROP commands. This custom class must implement the
    <code class="literal">org.hibernate.mapping.AuxiliaryDatabaseObject</code>
    interface.</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;hibernate-mapping&gt;
    ...
    &lt;database-object&gt;
        &lt;definition class="MyTriggerDefinition"/&gt;
    &lt;/database-object&gt;
&lt;/hibernate-mapping&gt;</pre>

    <p>Additionally, these database objects can be optionally scoped so
    that they only apply when certain dialects are used.</p>

    <pre xmlns="" xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="">&lt;hibernate-mapping&gt;
    ...
    &lt;database-object&gt;
        &lt;definition class="MyTriggerDefinition"/&gt;
        &lt;dialect-scope name="org.hibernate.dialect.Oracle9iDialect"/&gt;
        &lt;dialect-scope name="org.hibernate.dialect.Oracle10gDialect"/&gt;
    &lt;/database-object&gt;
&lt;/hibernate-mapping&gt;</pre>

    <div xmlns:d="http://docbook.org/ns/docbook" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h2>Note</h2>
      <p>This feature is not supported in Annotations</p>
    </div>
  </div>
</div><hr xmlns="" xmlns:d="http://docbook.org/ns/docbook"/><a xmlns="" xmlns:d="http://docbook.org/ns/docbook" href="legalnotice.html"/><ul xmlns:d="http://docbook.org/ns/docbook" class="docnav"><li class="previous"><a accesskey="p" href="ch04.html"><strong>Prev</strong>Chapter 4. Persistent Classes</a></li><li class="up"><a accesskey="u" href="#"><strong>Up</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Home</strong></a></li><li class="next"><a accesskey="n" href="ch06.html"><strong>Next</strong>Chapter 6. Types</a></li></ul></body></html>