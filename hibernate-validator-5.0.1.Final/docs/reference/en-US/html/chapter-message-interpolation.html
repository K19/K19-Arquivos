<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 4. Interpolating constraint error messages</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Hibernate Validator"/><link rel="up" href="index.html" title="Hibernate Validator"/><link rel="prev" href="chapter-method-constraints.html" title="Chapter 3. Declaring and validating method constraints"/><link rel="next" href="chapter-groups.html" title="Chapter 5. Grouping constraints"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="chapter-method-constraints.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="chapter-groups.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-message-interpolation"/>Chapter 4. Interpolating constraint error messages</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="chapter-message-interpolation.html#section-message-interpolation">4.1. Default message interpolation</a></span></dt><dd><dl><dt><span class="section"><a href="chapter-message-interpolation.html#section-special-characters">4.1.1. Special characters</a></span></dt><dt><span class="section"><a href="chapter-message-interpolation.html#section-interpolation-with-message-expressions">4.1.2. Interpolation with message expressions</a></span></dt><dt><span class="section"><a href="chapter-message-interpolation.html#d0e2403">4.1.3. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="chapter-message-interpolation.html#section-custom-message-interpolation">4.2. Custom message interpolation</a></span></dt><dd><dl><dt><span class="section"><a href="chapter-message-interpolation.html#section-resource-bundle-locator">4.2.1. ResourceBundleLocator</a></span></dt></dl></dd></dl></div><p>Message interpolation is the process of creating error messages for
  violated Bean Validation constraints. In this chapter you will learn how
  such messages are defined and resolved and how you can plug in custom
  message interpolators in case the default algorithm is not sufficient for
  your requirements.</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="section-message-interpolation"/>4.1. Default message interpolation</h2></div></div></div><p>Constraint violation messages are retrieved from so called message
    descriptors. Each constraint defines its default message descriptor using
    the <code class="methodname">message</code> attribute. At declaration time, the
    default descriptor can be overridden with a specific value as shown in
    <a class="xref" href="chapter-message-interpolation.html#example-overriding-message" title="Example 4.1. Specifying a message descriptor using the message attribute">Example 4.1, “Specifying a message descriptor using the
      message attribute”</a>.</p><div class="example"><a id="example-overriding-message"/><p class="title"><b>Example 4.1. Specifying a message descriptor using the
      <code class="methodname">message</code> attribute</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter04</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;manufacturer&nbsp;name&nbsp;must&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">constructor</span><span class="java_separator">,</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>If a constraint is violated, its descriptor will be interpolated by
    the validation engine using the currently configured
    <code class="classname">MessageInterpolator</code>. The interpolated error message
    can then be retrieved from the resulting constraint violation by calling
    <code class="methodname">ConstraintViolation#getMessage()</code>.</p><p>Message descriptors can contain <span class="emphasis"><em>message
    parameters</em></span> as well as <span class="emphasis"><em>message expressions</em></span>
    which will be resolved during interpolation. Message parameters are string
    literals enclosed in <code class="literal">{}</code>, while message expressions are
    string literals enclosed in <code class="literal">${}</code>. The following
    algorithm is applied during method interpolation:</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li><p>Resolve any message parameters by using them as key for the
        resource bundle <code class="filename">ValidationMessages</code>. If this
        bundle contains an entry for a given message parameter, that parameter
        will be replaced in the message with the corresponding value from the
        bundle. This step will be executed recursively in case the replaced
        value again contains message parameters. The resource bundle is
        expected to be provided by the application developer, e.g. by adding a
        file named <code class="filename">ValidationMessages.properties</code> to the
        classpath. You can also create localized error messages by providing
        locale specific variations of this bundle, such as
        <code class="filename">ValidationMessages_en_US.properties</code>. By default,
        the JVM's default locale
        (<code class="methodname">Locale#getDefault()</code>) will be used when
        looking up messages in the bundle.</p></li><li><p>Resolve any message parameters by using them as key for a
        resource bundle containing the standard error messages for the
        built-in constraints as defined in Appendix B of the Bean Validation
        specification. In the case of Hibernate Validator, this bundle is
        named
        <code class="classname">org.hibernate.validator.ValidationMessages</code>. If
        this step triggers a replacement, step 1 is executed again, otherwise
        step 3 is applied.</p></li><li><p>Resolve any message parameters by replacing them with the value
        of the constraint annotation member of the same name. This allows to
        refer to attribute values of the constraint (e.g.
        <code class="methodname">Size#min()</code>) in the error message (e.g. "must
        be at least ${min}").</p></li><li><p>Resolve any message expressions by evaluating them as
        expressions of the Unified Expression Language. See <a class="xref" href="chapter-message-interpolation.html#section-interpolation-with-message-expressions" title="4.1.2. Interpolation with message expressions">Section 4.1.2, “Interpolation with message expressions”</a> to learn
        more about the usage of Unified EL in error messages.</p></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>Tip</h2><p>You can find the formal definition of the interpolation algorithm
      in section <a class="ulink" href="http://beanvalidation.org/1.1/spec/#default-resolution-algorithm">5.3.1.1</a>
      of the Bean Validation specification.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="section-special-characters"/>4.1.1. Special characters</h3></div></div></div><p>Since the characters <code class="literal">{</code>, <code class="literal">}</code>
      and <code class="literal">$</code> have a special meaning in message descriptors
      they need to be escaped if you want to use them literally. The following
      rules apply:</p><div class="itemizedlist"><ul><li><p><code class="literal"><code class="literal">\{</code></code> is considered as
            the literal <code class="literal">{</code></p></li><li><p><code class="literal">\}</code> is considered as the literal
            <code class="literal">}</code></p></li><li><p><code class="literal">\$</code> is considered as the literal
            <code class="literal">$</code></p></li><li><p><code class="literal">\\</code> is considered as the literal
            <code class="literal">\</code></p></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="section-interpolation-with-message-expressions"/>4.1.2. Interpolation with message expressions</h3></div></div></div><p>As of Hibernate Validator 5 (Bean Validation 1.1) it is possible
      to use the Unified Expression Language (as defined by <a class="ulink" href="http://jcp.org/en/jsr/detail?id=341">JSR 341</a>) in constraint
      violation messages. This allows to define error messages based on
      conditional logic and also enables advanced formatting options. The
      validation engine makes the following objects available in the EL
      context:</p><div class="itemizedlist"><ul><li><p>the attribute values of the constraint mapped to the attribute
          names</p></li><li><p>the currently validated value (property, bean, method
          parameter etc.) under the name
          <code class="varname">validatedValue</code></p></li><li><p>a bean mapped to the name <code class="varname">formatter</code>
          exposing the var-arg method <code class="methodname">format(String format,
          Object... args)</code> which behaves like
          <code class="methodname">java.util.Formatter.format(String format, Object...
          args)</code>.</p></li></ul></div><p>The following section provides several examples for using EL
      expressions in error messages.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e2403"/>4.1.3. Examples</h3></div></div></div><p><a class="xref" href="chapter-message-interpolation.html#example-message-descriptors" title="Example 4.2. Specifying message descriptors">Example 4.2, “Specifying message descriptors”</a> shows how to make
      use of the different options for specifying message descriptors.</p><div class="example"><a id="example-message-descriptors"/><p class="title"><b>Example 4.2. Specifying message descriptors</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter04</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">complete</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;license&nbsp;plate&nbsp;must&nbsp;be&nbsp;between&nbsp;{min}&nbsp;and&nbsp;{max}&nbsp;characters&nbsp;long&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;{value}&nbsp;seat${value&nbsp;&gt;&nbsp;1&nbsp;?&nbsp;'s'&nbsp;:&nbsp;''}&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">DecimalMax</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;350&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;top&nbsp;speed&nbsp;${formatter.format('%1$.2f',&nbsp;validatedValue)}&nbsp;is&nbsp;higher&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;than&nbsp;{value}&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">double</span><span class="java_plain">&nbsp;topSpeed</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">DecimalMax</span><span class="java_separator">(</span><span class="java_plain">value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;100000&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Price&nbsp;must&nbsp;not&nbsp;be&nbsp;higher&nbsp;than&nbsp;${value}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">BigDecimal</span><span class="java_plain">&nbsp;price</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">double</span><span class="java_plain">&nbsp;topSpeed</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">BigDecimal</span><span class="java_plain">&nbsp;price</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">topSpeed&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;topSpeed</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">price&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;price</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Validating an invalid <code class="classname">Car</code> instance yields
      constraint violations with the messages shown by the assertions in <a class="xref" href="chapter-message-interpolation.html#example-expected-error-messages" title="Example 4.3. Expected error messages">Example 4.3, “Expected error messages”</a>:</p><div class="itemizedlist"><ul><li><p>the <code class="classname">@NotNull</code> constraint on the
          <code class="varname">manufacturer</code> field causes the error message "may
          not be null", as this is the default message defined by the Bean
          Validation specification and no specific descriptor is given in the
          <code class="methodname">message</code> attribute</p></li><li><p>the <code class="classname">@Size</code> constraint on the
          <code class="varname">licensePlate</code> field shows the interpolation of
          message parameters (<code class="literal">{min}</code>,
          <code class="literal">{max}</code>)</p></li><li><p>the <code class="classname">@Min</code> constraint on
          <code class="varname">seatCount</code> demonstrates how use an EL expression
          with a ternery expression to dynamically chose singular or plural
          form, depending on an attribute of the constraint ("There must be at
          least 1 seat" vs. "There must be at least 2 seats")</p></li><li><p>the message for the <code class="classname">@DecimalMax</code>
          constraint on <code class="varname">topSpeed</code> shows how to refer to the
          validated object in the error message and format it using the
          <code class="varname">formatter</code> object</p></li><li><p>finally, the <code class="classname">@DecimalMax</code> constraint on
          <code class="varname">price</code> shows that parameter interpolation has
          precedence over expression evaluation, causing the
          <code class="literal">$</code> sign to show up in front of the maximum
          price</p></li></ul></div><div class="example"><a id="example-expected-error-messages"/><p class="title"><b>Example 4.3. Expected error messages</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;car&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">null</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;A&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">1</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">400.123456</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">BigDecimal</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">valueOf</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">200000</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">String</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;The&nbsp;license&nbsp;plate&nbsp;must&nbsp;be&nbsp;between&nbsp;2&nbsp;and&nbsp;14&nbsp;characters&nbsp;long&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;seatCount&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;seats&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;topSpeed&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;top&nbsp;speed&nbsp;400.12&nbsp;is&nbsp;higher&nbsp;than&nbsp;350&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;price&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Price&nbsp;must&nbsp;not&nbsp;be&nbsp;higher&nbsp;than&nbsp;$100000&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="section-custom-message-interpolation"/>4.2. Custom message interpolation</h2></div></div></div><p>If the default message interpolation algorithm does not fit your
    requirements it is also possible to plug in a custom
    <code class="classname">MessageInterpolator</code> implementation.</p><p>Custom interpolators must implement the interface
    <code class="classname">javax.validation.MessageInterpolator</code>. Note that
    implementations must be thread-safe. It is recommended that custom message
    interpolators delegate final implementation to the default interpolator,
    which can be obtained via
    <code class="methodname">Configuration#getDefaultMessageInterpolator()</code>.</p><p>In order to use a custom message interpolator it must be registered
    either by configuring it in the Bean Validation XML descriptor
    <code class="filename">META-INF/validation.xml</code> (see <a class="xref" href="chapter-xml-configuration.html#section-configuration-validation-xml" title="7.1. Configuring the validator factory in validation.xml">Section 7.1, “Configuring the validator factory in
    validation.xml”</a>) or by passing it when
    bootstrapping a <code class="classname">ValidatorFactory</code> or
    <code class="classname">Validator</code> (see <a class="xref" href="chapter-bootstrapping.html#section-validator-factory-message-interpolator" title="8.2.1. MessageInterpolator">Section 8.2.1, “MessageInterpolator”</a> and <a class="xref" href="chapter-bootstrapping.html#section-configuring-validator" title="8.3. Configuring a Validator">Section 8.3, “Configuring a Validator”</a>, respectively).</p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="section-resource-bundle-locator"/>4.2.1. <code class="classname">ResourceBundleLocator</code></h3></div></div></div><p>In some use cases you want to use the message interpolation
      algorithm as defined by the Bean Validation specification, but retrieve
      error messages from other resource bundles than
      <code class="filename">ValidationMessages</code>. In this situation Hibernate
      Validator's <code class="classname">ResourceBundleLocator</code> SPI can
      help.</p><p>The default message interpolator in Hibernate Validator,
      <code class="classname">ResourceBundleMessageInterpolator</code>, delegates
      retrieval of resource bundles to that SPI. Using an alternative bundle
      only requires passing an instance of
      <code class="classname">PlatformResourceBundleLocator</code> with the bundle
      name when bootstrapping the <code class="classname">ValidatorFactory</code> as
      shown in <a class="xref" href="chapter-message-interpolation.html#example-using-specific-resource-bundle-locator" title="Example 4.4. Using a specific resource bundle">Example 4.4, “Using a specific resource bundle”</a>.</p><div class="example"><a id="example-using-specific-resource-bundle-locator"/><p class="title"><b>Example 4.4. Using a specific resource bundle</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceBundleMessageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">PlatformResourceBundleLocator</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;MyMessages&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Of course you also could implement a completely different
      <code class="classname">ResourceBundleLocator</code>, which for instance returns
      bundles backed by records in a database. In this case you can obtain the
      default locator via
      <code class="classname">HibernateValidatorConfiguration#getDefaultResourceBundleLocator()</code>,
      which you e.g. could use as fallback for your custom locator.</p><p>Besides <code class="classname">PlatformResourceBundleLocator</code>,
      Hibernate Validator provides another resource bundle locator
      implementation out of the box, namely
      <code class="classname">AggregateResourceBundleLocator</code>, which allows to
      retrieve error messages from more than one resource bundle. You could
      for instance use this implementation in a multi-module application where
      you want to have one message bundle per module. <a class="xref" href="chapter-message-interpolation.html#example-using-aggregate-resource-bundle-locator" title="Example 4.5. Using AggregateResourceBundleLocator">Example 4.5, “Using
        AggregateResourceBundleLocator”</a> shows how to
      use <code class="classname">AggregateResourceBundleLocator</code>.</p><div class="example"><a id="example-using-aggregate-resource-bundle-locator"/><p class="title"><b>Example 4.5. Using
        <code class="classname">AggregateResourceBundleLocator</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceBundleMessageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">AggregateResourceBundleLocator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Arrays</span><span class="java_separator">.</span><span class="java_plain">asList</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;MyMessages&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;MyOtherMessages&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Note that the bundles are processed in the order as passed to the
      constructor. That means if several bundles contain an entry for a given
      message key, the value will be taken from the first bundle in the list
      containing the key.</p></div></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2009 - 2013 Red Hat, Inc. &amp; Gunnar Morling</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="chapter-method-constraints.html"><strong>Prev</strong>Chapter 3. Declaring and validating method constr...</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="chapter-groups.html"><strong>Next</strong>Chapter 5. Grouping constraints</a></li></ul></body></html>