<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Hibernate Validator</title><link rel="stylesheet" href="css/hibernate-single.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/></head><body><div class="book" lang="zh-CN"><div class="titlepage"><div><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><div><h1 class="title"><a id="d0e2"/>Hibernate Validator</h1></div><div><h2 class="subtitle">JSR 349 Reference Implementation</h2></div><div><h2 class="subtitle">使用指南</h2></div><div><div xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="authorgroup"><div class="authors">由 <span xmlns="http://www.w3.org/1999/xhtml" class="firstname">Hardy</span> <span xmlns="http://www.w3.org/1999/xhtml" class="surname">Ferentschik</span>和<span xmlns="http://www.w3.org/1999/xhtml" class="firstname">Gunnar</span> <span xmlns="http://www.w3.org/1999/xhtml" class="surname">Morling</span></div><div class="editors"/><div class="others">and thanks to <span xmlns="http://www.w3.org/1999/xhtml" class="firstname">Shaozhuang</span> <span xmlns="http://www.w3.org/1999/xhtml" class="surname">Liu</span></div></div></div><div><p class="releaseinfo">5.0.1.Final</p></div><div><p class="copyright">版权 © 2009 - 2013 Red Hat, Inc. &amp; Gunnar Morling</p></div><div><p class="pubdate">2013-04-30</p></div></div><hr/></div><div class="toc"><dl><dt><span class="preface"><a href="#preface">序言</a></span></dt><dt><span class="chapter"><a href="#validator-gettingstarted">1. Getting started</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-gettingstarted-createproject">1.1. Project set up</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-gettingstarted-uel">1.1.1. Unified EL</a></span></dt><dt><span class="section"><a href="#section-getting-started-cdi">1.1.2. CDI</a></span></dt></dl></dd><dt><span class="section"><a href="#validator-gettingstarted-createmodel">1.2. Applying constraints</a></span></dt><dt><span class="section"><a href="#d0e191">1.3. Validating constraints</a></span></dt><dt><span class="section"><a href="#validator-gettingstarted-whatsnext">1.4. Where to go next?</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chapter-bean-constraints">2. Declaring and validating bean constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-declaring-bean-constraints">2.1. Declaring bean constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e328">2.1.1. Field-level constraints</a></span></dt><dt><span class="section"><a href="#d0e347">2.1.2. Property-level constraints</a></span></dt><dt><span class="section"><a href="#d0e378">2.1.3. Class-level constraints</a></span></dt><dt><span class="section"><a href="#section-constraint-inheritance">2.1.4. Constraint inheritance</a></span></dt><dt><span class="section"><a href="#section-object-graph-validation">2.1.5. Object graphs</a></span></dt></dl></dd><dt><span class="section"><a href="#section-validating-bean-constraints">2.2. Validating bean constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-obtaining-validator">2.2.1. Obtaining a Validator instance</a></span></dt><dt><span class="section"><a href="#d0e622">2.2.2. Validator methods</a></span></dt><dt><span class="section"><a href="#section-constraint-violation-methods">2.2.3. ConstraintViolation methods</a></span></dt></dl></dd><dt><span class="section"><a href="#section-builtin-constraints">2.3. Built-in constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-defineconstraints-spec">2.3.1. Bean Validation constraints</a></span></dt><dt><span class="section"><a href="#validator-defineconstraints-hv-constraints">2.3.2. Additional constraints</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chapter-method-constraints">3. Declaring and validating method constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-declaring-method-constraints">3.1. Declaring method constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e1621">3.1.1. Parameter constraints</a></span></dt><dt><span class="section"><a href="#d0e1731">3.1.2. Return value constraints</a></span></dt><dt><span class="section"><a href="#d0e1767">3.1.3. Cascaded validation</a></span></dt><dt><span class="section"><a href="#d0e1867">3.1.4. Method constraints in inheritance hierarchies</a></span></dt></dl></dd><dt><span class="section"><a href="#section-validating-executable-constraints">3.2. Validating method constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-obtaining-executable-validator">3.2.1. Obtaining an ExecutableValidator instance</a></span></dt><dt><span class="section"><a href="#section-executable-validator-methods">3.2.2. ExecutableValidator methods</a></span></dt><dt><span class="section"><a href="#d0e2198">3.2.3. ConstraintViolation methods for method validation</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chapter-message-interpolation">4. Interpolating constraint error messages</a></span></dt><dd><dl><dt><span class="section"><a href="#section-message-interpolation">4.1. Default message interpolation</a></span></dt><dd><dl><dt><span class="section"><a href="#section-special-characters">4.1.1. Special characters</a></span></dt><dt><span class="section"><a href="#section-interpolation-with-message-expressions">4.1.2. Interpolation with message expressions</a></span></dt><dt><span class="section"><a href="#d0e2410">4.1.3. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#section-custom-message-interpolation">4.2. Custom message interpolation</a></span></dt><dd><dl><dt><span class="section"><a href="#section-resource-bundle-locator">4.2.1. ResourceBundleLocator</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chapter-groups">5. Grouping constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2602">5.1. Requesting groups</a></span></dt><dt><span class="section"><a href="#section-defining-group-sequences">5.2. Defining group sequences</a></span></dt><dt><span class="section"><a href="#section-default-group-class">5.3. Redefining the default group sequence</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2811">5.3.1. @GroupSequence</a></span></dt><dt><span class="section"><a href="#d0e2893">5.3.2. @GroupSequenceProvider</a></span></dt></dl></dd><dt><span class="section"><a href="#section-group-conversion">5.4. Group conversion</a></span></dt></dl></dd><dt><span class="chapter"><a href="#validator-customconstraints">6. Creating custom constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-customconstraints-simple">6.1. Creating a simple constraint</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-customconstraints-constraintannotation">6.1.1. The constraint annotation</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-validator">6.1.2. The constraint validator</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-errormessage">6.1.3. The error message</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-using">6.1.4. Using the constraint</a></span></dt></dl></dd><dt><span class="section"><a href="#section-class-level-constraints">6.2. Class-level constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-custom-property-paths">6.2.1. Custom property paths</a></span></dt></dl></dd><dt><span class="section"><a href="#section-cross-parameter-constraints">6.3. Cross-parameter constraints</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-compound">6.4. Constraint composition</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chapter-xml-configuration">7. Configuring via XML</a></span></dt><dd><dl><dt><span class="section"><a href="#section-configuration-validation-xml">7.1. Configuring the validator factory in validation.xml</a></span></dt><dt><span class="section"><a href="#section-mapping-xml-constraints">7.2. Mapping constraints via constraint-mappings</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chapter-bootstrapping">8. Bootstrapping</a></span></dt><dd><dl><dt><span class="section"><a href="#section-retrieving-validator-factory-validator">8.1. Retrieving ValidatorFactory and Validator</a></span></dt><dd><dl><dt><span class="section"><a href="#section-validation-provider-resolver">8.1.1. ValidationProviderResolver</a></span></dt></dl></dd><dt><span class="section"><a href="#section-configuring-validator-factory">8.2. Configuring a ValidatorFactory</a></span></dt><dd><dl><dt><span class="section"><a href="#section-validator-factory-message-interpolator">8.2.1. MessageInterpolator</a></span></dt><dt><span class="section"><a href="#d0e4245">8.2.2. TraversableResolver</a></span></dt><dt><span class="section"><a href="#d0e4287">8.2.3. ConstraintValidatorFactory</a></span></dt><dt><span class="section"><a href="#section-parameter-name-provider">8.2.4. ParameterNameProvider</a></span></dt><dt><span class="section"><a href="#d0e4371">8.2.5. Adding mapping streams</a></span></dt><dt><span class="section"><a href="#section-provider-specific-settings">8.2.6. Provider-specific settings</a></span></dt></dl></dd><dt><span class="section"><a href="#section-configuring-validator">8.3. Configuring a Validator</a></span></dt></dl></dd><dt><span class="chapter"><a href="#validator-metadata-api">9. Using constraint metadata</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e4477">9.1. BeanDescriptor</a></span></dt><dt><span class="section"><a href="#section-property-descriptor">9.2. PropertyDescriptor</a></span></dt><dt><span class="section"><a href="#d0e4630">9.3. MethodDescriptor and ConstructorDescriptor</a></span></dt><dt><span class="section"><a href="#validator-metadata-api-elementdescriptor">9.4. ElementDescriptor</a></span></dt><dt><span class="section"><a href="#section-group-conversion-descriptor">9.5. GroupConversionDescriptor</a></span></dt><dt><span class="section"><a href="#section-constraint-descriptor">9.6. ConstraintDescriptor</a></span></dt></dl></dd><dt><span class="chapter"><a href="#validator-integration">10. Integrating with other frameworks</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-checkconstraints-orm">10.1. ORM集成</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-checkconstraints-db">10.1.1. 与数据库集成校验</a></span></dt><dt><span class="section"><a href="#validator-checkconstraints-orm-hibernateevent">10.1.2. 基于Hibernate事件模型的校验</a></span></dt><dt><span class="section"><a href="#d0e5013">10.1.3. JPA</a></span></dt></dl></dd><dt><span class="section"><a href="#section-presentation-layer">10.2. JSF &amp; Seam</a></span></dt><dt><span class="section"><a href="#section-integration-with-cdi">10.3. CDI</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e5124">10.3.1. Dependency injection</a></span></dt><dt><span class="section"><a href="#d0e5202">10.3.2. Method validation</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e5359">10.4. Java EE</a></span></dt></dl></dd><dt><span class="chapter"><a href="#validator-specifics">11. Hibernate Validator Specifics</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e5412">11.1. Public API</a></span></dt><dt><span class="section"><a href="#section-fail-fast">11.2. Fail fast mode</a></span></dt><dt><span class="section"><a href="#section-programmatic-api">11.3. Programmatic constraint declaration</a></span></dt><dt><span class="section"><a href="#section-boolean-constraint-composition">11.4. Boolean composition of constraints</a></span></dt><dt><span class="section"><a href="#d0e5697">11.5. ResourceBundleLocator</a></span></dt></dl></dd><dt><span class="chapter"><a href="#validator-annotation-processor">12. Annotation Processor</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-annotationprocessor-prerequisites">12.1. Prerequisites</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-features">12.2. Features</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-options">12.3. Options</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-usage">12.4. Using the Annotation Processor</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-annotationprocessor-commandline">12.4.1. Command line builds</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-ide">12.4.2. IDE builds</a></span></dt></dl></dd><dt><span class="section"><a href="#validator-annotationprocessor-known-issues">12.5. Known issues</a></span></dt></dl></dd><dt><span class="chapter"><a href="#validator-further-reading">13. Further reading</a></span></dt></dl></div><div class="preface" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="preface"/>序言</h2></div></div></div><p>Validating data is a common task that occurs throughout all application layers, from the presentation to the persistence layer. Often the same validation logic is implemented in each layer which is time consuming and error-prone. To avoid duplication of these validations, developers often bundle validation logic directly into the domain model, cluttering domain classes with validation code which is really metadata about the class itself.</p><div class="mediaobject"><img src="application-layers.png"/></div><p>JSR 349 - Bean Validation 1.1 - defines a metadata model and API for entity and method validation. The default metadata source are annotations, with the ability to override and extend the meta-data through the use of XML. The API is not tied to a specific application tier nor programming model. It is specifically not tied to either web or persistence tier, and is available for both server-side application programming, as well as rich client Swing application developers.</p><div class="mediaobject"><img src="application-layers2.png"/></div><p>Hibernate Validator is the reference implementation of this JSR 349. The implementation itself as well as the Bean Validation API and TCK are all provided and distributed under the <a class="ulink" href="http://www.apache.org/licenses/LICENSE-2.0">Apache Software License 2.0</a>.</p></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-gettingstarted"/>第 1 章 Getting started</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#validator-gettingstarted-createproject">1.1. Project set up</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-gettingstarted-uel">1.1.1. Unified EL</a></span></dt><dt><span class="section"><a href="#section-getting-started-cdi">1.1.2. CDI</a></span></dt></dl></dd><dt><span class="section"><a href="#validator-gettingstarted-createmodel">1.2. Applying constraints</a></span></dt><dt><span class="section"><a href="#d0e191">1.3. Validating constraints</a></span></dt><dt><span class="section"><a href="#validator-gettingstarted-whatsnext">1.4. Where to go next?</a></span></dt></dl></div><p>This chapter will show you how to get started with Hibernate Validator, the reference implementation (RI) of Bean Validation. For the following quickstart you need:</p><div class="itemizedlist"><ul><li><p>A JDK &gt;= 6</p></li><li><p><a class="ulink" href="http://maven.apache.org/">Apache Maven</a></p></li><li><p>An Internet connection (Maven has to download all required libraries)</p></li></ul></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-gettingstarted-createproject"/>1.1. Project set up</h2></div></div></div><p>In order to use Hibernate Validator within a Maven project, simply add the following dependency to your <code class="filename">pom.xml</code>:</p><div class="example"><a id="d0e89"/><p class="title"><b>例 1.1. Hibernate Validator Maven dependency</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">hibernate-validator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">5.0.1.Final</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><p>This transitively pulls in the dependency to the Bean Validation API (<code class="literal">javax.validation:validation-api:1.1.0.Final</code>).</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-gettingstarted-uel"/>1.1.1. Unified EL</h3></div></div></div><p>Hibernate Validator requires an implementation of the Unified Expression Language (<a class="ulink" href="jcp.org/en/jsr/detail?id=341">JSR 341</a>) for evaluating dynamic expressions in constraint violation messages (see <a class="xref" href="#section-message-interpolation" title="4.1. Default message interpolation">第 4.1 节 “Default message interpolation”</a>). When your application runs in a Java EE container such as JBoss AS, an EL implementation is already provided by the container. In a Java SE environment, however, you have to add an implementation as dependency to your POM file. For instance you can add the following two dependencies to use the JSR 341 <a class="ulink" href="http://uel.java.net/">reference implementation</a>:</p><div class="example"><a id="d0e112"/><p class="title"><b>例 1.2. Maven dependencies for Unified EL reference implementation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">javax.el</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">javax.el-api</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">2.2.4</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.glassfish.web</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">javax.el</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">2.2.4</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-getting-started-cdi"/>1.1.2. CDI</h3></div></div></div><p>Bean Validation defines integration points with CDI (Contexts and Dependency Injection for Java<sup>TM</sup> EE, <a class="ulink" href="http://jcp.org/en/jsr/detail?id=346">JSR 346</a>). If your application runs in an environment which does not provide this integration out of the box, you may use the Hibernate Validator CDI portable extension by adding the following Maven dependency to your POM:</p><div class="example"><a id="d0e128"/><p class="title"><b>例 1.3. Hibernate Validator CDI portable extension Maven dependency</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">hibernate-validator-cdi</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">5.0.1.Final</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><p>Note that adding this dependency is usually not required for applications running on a Java EE application server. You can learn more about the integration of Bean Validation and CDI in <a class="xref" href="#section-integration-with-cdi" title="10.3. CDI">第 10.3 节 “CDI”</a>.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-gettingstarted-createmodel"/>1.2. Applying constraints</h2></div></div></div><p>Lets dive directly into an example to see how to apply constraints.</p><div class="example"><a id="example-class-car"/><p class="title"><b>例 1.4. Class <code class="classname">Car</code> annotated with constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter01</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">Min</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">Size</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The <code class="classname">@NotNull</code>, <code class="classname">@Size</code> and <code class="classname">@Min</code> annotations are used to declare the constraints which should be applied to the fields of a <code class="classname">Car</code> instance:</p><div class="itemizedlist"><ul><li><p><span class="property">manufacturer</span> must never be <code class="literal">null</code></p></li><li><p><span class="property">licensePlate</span> must never be <code class="literal">null</code> and must be between 2 and 14 characters long</p></li><li><p><span class="property">seatCount</span> must be at least 2</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>You can find the complete source code of all examples used in this reference guide in the Hibernate Validator <a class="ulink" href="https://github.com/hibernate/hibernate-validator/tree/master/documentation/src/test">source repository</a> on GitHub.</p></div></li></ul></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e191"/>1.3. Validating constraints</h2></div></div></div><p>To perform a validation of these constraints, you use a <code class="classname">Validator</code> instance. Let's have a look at a unit test for <code class="classname">Car</code>:</p><div class="example"><a id="d0e202"/><p class="title"><b>例 1.5. Class <code class="classname">CarTest</code> showing validation examples</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter01</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">Set</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_type">ConstraintViolation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_type">Validation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_type">Validator</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_type">ValidatorFactory</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">junit</span><span class="java_separator">.</span><span class="java_type">BeforeClass</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">junit</span><span class="java_separator">.</span><span class="java_type">Test</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;org</span><span class="java_separator">.</span><span class="java_plain">junit</span><span class="java_separator">.</span><span class="java_type">Assert</span><span class="java_separator">.</span><span class="java_plain">assertEquals</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CarTest</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;</span><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">BeforeClass</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setUp</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Validation</span><span class="java_separator">.</span><span class="java_plain">buildDefaultValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;manufacturerIsNull</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">4</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;licensePlateTooShort</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;D&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">4</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;size&nbsp;must&nbsp;be&nbsp;between&nbsp;2&nbsp;and&nbsp;14&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;seatCountTooLow</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;must&nbsp;be&nbsp;greater&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;2&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;carIsValid</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>In the <code class="methodname">setUp()</code> method a <code class="classname">Validator</code> object is retrieved from the <code class="classname">ValidatorFactory</code>. A <code class="classname">Validator</code> instance is thread-safe and may be reused multiple times. It thus can safely be stored in a static field and be used in the test methods to validate the different <code class="classname">Car</code> instances.</p><p>The <code class="methodname">validate()</code> method returns a set of <code class="classname">ConstraintViolation</code> instances, which you can iterate over in order to see which validation errors occurred. The first three test methods show some expected constraint violations:</p><div class="itemizedlist"><ul><li><p>The <code class="classname">@NotNull</code> constraint on manufacturer is violated in <code class="methodname">manufacturerIsNull()</code></p></li><li><p>The <code class="classname">@Size</code> constraint on licensePlate is violated in <code class="methodname">licensePlateTooShort()</code></p></li><li><p>The <code class="classname">@Min</code> constraint on seatCount is violated in <code class="methodname">seatCountTooLow()</code></p></li></ul></div><p>If the object validates successfully, <code class="methodname">validate()</code> returns an empty set as you can see in <code class="methodname">carIsValid()</code>.</p><p>Note that only classes from the package <span class="package">javax.validation</span> are used. These are provided from the Bean Validation API. No classes from Hibernate Validator are directly referenced, resulting in portable code.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-gettingstarted-whatsnext"/>1.4. Where to go next?</h2></div></div></div><p>That concludes the 5 minute tour through the world of Hibernate Validator and Bean Validation. Continue exploring the code examples or look at further examples referenced in <a class="xref" href="#validator-further-reading" title="第 13 章 Further reading">第 13 章 <i>Further reading</i></a>.</p><p>To learn more about the validation of beans and properties, just continue reading <a class="xref" href="#chapter-bean-constraints" title="第 2 章 Declaring and validating bean constraints">第 2 章 <i>Declaring and validating bean constraints</i></a>. If you are interested in using Bean Validation for the validation of method pre- and postcondition refer to <a class="xref" href="#chapter-method-constraints" title="第 3 章 Declaring and validating method constraints">第 3 章 <i>Declaring and validating method constraints</i></a>. In case your application has specific validation requirements have a look at <a class="xref" href="#validator-customconstraints" title="第 6 章 Creating custom constraints">第 6 章 <i>Creating custom constraints</i></a>.</p></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-bean-constraints"/>第 2 章 Declaring and validating bean constraints</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#section-declaring-bean-constraints">2.1. Declaring bean constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e328">2.1.1. Field-level constraints</a></span></dt><dt><span class="section"><a href="#d0e347">2.1.2. Property-level constraints</a></span></dt><dt><span class="section"><a href="#d0e378">2.1.3. Class-level constraints</a></span></dt><dt><span class="section"><a href="#section-constraint-inheritance">2.1.4. Constraint inheritance</a></span></dt><dt><span class="section"><a href="#section-object-graph-validation">2.1.5. Object graphs</a></span></dt></dl></dd><dt><span class="section"><a href="#section-validating-bean-constraints">2.2. Validating bean constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-obtaining-validator">2.2.1. Obtaining a Validator instance</a></span></dt><dt><span class="section"><a href="#d0e622">2.2.2. Validator methods</a></span></dt><dt><span class="section"><a href="#section-constraint-violation-methods">2.2.3. ConstraintViolation methods</a></span></dt></dl></dd><dt><span class="section"><a href="#section-builtin-constraints">2.3. Built-in constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-defineconstraints-spec">2.3.1. Bean Validation constraints</a></span></dt><dt><span class="section"><a href="#validator-defineconstraints-hv-constraints">2.3.2. Additional constraints</a></span></dt></dl></dd></dl></div><p>In this chapter you will learn how to declare (see <a class="xref" href="#section-declaring-bean-constraints" title="2.1. Declaring bean constraints">第 2.1 节 “Declaring bean constraints”</a>) and validate (see <a class="xref" href="#section-validating-bean-constraints" title="2.2. Validating bean constraints">第 2.2 节 “Validating bean constraints”</a>) bean constraints. <a class="xref" href="#section-builtin-constraints" title="2.3. Built-in constraints">第 2.3 节 “Built-in constraints”</a> provides an overview of all built-in constraints coming with Hibernate Validator.</p><p>If you are interested in applying constraints to method parameters and return values, refer to <a class="xref" href="#chapter-method-constraints" title="第 3 章 Declaring and validating method constraints">第 3 章 <i>Declaring and validating method constraints</i></a>.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-declaring-bean-constraints"/>2.1. Declaring bean constraints</h2></div></div></div><p>Constraints in Bean Validation are expressed via Java annotations. In this section you will learn how to enhance an object model with these annotations. There are the following three types of bean constraints:</p><div class="itemizedlist"><ul><li><p>field constraints</p></li><li><p>property constraints</p></li><li><p>class constraints</p></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Not all constraints can be placed on all of these levels. In fact, none of the default constraints defined by Bean Validation can be placed at class level. The <code class="classname">java.lang.annotation.Target</code> annotation in the constraint annotation itself determines on which elements a constraint can be placed. See <a class="xref" href="#validator-customconstraints" title="第 6 章 Creating custom constraints">第 6 章 <i>Creating custom constraints</i></a> for more information.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e328"/>2.1.1. Field-level constraints</h3></div></div></div><p>Constraints can be expressed by annotating a field of a class. <a class="xref" href="#example-field-level" title="例 2.1. Field-level constraints">例 2.1 “Field-level constraints”</a> shows a field level configuration example:</p><div class="example"><a id="example-field-level"/><p class="title"><b>例 2.1. Field-level constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">fieldlevel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>When using field-level constraints field access strategy is used to access the value to be validated. This means the validation engine directly accesses the instance variable and does not invoke the property accessor method even if such an accessor exists.</p><p>Constraints can be applied to fields of any access type (public, private etc.). Constraints on static fields are not supported, though.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>When validating byte code enhanced objects property level constraints should be used, because the byte code enhancing library won't be able to determine a field access via reflection.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e347"/>2.1.2. Property-level constraints</h3></div></div></div><p>If your model class adheres to the <a class="ulink" href="http://java.sun.com/javase/technologies/desktop/javabeans/index.jsp">JavaBeans</a> standard, it is also possible to annotate the properties of a bean class instead of its fields. <a class="xref" href="#example-property-level" title="例 2.2. Property-level constraints">例 2.2 “Property-level constraints”</a> uses the same entity as in <a class="xref" href="#example-field-level" title="例 2.1. Field-level constraints">例 2.1 “Field-level constraints”</a>, however, property level constraints are used.</p><div class="example"><a id="example-property-level"/><p class="title"><b>例 2.2. Property-level constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">propertylevel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setManufacturer</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRegistered</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>The property's getter method has to be annotated, not its setter. That way also read-only properties can be constrained which have no setter method.</p></div><p>When using property level constraints property access strategy is used to access the value to be validated, i.e. the validation engine accesses the state via the property accessor method.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>It is recommended to stick either to field <span class="emphasis"><em>or</em></span> property annotations within one class. It is not recommended to annotate a field <span class="emphasis"><em>and</em></span> the accompanying getter method as this would cause the field to be validated twice.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e378"/>2.1.3. Class-level constraints</h3></div></div></div><p>Last but not least, a constraint can also be placed on the class level. In this case not a single property is subject of the validation but the complete object. Class-level constraints are useful if the validation depends on a correlation between several properties of an object.</p><p>The <code class="classname">Car</code> class in <a class="xref" href="#example-class-level" title="例 2.3. Class-level constraint">例 2.3 “Class-level constraint”</a> has the two attributes <code class="varname">seatCount</code> and <code class="varname">passengers</code> and it should be ensured that the list of passengers has not more entries than seats are available. For that purpose the <code class="classname">@ValidPassengerCount</code> constraint is added on the class level. The validator of that constraint has access to the complete <code class="classname">Car</code> object, allowing to compare the numbers of seats and passengers.</p><p>Refer to <a class="xref" href="#section-class-level-constraints" title="6.2. Class-level constraints">第 6.2 节 “Class-level constraints”</a> to learn in detail how to implement this custom constraint.</p><div class="example"><a id="example-class-level"/><p class="title"><b>例 2.3. Class-level constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">classlevel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ValidPassengerCount</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-constraint-inheritance"/>2.1.4. Constraint inheritance</h3></div></div></div><p>When a class implements an interface or extends another class, all constraint annotations declared on the supertype apply in the same manner as the constraints specified on the class itself. To make things clearer let's have a look at the following example:</p><div class="example"><a id="d0e416"/><p class="title"><b>例 2.4. Constraint inheritance</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getRentalStation</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Here the class <code class="classname">RentalCar</code> is a subclass of <code class="classname">Car</code> and adds the property <span class="property">rentalStation</span>. If an instance of <code class="classname">RentalCar</code> is validated, not only the <code class="classname">@NotNull</code> constraint on <span class="property">rentalStation</span> is evaluated, but also the constraint on <span class="property">manufacturer</span> from the parent class.</p><p>The same would be true, if <code class="classname">Car</code> was not a superclass but an interface implemented by <code class="classname">RentalCar</code>.</p><p>Constraint annotations are aggregated if methods are overridden. So if <code class="classname">RentalCar</code> overrode the <code class="methodname">getManufacturer()</code> method from <code class="classname">Car</code>, any constraints annotated at the overriding method would be evaluated in addition to the <code class="classname">@NotNull</code> constraint from the superclass.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-object-graph-validation"/>2.1.5. Object graphs</h3></div></div></div><p>The Bean Validation API does not only allow to validate single class instances but also complete object graphs (cascaded validation). To do so, just annotate a field or property representing a reference to another object with <code class="classname">@Valid</code> as demonstrated in <a class="xref" href="#example-cascaded-validation" title="例 2.5. Cascaded validation">例 2.5 “Cascaded validation”</a>.</p><div class="example"><a id="example-cascaded-validation"/><p class="title"><b>例 2.5. Cascaded validation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">objectgraph</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">objectgraph</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>If an instance of <code class="classname">Car</code> is validated, the referenced <code class="classname">Person</code> object will be validated as well, as the <span class="property">driver</span> field is annotated with <code class="classname">@Valid</code>. Therefore the validation of a <code class="classname">Car</code> will fail if the <span class="property">name</span> field of the referenced <code class="classname">Person</code> instance is <code class="code">null</code>.</p><p>The validation of object graphs is recursive, i.e. if a reference marked for cascaded validation points to an object which itself has properties annotated with <code class="classname">@Valid</code>, these references will be followed up by the validation engine as well. The validation engine will ensure that no infinite loops occur during cascaded validation, for example if two objects hold references to each other.</p><p>Note that <code class="literal">null</code> values are getting ignored during cascaded validation.</p><p>Object graph validation also works for collection-typed fields. That means any attributes that</p><div class="itemizedlist"><ul><li><p>are arrays</p></li><li><p>implement <code class="classname">java.lang.Iterable</code> (especially <code class="classname">Collection</code>, <code class="classname">List</code> and <code class="classname">Set</code>)</p></li><li><p>implement <code class="classname">java.util.Map</code></p></li></ul></div><p>can be annotated with <code class="classname">@Valid</code>, which will cause each contained element to be validated, when the parent object is validated.</p><div class="example"><a id="example-cascaded-validation-list"/><p class="title"><b>例 2.6. Cascaded validation of a collection</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter02</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">objectgraph</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">list</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>So when validating an instance of the <code class="classname">Car</code> class shown in <a class="xref" href="#example-cascaded-validation-list" title="例 2.6. Cascaded validation of a collection">例 2.6 “Cascaded validation of a collection”</a>, a <code class="classname">ConstraintViolation</code> will be created, if any of the <code class="classname">Person</code> objects contained in the <span class="property">passengers</span> list has a <code class="code">null</code> name.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-validating-bean-constraints"/>2.2. Validating bean constraints</h2></div></div></div><p>The <code class="classname">Validator</code> interface is the most important object in Bean Validation. The next section shows how to obtain an <code class="classname">Validator</code> instance. Afterwards you'll learn how to use the different methods of the <code class="classname">Validator</code> interface.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-obtaining-validator"/>2.2.1. Obtaining a <code class="classname">Validator</code> instance</h3></div></div></div><p>The first step towards validating an entity instance is to get hold of a <code class="classname">Validator</code> instance. The road to this instance leads via the <code class="classname">Validation</code> class and a <code class="classname">ValidatorFactory</code>. The easiest way is to use the static method <code class="methodname">Validation#buildDefaultValidatorFactory()</code>:</p><div class="example"><a id="d0e610"/><p class="title"><b>例 2.7. Validation#buildDefaultValidatorFactory()</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>This bootstraps a validator in the default configuration. Refer to <a class="xref" href="#chapter-bootstrapping" title="第 8 章 Bootstrapping">第 8 章 <i>Bootstrapping</i></a> to learn more about the different bootstrapping methods and how to obtain a specifically configured <code class="classname">Validator</code> instance.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e622"/>2.2.2. Validator methods</h3></div></div></div><p>The <code class="classname">Validator</code> interface contains three methods that can be used to either validate entire entities or just single properties of the entity.</p><p>All three methods return a <code class="classname">Set&lt;ConstraintViolation&gt;</code>. The set is empty, if the validation succeeds. Otherwise a <code class="classname">ConstraintViolation</code> instance is added for each violated constraint.</p><p>All the validation methods have a var-args parameter which can be used to specify, which validation groups shall be considered when performing the validation. If the parameter is not specified the default validation group (<code class="classname">javax.validation.groups.Default</code>) is used. The topic of validation groups is discussed in detail in <a class="xref" href="#chapter-groups" title="第 5 章 Grouping constraints">第 5 章 <i>Grouping constraints</i></a>.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e645"/>2.2.2.1. <code class="methodname">Validator#validate()</code></h4></div></div></div><p>Use the <code class="methodname">validate()</code> method to perform validation of all constraints of a given bean. <a class="xref" href="#example-validator-validate" title="例 2.8. Using Validator#validate()">例 2.8 “Using Validator#validate()”</a> shows the validation of an instance of the <code class="classname">Car</code> class from <a class="xref" href="#example-property-level" title="例 2.2. Property-level constraints">例 2.2 “Property-level constraints”</a> which fails to satisfy the <code class="classname">@NotNull</code> constraint on the <code class="varname">manufacturer</code> property. The validation call therefore returns one <code class="classname">ConstraintViolation</code> object.</p><div class="example"><a id="example-validator-validate"/><p class="title"><b>例 2.8. Using <code class="methodname">Validator#validate()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;car&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">null</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">true</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e677"/>2.2.2.2. <code class="methodname">Validator#validateProperty()</code></h4></div></div></div><p>With help of the <code class="methodname">validateProperty()</code> you can validate a single named property of a given object. The property name is the JavaBeans property name.</p><div class="example"><a id="d0e686"/><p class="title"><b>例 2.9. Using <code class="methodname">Validator#validateProperty()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;car&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">null</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">true</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;car</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e693"/>2.2.2.3. <code class="methodname">Validator#validateValue()</code></h4></div></div></div><p>By using the <code class="methodname">validateValue() </code>method you can check whether a single property of a given class can be validated successfully, if the property had the specified value:</p><div class="example"><a id="d0e702"/><p class="title"><b>例 2.10. Using <code class="methodname">Validator#validateValue()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Set</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">ConstraintViolation</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_operator">&gt;&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validateValue</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">null</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p><code class="classname">@Valid</code> is not honored by <code class="methodname">validateProperty()</code> or <code class="methodname">validateValue()</code>.</p></div><p><code class="methodname">Validator#validateProperty()</code> is for example used in the integration of Bean Validation into JSF 2 (see <a class="xref" href="#section-presentation-layer" title="10.2. JSF &amp; Seam">第 10.2 节 “JSF &amp; Seam”</a>) to perform a validation of the values entered into a form before they are propagated to the model.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-constraint-violation-methods"/>2.2.3. <code class="classname">ConstraintViolation</code> methods</h3></div></div></div><p>Now it is time to have a closer look at what a <code class="classname">ConstraintViolation</code> is. Using the different methods of <code class="classname">ConstraintViolation</code> a lot of useful information about the cause of the validation failure can be determined. <a class="xref" href="#table-constraint-violation" title="表 2.1. The various ConstraintViolation methods">表 2.1 “The various ConstraintViolation methods”</a> gives an overview of these methods. The values in the "Example" column refer to <a class="xref" href="#example-validator-validate" title="例 2.8. Using Validator#validate()">例 2.8 “Using Validator#validate()”</a>.</p><div class="table"><a id="table-constraint-violation"/><p class="title"><b>表 2.1. The various <code class="classname">ConstraintViolation</code> methods</b></p><div class="table-contents"><table summary="The various ConstraintViolation methods" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th>Method</th><th>Usage</th><th>Example</th></tr></thead><tbody><tr><td><code class="methodname">getMessage()</code></td><td>The interpolated error message</td><td>"may not be null"</td></tr><tr><td><code class="methodname">getMessageTemplate()</code></td><td>The non-interpolated error message</td><td>"{... NotNull.message}"</td></tr><tr><td><code class="methodname">getRootBean()</code></td><td>The root bean being validated</td><td><code class="varname">car</code></td></tr><tr><td><code class="methodname">getRootBeanClass()</code></td><td>The class of the root bean being validated</td><td><code class="classname">Car.class</code></td></tr><tr><td><code class="methodname">getLeafBean()</code></td><td>If a bean constraint, the bean instance the constraint is applied on; If a property constraint, the bean instance hosting the property the constraint is applied on</td><td><code class="varname">car</code></td></tr><tr><td><code class="methodname">getPropertyPath()</code></td><td>The property path to the validated value from root bean</td><td>contains one node with kind <code class="classname">PROPERTY</code> and name "manufacturer"</td></tr><tr><td><code class="methodname">getInvalidValue()</code></td><td>The value failing to pass the constraint</td><td><code class="literal">null</code></td></tr><tr><td><code class="methodname">getConstraintDescriptor()</code></td><td>Constraint metadata reported to fail</td><td>descriptor for <code class="classname">@NotNull</code></td></tr></tbody></table></div></div><br class="table-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-builtin-constraints"/>2.3. Built-in constraints</h2></div></div></div><p>Hibernate Validator comprises a basic set of commonly used constraints. These are foremost the constraints defined by the Bean Validation specification (see <a class="xref" href="#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a>). Additionally, Hibernate Validator provides useful custom constraints (see <a class="xref" href="#table-custom-constraints" title="表 2.3. Custom constraints">表 2.3 “Custom constraints”</a> and <a class="xref" href="#table-custom-country-constraints" title="表 2.4. Custom country specific constraints">表 2.4 “Custom country specific constraints”</a>).</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-defineconstraints-spec"/>2.3.1. Bean Validation constraints</h3></div></div></div><p><a class="xref" href="#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a> shows purpose and supported data types of all constraints specified in the Bean Validation API. All these constraints apply to the field/property level, there are no class-level constraints defined in the Bean Validation specification. If you are using the Hibernate object-relational mapper, some of the constraints are taken into account when creating the DDL for your model (see column "Hibernate metadata impact").</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Hibernate Validator allows some constraints to be applied to more data types than required by the Bean Validation specification (e.g. <code class="classname">@Max</code> can be applied to <code class="classname">Strings</code>). Relying on this feature can impact portability of your application between Bean Validation providers.</p></div><div class="table"><a id="table-spec-constraints"/><p class="title"><b>表 2.2. Bean Validation constraints</b></p><div class="table-contents"><table summary="Bean Validation constraints" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Supported data types</th><th align="left">Use</th><th align="left">Hibernate metadata impact</th></tr></thead><tbody valign="top"><tr><td align="left" valign="top"><code class="classname">@AssertFalse</code></td><td align="left" valign="top"><code class="classname">Boolean</code>, <code class="classname">boolean</code></td><td align="left" valign="top">Checks that the annotated element is <code class="constant">false</code></td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@AssertTrue</code></td><td align="left" valign="top"><code class="classname">Boolean</code>, <code class="classname">boolean</code></td><td align="left" valign="top">Checks that the annotated element is <code class="constant">true</code></td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@DecimalMax(value=,</code> <code class="classname">inclusive=)</code></td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">CharSequence</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types; Additionally supported by HV: any sub-type of <code class="classname">Number</code></td><td align="left" valign="top">Checks whether the annotated value is less than the specified maximum, when <em class="parameter"><code>inclusive=false</code></em>. Otherwise whether the value is less than or equal to the specified maximum. The parameter <em class="parameter"><code>value</code></em> is the string representation of the max value according to the <code class="classname">BigDecimal</code> string representation.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@DecimalMin(value=,</code> <code class="classname">inclusive=)</code></td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">CharSequence</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types; Additionally supported by HV: any sub-type of <code class="classname">Number</code></td><td align="left" valign="top">Checks whether the annotated value is larger than the specified minimum, when <em class="parameter"><code>inclusive=false</code></em>. Otherwise whether the value is larger than or equal to the specified minimum. The parameter <em class="parameter"><code>value</code></em> is the string representation of the min value according to the <code class="classname">BigDecimal</code> string representation.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Digits(integer=,</code> <code class="classname">fraction=)</code></td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">CharSequence</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types; Additionally supported by HV: any sub-type of <code class="classname">Number</code></td><td align="left" valign="top">Checks whether the annoted value is a number having up to <code class="literal">integer</code> digits and <code class="literal">fraction</code> fractional digits</td><td align="left" valign="top">Defines column precision and scale</td></tr><tr><td align="left" valign="top"><code class="classname">@Future</code></td><td align="left" valign="top"><code class="classname">java.util.Date</code>, <code class="classname">java.util.Calendar</code>; Additionally supported by HV, if the <a class="ulink" href="http://joda-time.sourceforge.net/">Joda Time</a> date/time API is on the class path: any implementations of <code class="classname">ReadablePartial</code> and <code class="classname">ReadableInstant</code></td><td align="left" valign="top">Checks whether the annotated date is in the future</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Max(value=)</code></td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types; Additionally supported by HV: any sub-type of <code class="classname">CharSequence</code> (the numeric value represented by the character sequence is evaluated), any sub-type of <code class="classname">Number</code></td><td align="left" valign="top">Checks whether the annotated value is less than or equal to the specified maximum</td><td align="left" valign="top">Adds a check constraint on the column</td></tr><tr><td align="left" valign="top"><code class="classname">@Min(value=)</code></td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types; Additionally supported by HV: any sub-type of <code class="classname">CharSequence</code> (the numeric value represented by the char sequence is evaluated), any sub-type of <code class="classname">Number</code></td><td align="left" valign="top">Checks whether the annotated value is higher than or equal to the specified minimum</td><td align="left" valign="top">Adds a check constraint on the column</td></tr><tr><td align="left" valign="top"><code class="classname">@NotNull</code></td><td align="left" valign="top">Any type</td><td align="left" valign="top">Checks that the annotated value is not <code class="constant">null.</code></td><td align="left" valign="top">Column(s) are not nullable</td></tr><tr><td align="left" valign="top"><code class="classname">@Null</code></td><td align="left" valign="top">Any type</td><td align="left" valign="top">Checks that the annotated value is <code class="constant">null</code></td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Past</code></td><td align="left" valign="top"><code class="classname">java.util.Date</code>, <code class="classname">java.util.Calendar</code>; Additionally supported by HV, if the <a class="ulink" href="http://joda-time.sourceforge.net/">Joda Time</a> date/time API is on the class path: any implementations of <code class="classname">ReadablePartial</code> and <code class="classname">ReadableInstant</code></td><td align="left" valign="top">Checks whether the annotated date is in the past</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Pattern(regex=,</code> <code class="classname">flag=)</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks if the annotated string matches the regular expression <em class="parameter"><code>regex</code></em> considering the given flag <em class="parameter"><code>match</code></em></td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Size(min=, max=)</code></td><td align="left" valign="top"><code class="classname">CharSequence</code>, <code class="classname">Collection</code>, <code class="classname">Map</code> and <code class="classname">arrays</code></td><td align="left" valign="top">Checks if the annotated element's size is between min and max (inclusive)</td><td align="left" valign="top">Column length will be set to <em class="parameter"><code>max</code></em></td></tr><tr><td align="left" valign="top"><code class="classname">@Valid</code></td><td align="left" valign="top">Any non-primitive type</td><td align="left" valign="top">Performs validation recursively on the associated object. If the object is a collection or an array, the elements are validated recursively. If the object is a map, the value elements are validated recursively.</td><td align="left" valign="top">None</td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>On top of the parameters indicated in <a class="xref" href="#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a> each constraint has the parameters <em class="parameter"><code>message</code></em>, <em class="parameter"><code>groups</code></em> and <em class="parameter"><code>payload</code></em>. This is a requirement of the Bean Validation specification.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-defineconstraints-hv-constraints"/>2.3.2. Additional constraints</h3></div></div></div><p>In addition to the constraints defined by the Bean Validation API Hibernate Validator provides several useful custom constraints which are listed in <a class="xref" href="#table-custom-constraints" title="表 2.3. Custom constraints">表 2.3 “Custom constraints”</a>. With one exception also these constraints apply to the field/property level, only <code class="classname">@ScriptAssert</code> is a class-level constraint.</p><div class="table"><a id="table-custom-constraints"/><p class="title"><b>表 2.3. Custom constraints</b></p><div class="table-contents"><table summary="Custom constraints" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Supported data types</th><th align="left">Use</th><th align="left">Hibernate metadata impact</th></tr></thead><tbody valign="top"><tr><td align="left" valign="top"><code class="classname">@CreditCardNumber</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence passes the Luhn checksum test. Note, this validation aims to check for user mistakes, not credit card validity! See also <a class="ulink" href="http://www.merriampark.com/anatomycc.htm">Anatomy of Credit Card Numbers</a>.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Email</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks whether the specified character sequence is a valid email address. The optional parameters <em class="parameter"><code>regexp</code></em> and <em class="parameter"><code>flags</code></em> allow to specify an additional regular expression (including regular expression flags) which the email must match.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Length(min=, max=)</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Validates that the annotated character sequence is between <em class="parameter"><code>min</code></em> and <em class="parameter"><code>max</code></em> included</td><td align="left" valign="top">Column length will be set to <em class="parameter"><code>max</code></em></td></tr><tr><td align="left" valign="top"><code class="classname">@ModCheck(modType=,</code> <code class="classname">multiplier=, startIndex=,</code> <code class="classname">endIndex=,</code> <code class="classname">checkDigitPosition=,</code> <code class="classname">ignoreNonDigitCharacters=)</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the digits within the annotated character sequence pass the mod 10 or mod 11 checksum algorithm. <code class="constant">modType</code> is used to select the modulo type and the <code class="constant">multiplier</code> determines the algorithm specific multiplier (see also <a class="ulink" href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn algorithm</a>). <code class="constant">startIndex</code> and <code class="constant">endIndex</code> allow to only run the modulo algorithm on the specified sub-string. <code class="constant">checkDigitPosition</code> allows to use an arbitrary digit within the character sequence to be the check digit. If not specified it is assumed that the check digit is part of the specified range. Last but not least, <code class="constant">ignoreNonDigitCharacters</code> allows to ignore non digit characters.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@NotBlank</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence is not null and the trimmed length is greater than 0. The difference to @NotEmpty is that this constraint can only be applied on strings and that trailing whitespaces are ignored.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@NotEmpty</code></td><td align="left" valign="top"><code class="classname">CharSequence</code>, <code class="classname">Collection</code>, <code class="classname">Map</code> and arrays</td><td align="left" valign="top">Checks whether the annotated element is not <code class="constant">null</code> nor empty</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@Range(min=, max=)</code></td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">CharSequence</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types</td><td align="left" valign="top">Checks whether the annotated value lies between (inclusive) the specified minimum and maximum</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@SafeHtml(whitelistType=,</code> <code class="classname">additionalTags=)</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks whether the annotated value contains potentially malicious fragments such as <code class="code">&lt;script/&gt;</code>. In order to use this constraint, the <a class="ulink" href="http://jsoup.org/">jsoup</a> library must be part of the class path. With the <em class="parameter"><code>whitelistType</code></em> attribute predefined whitelist types can be chosen. You can also specify additional html tags for the whitelist with the <em class="parameter"><code>additionalTags</code></em> attribute.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@ScriptAssert(lang=,</code> <code class="classname">script=, alias=)</code></td><td align="left" valign="top">Any type</td><td align="left" valign="top">Checks whether the given script can successfully be evaluated against the annotated element. In order to use this constraint, an implementation of the Java Scripting API as defined by JSR 223 ("Scripting for the Java<sup>TM</sup> Platform") must part of the class path. The expressions to be evaluated can be written in any scripting or expression language, for which a JSR 223 compatible engine can be found in the class path.</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@URL(protocol=,</code> <code class="classname">host=, port=</code> <code class="classname">regexp=, flags=)</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks if the annotated character sequence is a valid URL according to RFC2396. If any of the optional parameters <em class="parameter"><code>protocol</code></em>, <em class="parameter"><code>host</code></em> or <em class="parameter"><code>port</code></em> are specified, the corresponding URL fragments must match the specified values. The optional parameters <em class="parameter"><code>regexp</code></em> and <em class="parameter"><code>flags</code></em> allow to specify an additional regular expression (including regular expression flags) which the URL must match.</td><td align="left" valign="top">None</td></tr></tbody></table></div></div><br class="table-break"/><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1496"/>2.3.2.1. Country specific constraints</h4></div></div></div><p>Hibernate Validator offers also some country specific constraints, e.g. for the validation of social security numbers. </p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>If you have to implement a country specific constraint, consider making it a contribution to Hibernate Validator!</p></div><div class="table"><a id="table-custom-country-constraints"/><p class="title"><b>表 2.4. Custom country specific constraints</b></p><div class="table-contents"><table summary="Custom country specific constraints" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Supported data types</th><th align="left">Use</th><th align="left">Country</th><th align="left">Hibernate metadata impact</th></tr></thead><tbody valign="top"><tr><td align="left" valign="top"><code class="classname">@CNPJ</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence represents a Brazilian corporate tax payer registry number (Cadastro de Pessoa Juríeddica)</td><td align="left" valign="top">Brazil</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@CPF</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence represents a Brazilian individual taxpayer registry number (Cadastro de Pessoa Fídsica)</td><td align="left" valign="top">Brazil</td><td align="left" valign="top">None</td></tr><tr><td align="left" valign="top"><code class="classname">@TituloEleitoral</code></td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence represents a Brazilian voter ID card number (<a class="ulink" href="http://ghiorzi.org/cgcancpf.htm">Título Eleitoral</a>)</td><td align="left" valign="top">Brazil</td><td align="left" valign="top">None</td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>In some cases neither the Bean Validation constraints nor the custom constraints provided by Hibernate Validator will fulfill your requirements. In this case you can easily write your own constraint. You can find more information in <a class="xref" href="#validator-customconstraints" title="第 6 章 Creating custom constraints">第 6 章 <i>Creating custom constraints</i></a>.</p></div></div></div></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-method-constraints"/>第 3 章 Declaring and validating method constraints</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#section-declaring-method-constraints">3.1. Declaring method constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e1621">3.1.1. Parameter constraints</a></span></dt><dt><span class="section"><a href="#d0e1731">3.1.2. Return value constraints</a></span></dt><dt><span class="section"><a href="#d0e1767">3.1.3. Cascaded validation</a></span></dt><dt><span class="section"><a href="#d0e1867">3.1.4. Method constraints in inheritance hierarchies</a></span></dt></dl></dd><dt><span class="section"><a href="#section-validating-executable-constraints">3.2. Validating method constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-obtaining-executable-validator">3.2.1. Obtaining an ExecutableValidator instance</a></span></dt><dt><span class="section"><a href="#section-executable-validator-methods">3.2.2. ExecutableValidator methods</a></span></dt><dt><span class="section"><a href="#d0e2198">3.2.3. ConstraintViolation methods for method validation</a></span></dt></dl></dd></dl></div><p>As of Bean Validation 1.1, constraints can not only be applied to JavaBeans and their properties, but also to the parameters and return values of the methods and constructors of any Java type. That way Bean Validation constraints can be used to specify</p><div class="itemizedlist"><ul><li><p>the preconditions that must be satisfied by the caller before a method or constructor may be invoked (by applying constraints to the parameters of an executable)</p></li><li><p>the postconditions that are guaranteed to the caller after a method or constructor invocation returns (by applying constraints to the return value of an executable)</p></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>For the purpose of this reference guide, the term <span class="emphasis"><em>method constraint</em></span> refers to both, method and constructor constraints, if not stated otherwise. Ocassionally, the term <span class="emphasis"><em>executable</em></span> is used when referering to methods and constructors.</p></div><p>This approach has several advantages over traditional ways of checking the correctness of parameters and return values:</p><div class="itemizedlist"><ul><li><p>the checks don't have to be performed manually (e.g. by throwing <code class="classname">IllegalArgumentExceptions</code> or similar), resulting in less code to write and maintain</p></li><li><p>an executable's pre- and postconditions don't have to be expressed again in its documentation, since the constraint annotations will automatically be included in the generated JavaDoc. This avoids redundancies and reduces the chance of inconsistencies between implementation and documentation</p></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>In order to make annotations show up in the JavaDoc of annoted elements, the annotation types themselves must be annotated with the meta annotation <code class="classname">@Documented</code>. This is the case for all built-in constraints and is considered a best practice for any custom constraints.</p></div><p>In the remainder of this chapter you will learn how to declare parameter and return value constraints and how to validate them using the <code class="classname">ExecutableValidator</code> API.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-declaring-method-constraints"/>3.1. Declaring method constraints</h2></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1621"/>3.1.1. Parameter constraints</h3></div></div></div><p>You specify the preconditions of a method or constructor by adding constraint annotations to its parameters as demonstrated in <a class="xref" href="#example-declaring-parameter-constraints" title="例 3.1. Declaring method and constructor parameter constraints">例 3.1 “Declaring method and constructor parameter constraints”</a>.</p><div class="example"><a id="example-declaring-parameter-constraints"/><p class="title"><b>例 3.1. Declaring method and constructor parameter constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">parameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;rentCar</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;@</span><span class="java_type">Future</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;startDate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;durationInDays</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The following preconditions are declared here:</p><div class="itemizedlist"><ul><li><p>The name passed to the <code class="classname">RentalCar</code> constructor must not be <code class="literal">null</code></p></li><li><p>When invoking the <code class="methodname">rentCar()</code> method, the given customer must not be <code class="literal">null</code>, the rental's start date must not be <code class="literal">null</code> and must be in the future and the rental duration must be at least one day</p></li></ul></div><p>Note that declaring method or constructor constraints itself does not automatically cause their validation upon invocation of the executable. Instead, the ExecutableValidator API (see <a class="xref" href="#section-validating-executable-constraints" title="3.2. Validating method constraints">第 3.2 节 “Validating method constraints”</a>) must be used to perform the validation, which is often done using a method interception facility such as AOP, proxy objects etc.</p><p>Constraints may only be applied to instance methods, i.e. declaring constraints on static methods is not supported. Depending on the interception facility you use for triggering method validation, additional restrictions may apply, e.g. with respect to the visibility of methods supported as target of interception. Refer to the documentation of the interception technology to find out whether any such limitations exist.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1662"/>3.1.1.1. Cross-parameter constraints</h4></div></div></div><p>Sometimes validation does not only depend on a single parameter but on several or even all parameters of a method or constructor. This kind of requirement can be fulfilled with help of a cross-parameter constraint.</p><p>Cross-parameter constraints can be considered as the method validation equivalent to class-level constraints. Both can be used to implement validation requirements which are based on several elements. While class-level constraints apply to several properties of a bean, cross-parameter constraints apply to several parameters of an executable.</p><p>In contrast to single-parameter constraints, cross-parameter constraints are declared on the method or constructor as you can see in <a class="xref" href="#example-using-cross-parameter-constraint" title="例 3.2. Declaring a cross-parameter constraint">例 3.2 “Declaring a cross-parameter constraint”</a>. Here the cross-parameter constraint <code class="classname">@LuggageCountMatchesPassengerCount</code> declared on the <code class="methodname">load()</code> method is used to ensure that no passenger has more than two pieces of luggage.</p><div class="example"><a id="example-using-cross-parameter-constraint"/><p class="title"><b>例 3.2. Declaring a cross-parameter constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">crossparameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">LuggageCountMatchesPassengerCount</span><span class="java_separator">(</span><span class="java_plain">piecesOfLuggagePerPassenger&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;load</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">PieceOfLuggage</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;luggage</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>As you will learn in the next section, return value constraints are also declared on the method level. In order to distinguish cross-parameter constraints from return value constraints, the constraint target is configured in the <code class="classname">ConstraintValidator</code> implementation using the <code class="classname">@SupportedValidationTarget</code> annotation. You can find out about the details in <a class="xref" href="#section-cross-parameter-constraints" title="6.3. Cross-parameter constraints">第 6.3 节 “Cross-parameter constraints”</a> which shows how to implement your own cross-parameter constraint.</p><p>In some cases a constraint can be applied to an executable's parameters (i.e. it is a cross-parameter constraint), but also to the return value. One example for this are custom constraints which allow to specify validation rules using expression or script languages.</p><p>Such constraints must define a member <code class="methodname">validationAppliesTo()</code> which can be used at declaration time to specify the constraint target. As shown in <a class="xref" href="#example-specifying-constraint-target" title="例 3.3. Specifying a constraint's target">例 3.3 “Specifying a constraint's target”</a> you apply the constraint to an executable's parameters by specifying <code class="literal">validationAppliesTo = ConstraintTarget.PARAMETERS</code>, while <code class="classname">ConstraintTarget.RETURN_VALUE</code> is used to apply the constraint to the executable return value.</p><div class="example"><a id="example-specifying-constraint-target"/><p class="title"><b>例 3.3. Specifying a constraint's target</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">crossparameter</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">constrainttarget</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Garage</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ELAssert</span><span class="java_separator">(</span><span class="java_plain">expression&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;...&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validationAppliesTo&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintTarget</span><span class="java_separator">.</span><span class="java_plain">PARAMETERS</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;buildCar</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Part</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;parts</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ELAssert</span><span class="java_separator">(</span><span class="java_plain">expression&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;...&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validationAppliesTo&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintTarget</span><span class="java_separator">.</span><span class="java_plain">RETURN_VALUE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;paintCar</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;color</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Although such a constraint is applicable to the parameters and return value of an executable, the target can often be inferred automatically. This is the case, if the constraint is declared on</p><div class="itemizedlist"><ul><li><p>a void method with parameters (the constraint applies to the parameters)</p></li><li><p>an executable with return value but no parameters (the constraint applies to the return value)</p></li><li><p>neither a method nor a constructor, but a field, parameter etc. (the constraint applies to the annotated element)</p></li></ul></div><p>In these situations you don't have to specify the constraint target. It is still recommended to do so if it increases readability of the source code. If the constraint target is not specified in situations where it can't be determined automatically, a <code class="classname">ConstraintDeclarationException</code> is raised.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1731"/>3.1.2. Return value constraints</h3></div></div></div><p>The postconditions of a method or constructor are declared by adding constraint annotations to the executable as shown in <a class="xref" href="#example-declaring-return-value-constraints" title="例 3.4. Declaring method and constructor return value constraints">例 3.4 “Declaring method and constructor return value constraints”</a>.</p><div class="example"><a id="example-declaring-return-value-constraints"/><p class="title"><b>例 3.4. Declaring method and constructor return value constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">returnvalue</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ValidRentalStation</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Customer</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getCustomers</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The following constraints apply to the executables of <code class="classname">RentalStation</code>:</p><div class="itemizedlist"><ul><li><p>Any newly created <code class="classname">RentalStation</code> object must satisfy the <code class="classname">@ValidRentalStation</code> constraint</p></li><li><p>The customer list returned by <code class="methodname">getCustomers()</code> must not be <code class="literal">null</code> and must contain at least on element</p></li></ul></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1767"/>3.1.3. Cascaded validation</h3></div></div></div><p>Similar to the cascaded validation of JavaBeans properties (see <a class="xref" href="#section-object-graph-validation" title="2.1.5. Object graphs">第 2.1.5 节 “Object graphs”</a>), the <code class="classname">@Valid</code> annotation can be used to mark executable parameters and return values for cascaded validation. When validating a parameter or return value annotated with <code class="classname">@Valid</code>, the constraints declared on the parameter or return value object are validated as well.</p><p>In <a class="xref" href="#example-cascaded-executable-validation" title="例 3.5. Marking executable parameters and return values for cascaded validation">例 3.5 “Marking executable parameters and return values for cascaded validation”</a>, the <code class="varname">car</code> parameter of the method <code class="methodname">Garage#checkCar()</code> as well as the return value of the <code class="classname">Garage</code> constructor are marked for cascaded validation.</p><div class="example"><a id="example-cascaded-executable-validation"/><p class="title"><b>例 3.5. Marking executable parameters and return values for cascaded validation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cascaded</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Garage</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Garage</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;checkCar</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Valid</span><span class="java_plain">&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cascaded</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>When validating the arguments of the <code class="methodname">checkCar()</code> method, the constraints on the properties of the passed <code class="classname">Car</code> object are evaluated as well. Similarly, the <code class="classname">@NotNull</code> constraint on the <code class="varname">name</code> field of <code class="classname">Garage</code> is checked when validating the return value of the <code class="classname">Garage</code> constructor.</p><p>Generally, the cascaded validation works for executables in exactly the same way as it does for JavaBeans properties.</p><p>In particular, <code class="literal">null</code> values are ignored during cascaded validation (naturally this can't happen during constructor return value validation) and cascaded validation is performed recursively, i.e. if a parameter or return value object which is marked for cascaded validation itself has properties marked with <code class="classname">@Valid</code>, the constraints declared on the referenced elements will be validated as well.</p><p>Cascaded validation can not only be applied to simple object references but also to collection-typed parameters and return values. This means when putting the <code class="classname">@Valid</code> annotation to a parameter or return value which</p><div class="itemizedlist"><ul><li><p>is an array</p></li><li><p>implements <code class="classname">java.lang.Iterable</code></p></li><li><p>or implements <code class="classname">java.util.Map</code></p></li></ul></div><p>each contained element gets validated. So when validating the arguments of the <code class="methodname">checkCars()</code> method in <a class="xref" href="#example-cascaded-executable-validation-listtyped" title="例 3.6. List-typed method parameter marked for cascaded validation">例 3.6 “List-typed method parameter marked for cascaded validation”</a>, each element instance of the passed list will be validated and a <code class="classname">ConstraintViolation</code> created when any of the contained <code class="classname">Car</code> objects is invalid.</p><div class="example"><a id="example-cascaded-executable-validation-listtyped"/><p class="title"><b>例 3.6. List-typed method parameter marked for cascaded validation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cascaded</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">collection</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Garage</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;checkCars</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Valid</span><span class="java_plain">&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;cars</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1867"/>3.1.4. Method constraints in inheritance hierarchies</h3></div></div></div><p>When declaring method constraints in inheritance hierarchies, it is important to be aware of the following rules:</p><div class="itemizedlist"><ul><li><p>The preconditions to be satisified by the caller of a method may not be strengthened in subtypes</p></li><li><p>The postconditions guaranteed to the caller of a method may not be weakened in subtypes</p></li></ul></div><p>These rules are motivated by the concept of <span class="emphasis"><em>behavioral subtyping</em></span> which requires that wherever a type <code class="classname">T</code> is used, also a subtype <code class="classname">S</code> of <code class="classname">T</code> may be used without altering the program's behavior.</p><p>As an example, consider a class invoking a method on an object with the static type <code class="classname">T</code>. If the runtime type of that object was <code class="classname">S</code> and <code class="classname">S</code> imposed additional preconditions, the client class might fail to satisfy these preconditions as is not aware of them. The rules of behavioral subtyping are also known as the <a class="ulink" href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution principle</a>.</p><p>The Bean Validation specification implements the first rule by disallowing parameter constraints on methods which override or implement a method declared in a supertype (superclass or interface). <a class="xref" href="#example-illegal-parameter-constraints" title="例 3.7. Illegal method parameter constraint in subtype">例 3.7 “Illegal method parameter constraint in subtype”</a> shows a violation of this rule.</p><div class="example"><a id="example-illegal-parameter-constraints"/><p class="title"><b>例 3.7. Illegal method parameter constraint in subtype</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">parameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;drive</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Max</span><span class="java_separator">(</span><span class="java_literal">75</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;speedInMph</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">parameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;drive</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Max</span><span class="java_separator">(</span><span class="java_literal">55</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;speedInMph</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The <code class="classname">@Max</code> constraint on <code class="methodname">Car#drive()</code> is illegal since this method implements the interface method <code class="methodname">Vehicle#drive()</code>. Note that parameter constraints on overriding methods are also disallowed, if the supertype method itself doesn't declare any parameter constraints.</p><p>Furthermore, if a method overrides or implements a method declared in several parallel supertypes (e.g. two interfaces not extending each other or a class and an interface not implemented by that class), no parameter constraints may be specified for the method in any of the involved types. The types in <a class="xref" href="#example-illegal-parameter-constraints-parallel-types" title="例 3.8. Illegal method parameter constraint in parallel types of a hierarchy">例 3.8 “Illegal method parameter constraint in parallel types of a hierarchy”</a> demonstrate a violation of that rule. The method <code class="methodname">RacingCar#drive()</code> overrides <code class="methodname">Vehicle#drive()</code> as well as <code class="methodname">Car#drive()</code>. Therefore the constraint on <code class="methodname">Vehicle#drive()</code> is illegal.</p><div class="example"><a id="example-illegal-parameter-constraints-parallel-types"/><p class="title"><b>例 3.8. Illegal method parameter constraint in parallel types of a hierarchy</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">parallel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;drive</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Max</span><span class="java_separator">(</span><span class="java_literal">75</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;speedInMph</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">parallel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;drive</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;speedInMph</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">parallel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RacingCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;drive</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;speedInMph</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The previously described restrictions only apply to parameter constraints. In contrast, return value constraints may be added in methods overriding or implementing any supertype methods.</p><p>In this case, all the method's return value constraints apply for the subtype method, i.e. the constraints declared on the subtype method itself as well as any return value constraints on overridden/implemented supertype methods. This is legal as putting additional return value constraints in place may never represent a weakening of the postconditions guaranteed to the caller of a method.</p><p>So when validating the return value of the method <code class="methodname">Car#getPassengers()</code> shown in <a class="xref" href="#example-return-value-constraints-in-hierarchy" title="例 3.9. Return value constraints on supertype and subtype method">例 3.9 “Return value constraints on supertype and subtype method”</a>, the <code class="classname">@Size</code> constraint on the method itself as well as the <code class="classname">@NotNull</code> constraint on the implemented interface method <code class="methodname">Vehicle#getPassengers()</code> apply.</p><div class="example"><a id="example-return-value-constraints-in-hierarchy"/><p class="title"><b>例 3.9. Return value constraints on supertype and subtype method</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">returnvalue</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getPassengers</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">inheritance</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">returnvalue</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getPassengers</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>If the validation engine detects a violation of any of the aforementioned rules, a <code class="classname">ConstraintDeclarationException</code> will be raised.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>The rules described in this section only apply to methods but not constructors. By definition, constructors never override supertype constructors. Therefore, when validating the parameters or the return value of a constructor invocation only the constraints declared on the constructor itself apply, but never any constraints declared on supertype constructors.</p></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-validating-executable-constraints"/>3.2. Validating method constraints</h2></div></div></div><p>The validation of method constraints is done using the <code class="classname">ExecutableValidator</code> interface.</p><p>In <a class="xref" href="#section-obtaining-executable-validator" title="3.2.1. Obtaining an ExecutableValidator instance">第 3.2.1 节 “Obtaining an ExecutableValidator instance”</a> you will learn how to obtain an <code class="classname">ExecutableValidator</code> instance while <a class="xref" href="#section-executable-validator-methods" title="3.2.2. ExecutableValidator methods">第 3.2.2 节 “ExecutableValidator methods”</a> shows how to use the different methods offered by this interface.</p><p>Instead of calling the ExecutableValidator methods directly from within application code, they are usually invoked via a method interception technology such as AOP, proxy objects, etc. This causes executable constraints to be validated automatically and transparently upon method or constructor invocation. Typically a <code class="classname">ConstraintViolationException</code> is raised by the integration layer in case any of the constraints is violated.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-obtaining-executable-validator"/>3.2.1. Obtaining an <code class="classname">ExecutableValidator</code> instance</h3></div></div></div><p>You can retrieve an <code class="classname">ExecutableValidator</code> instance via <code class="classname">Validator#forExecutables()</code> as shown in <a class="xref" href="#example-obtaining-executable-validator" title="例 3.10. Obtaining an ExecutableValidator">例 3.10 “Obtaining an ExecutableValidator”</a>.</p><div class="example"><a id="example-obtaining-executable-validator"/><p class="title"><b>例 3.10. Obtaining an ExecutableValidator</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">executableValidator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">().</span><span class="java_plain">forExecutables</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>In the example the executable validator is retrieved from the default validator factory, but if required you could also bootstrap a specifically configured factory as described in <a class="xref" href="#chapter-bootstrapping" title="第 8 章 Bootstrapping">第 8 章 <i>Bootstrapping</i></a>, for instance in order to use a specific parameter name provider (see <a class="xref" href="#section-parameter-name-provider" title="8.2.4. ParameterNameProvider">第 8.2.4 节 “ParameterNameProvider”</a>).</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-executable-validator-methods"/>3.2.2. <code class="classname">ExecutableValidator</code> methods</h3></div></div></div><p>The <code class="classname">ExecutableValidator</code> interface offers altogether four methods:</p><div class="itemizedlist"><ul><li><p><code class="methodname">validateParameters()</code> and <code class="methodname">validateReturnValue()</code> for method validation</p></li><li><p><code class="methodname">validateConstructorParameters()</code> and <code class="methodname">validateConstructorReturnValue()</code> for constructor validation</p></li></ul></div><p>Just as the methods on <code class="classname">Validator</code>, all these methods return a <code class="classname">Set&lt;ConstraintViolation&gt;</code> which contains a <code class="classname">ConstraintViolation</code> instance for each violated constraint and which is empty if the validation succeeds. Also all the methods have a var-args <code class="varname">groups</code> parameter by which you can pass the validation groups to be considered for validation.</p><p>The examples in the following sections are based on the methods on constructors of the <code class="classname">Car</code> class shown in <a class="xref" href="#example-executable-validator-class-car" title="例 3.11. Class Car with constrained methods and constructors">例 3.11 “Class Car with constrained methods and constructors”</a>.</p><div class="example"><a id="example-executable-validator-class-car"/><p class="title"><b>例 3.11. Class <code class="classname">Car</code> with constrained methods and constructors</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter03</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validation</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ValidRacingCar</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;team</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;drive</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Max</span><span class="java_separator">(</span><span class="java_literal">75</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;speedInMph</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Passenger</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getPassengers</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e2094"/>3.2.2.1. <code class="methodname">ExecutableValidator#validateParameters()</code></h4></div></div></div><p>The method <code class="methodname">validateParameters()</code> is used to validate the arguments of a method invocation. <a class="xref" href="#example-executable-validator-validate-parameters" title="例 3.12. Using ExecutableValidator#validateParameters()">例 3.12 “Using ExecutableValidator#validateParameters()”</a> shows an example. The validation results in a violation of the <code class="classname">@Max</code> constraint on the parameter of the <code class="methodname">drive()</code> method.</p><div class="example"><a id="example-executable-validator-validate-parameters"/><p class="title"><b>例 3.12. Using <code class="methodname">ExecutableValidator#validateParameters()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;object&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;Morris&quot;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Method</span><span class="java_plain">&nbsp;method&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">.</span><span class="java_plain">getMethod</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;drive&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;parameterValues&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_literal">80</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;violations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;executableValidator</span><span class="java_separator">.</span><span class="java_plain">validateParameters</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameterValues</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Annotation</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptor</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getAnnotation</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">annotationType</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Max</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>Note that <code class="methodname">validateParameters()</code> validates all the parameter constraints of a method, i.e. constraints on individual parameters as well as cross-parameter constraints.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e2123"/>3.2.2.2. <code class="methodname">ExecutableValidator#validateReturnValue()</code></h4></div></div></div><p>Using <code class="methodname">validateReturnValue()</code> the return value of a method can can be validated. The validation in <a class="xref" href="#example-executable-validator-validate-return-value" title="例 3.13. Using ExecutableValidator#validateReturnValue()">例 3.13 “Using ExecutableValidator#validateReturnValue()”</a> yields one constraint violation since the <code class="methodname">getPassengers()</code> method is expect to return at least one <code class="classname">Passenger</code> object.</p><div class="example"><a id="example-executable-validator-validate-return-value"/><p class="title"><b>例 3.13. Using <code class="methodname">ExecutableValidator#validateReturnValue()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;object&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;Morris&quot;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Method</span><span class="java_plain">&nbsp;method&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">.</span><span class="java_plain">getMethod</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;getPassengers&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Object</span><span class="java_plain">&nbsp;returnValue&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Collections</span><span class="java_separator">.</span><span class="java_operator">&lt;</span><span class="java_type">Passenger</span><span class="java_operator">&gt;</span><span class="java_plain">emptyList</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;violations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;executableValidator</span><span class="java_separator">.</span><span class="java_plain">validateReturnValue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returnValue</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Annotation</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptor</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getAnnotation</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">annotationType</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Size</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e2147"/>3.2.2.3. <code class="methodname">ExecutableValidator#validateConstructorParameters()</code></h4></div></div></div><p>The arguments of constructor invocations can be validated with <code class="methodname">validateConstructorParameters()</code> as shown in method <a class="xref" href="#example-executable-validator-validate-constructor-parameters" title="例 3.14. Using ExecutableValidator#validateConstructorParameters()">例 3.14 “Using ExecutableValidator#validateConstructorParameters()”</a>. Due to the <code class="classname">@NotNull</code> constraint on the <code class="varname">manufacturer</code> parameter, the validation call returns one constraint violation.</p><div class="example"><a id="example-executable-validator-validate-constructor-parameters"/><p class="title"><b>例 3.14. Using <code class="methodname">ExecutableValidator#validateConstructorParameters()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Constructor</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_operator">&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;constructor&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getConstructor</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">String</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;parameterValues&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;violations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;executableValidator</span><span class="java_separator">.</span><span class="java_plain">validateConstructorParameters</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructor</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameterValues</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Annotation</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptor</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getAnnotation</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">annotationType</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNull</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e2171"/>3.2.2.4. <code class="methodname">ExecutableValidator#validateConstructorReturnValue()</code></h4></div></div></div><p>Finally, by using <code class="methodname">validateConstructorReturnValue()</code> you can valide a constructor's return value. In <a class="xref" href="#example-executable-validator-validate-constructor-return-value" title="例 3.15. Using ExecutableValidator#validateConstructorReturnValue()">例 3.15 “Using ExecutableValidator#validateConstructorReturnValue()”</a>, <code class="methodname">validateConstructorReturnValue()</code> returns one constraint violation, since the <code class="classname">Car</code> object returned by the constructor doesn't satisfy the <code class="classname">@ValidRacingCar</code> constraint (not shown).</p><div class="example"><a id="example-executable-validator-validate-constructor-return-value"/><p class="title"><b>例 3.15. Using <code class="methodname">ExecutableValidator#validateConstructorReturnValue()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">constructor&nbsp;</span><!-- <br/> --><span class="java_keyword">for</span><!-- <br/> --><span class="java_plain">&nbsp;creating&nbsp;racing&nbsp;cars</span>
<!--  --><br/><span class="java_type">Constructor</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;constructor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">.</span><span class="java_plain">getConstructor</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;createdObject&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;violations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;executableValidator</span><span class="java_separator">.</span><span class="java_plain">validateConstructorReturnValue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructor</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;createdObject</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Annotation</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptor</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getAnnotation</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">annotationType</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidRacingCar</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintType&nbsp;</span><span class="java_separator">);</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e2198"/>3.2.3. <code class="classname">ConstraintViolation</code> methods for method validation</h3></div></div></div><p>In addition to the methods introduced in <a class="xref" href="#section-constraint-violation-methods" title="2.2.3. ConstraintViolation methods">第 2.2.3 节 “ConstraintViolation methods”</a>, <code class="classname">ConstraintViolation</code> provides two more methods specific to the validation of executable parameters and return values.</p><p><code class="methodname">ConstraintViolation#getExecutableParameters()</code> returns the validated parameter array in case of method or constructor parameter validation, while <code class="methodname">ConstraintViolation#getExecutableReturnValue()</code> provides access to the validated object in case of return value validation.</p><p>All the other <code class="classname">ConstraintViolation</code> methods generally work for method validation in the same way as for validation of beans. Refer to the <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/BeanDescriptor.html">JavaDoc</a> to learn more about the behavior of the individual methods and their return values during bean and method validation.</p><p>Note that <code class="methodname">getPropertyPath()</code> can be very useful in order to obtain detailed information about the validated parameter or return value, e.g. for logging purposes. In particular, you can retrieve name and argument types of the concerned method as well as the index of the concerned parameter from the path nodes. How this can be done is shown in <a class="xref" href="#example-executable-validation-property-path" title="例 3.16. Retrieving method and parameter information">例 3.16 “Retrieving method and parameter information”</a>.</p><div class="example"><a id="example-executable-validation-property-path"/><p class="title"><b>例 3.16. Retrieving method and parameter information</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;object&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;Morris&quot;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Method</span><span class="java_plain">&nbsp;method&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">.</span><span class="java_plain">getMethod</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;drive&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;parameterValues&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_literal">80</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;violations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;executableValidator</span><span class="java_separator">.</span><span class="java_plain">validateParameters</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameterValues</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Iterator</span><span class="java_operator">&lt;</span><span class="java_type">Node</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;propertyPath&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;violations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getPropertyPath</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">MethodNode</span><span class="java_plain">&nbsp;methodNode&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;propertyPath</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">as</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">MethodNode</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;drive&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;methodNode</span><span class="java_separator">.</span><span class="java_plain">getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Arrays</span><span class="java_separator">.</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">asList</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span><span class="java_plain">&nbsp;methodNode</span><span class="java_separator">.</span><span class="java_plain">getParameterTypes</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">ParameterNode</span><span class="java_plain">&nbsp;parameterNode&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;propertyPath</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">as</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">ParameterNode</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;arg0&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;parameterNode</span><span class="java_separator">.</span><span class="java_plain">getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;parameterNode</span><span class="java_separator">.</span><span class="java_plain">getParameterIndex</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre></div></div><br class="example-break"/><p>The parameter name is determined using the current <code class="classname">ParameterNameProvider</code> (see <a class="xref" href="#section-parameter-name-provider" title="8.2.4. ParameterNameProvider">第 8.2.4 节 “ParameterNameProvider”</a>) and defaults to <code class="literal">arg0</code>, <code class="literal">arg1</code> etc.</p></div></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-message-interpolation"/>第 4 章 Interpolating constraint error messages</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#section-message-interpolation">4.1. Default message interpolation</a></span></dt><dd><dl><dt><span class="section"><a href="#section-special-characters">4.1.1. Special characters</a></span></dt><dt><span class="section"><a href="#section-interpolation-with-message-expressions">4.1.2. Interpolation with message expressions</a></span></dt><dt><span class="section"><a href="#d0e2410">4.1.3. Examples</a></span></dt></dl></dd><dt><span class="section"><a href="#section-custom-message-interpolation">4.2. Custom message interpolation</a></span></dt><dd><dl><dt><span class="section"><a href="#section-resource-bundle-locator">4.2.1. ResourceBundleLocator</a></span></dt></dl></dd></dl></div><p>Message interpolation is the process of creating error messages for violated Bean Validation constraints. In this chapter you will learn how such messages are defined and resolved and how you can plug in custom message interpolators in case the default algorithm is not sufficient for your requirements.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-message-interpolation"/>4.1. Default message interpolation</h2></div></div></div><p>Constraint violation messages are retrieved from so called message descriptors. Each constraint defines its default message descriptor using the <code class="methodname">message</code> attribute. At declaration time, the default descriptor can be overridden with a specific value as shown in <a class="xref" href="#example-overriding-message" title="例 4.1. Specifying a message descriptor using the message attribute">例 4.1 “Specifying a message descriptor using the message attribute”</a>.</p><div class="example"><a id="example-overriding-message"/><p class="title"><b>例 4.1. Specifying a message descriptor using the <code class="methodname">message</code> attribute</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter04</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;manufacturer&nbsp;name&nbsp;must&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">constructor</span><span class="java_separator">,</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>If a constraint is violated, its descriptor will be interpolated by the validation engine using the currently configured <code class="classname">MessageInterpolator</code>. The interpolated error message can then be retrieved from the resulting constraint violation by calling <code class="methodname">ConstraintViolation#getMessage()</code>.</p><p>Message descriptors can contain <span class="emphasis"><em>message parameters</em></span> as well as <span class="emphasis"><em>message expressions</em></span> which will be resolved during interpolation. Message parameters are string literals enclosed in <code class="literal">{}</code>, while message expressions are string literals enclosed in <code class="literal">${}</code>. The following algorithm is applied during method interpolation:</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li><p>Resolve any message parameters by using them as key for the resource bundle <code class="filename">ValidationMessages</code>. If this bundle contains an entry for a given message parameter, that parameter will be replaced in the message with the corresponding value from the bundle. This step will be executed recursively in case the replaced value again contains message parameters. The resource bundle is expected to be provided by the application developer, e.g. by adding a file named <code class="filename">ValidationMessages.properties</code> to the classpath. You can also create localized error messages by providing locale specific variations of this bundle, such as <code class="filename">ValidationMessages_en_US.properties</code>. By default, the JVM's default locale (<code class="methodname">Locale#getDefault()</code>) will be used when looking up messages in the bundle.</p></li><li><p>Resolve any message parameters by using them as key for a resource bundle containing the standard error messages for the built-in constraints as defined in Appendix B of the Bean Validation specification. In the case of Hibernate Validator, this bundle is named <code class="classname">org.hibernate.validator.ValidationMessages</code>. If this step triggers a replacement, step 1 is executed again, otherwise step 3 is applied.</p></li><li><p>Resolve any message parameters by replacing them with the value of the constraint annotation member of the same name. This allows to refer to attribute values of the constraint (e.g. <code class="methodname">Size#min()</code>) in the error message (e.g. "must be at least ${min}").</p></li><li><p>Resolve any message expressions by evaluating them as expressions of the Unified Expression Language. See <a class="xref" href="#section-interpolation-with-message-expressions" title="4.1.2. Interpolation with message expressions">第 4.1.2 节 “Interpolation with message expressions”</a> to learn more about the usage of Unified EL in error messages.</p></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>You can find the formal definition of the interpolation algorithm in section <a class="ulink" href="http://beanvalidation.org/1.1/spec/#default-resolution-algorithm">5.3.1.1</a> of the Bean Validation specification.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-special-characters"/>4.1.1. Special characters</h3></div></div></div><p>Since the characters <code class="literal">{</code>, <code class="literal">}</code> and <code class="literal">$</code> have a special meaning in message descriptors they need to be escaped if you want to use them literally. The following rules apply:</p><div class="itemizedlist"><ul><li><p><code class="literal"><code class="literal">\{</code></code> is considered as the literal <code class="literal">{</code></p></li><li><p><code class="literal">\}</code> is considered as the literal <code class="literal">}</code></p></li><li><p><code class="literal">\$</code> is considered as the literal <code class="literal">$</code></p></li><li><p><code class="literal">\\</code> is considered as the literal <code class="literal">\</code></p></li></ul></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-interpolation-with-message-expressions"/>4.1.2. Interpolation with message expressions</h3></div></div></div><p>As of Hibernate Validator 5 (Bean Validation 1.1) it is possible to use the Unified Expression Language (as defined by <a class="ulink" href="http://jcp.org/en/jsr/detail?id=341">JSR 341</a>) in constraint violation messages. This allows to define error messages based on conditional logic and also enables advanced formatting options. The validation engine makes the following objects available in the EL context:</p><div class="itemizedlist"><ul><li><p>the attribute values of the constraint mapped to the attribute names</p></li><li><p>the currently validated value (property, bean, method parameter etc.) under the name <code class="varname">validatedValue</code></p></li><li><p>a bean mapped to the name <code class="varname">formatter</code> exposing the var-arg method <code class="methodname">format(String format, Object... args)</code> which behaves like <code class="methodname">java.util.Formatter.format(String format, Object... args)</code>.</p></li></ul></div><p>The following section provides several examples for using EL expressions in error messages.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e2410"/>4.1.3. Examples</h3></div></div></div><p><a class="xref" href="#example-message-descriptors" title="例 4.2. Specifying message descriptors">例 4.2 “Specifying message descriptors”</a> shows how to make use of the different options for specifying message descriptors.</p><div class="example"><a id="example-message-descriptors"/><p class="title"><b>例 4.2. Specifying message descriptors</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter04</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">complete</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;license&nbsp;plate&nbsp;must&nbsp;be&nbsp;between&nbsp;{min}&nbsp;and&nbsp;{max}&nbsp;characters&nbsp;long&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;{value}&nbsp;seat${value&nbsp;&gt;&nbsp;1&nbsp;?&nbsp;'s'&nbsp;:&nbsp;''}&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">DecimalMax</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;350&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;top&nbsp;speed&nbsp;${formatter.format('%1$.2f',&nbsp;validatedValue)}&nbsp;is&nbsp;higher&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;than&nbsp;{value}&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">double</span><span class="java_plain">&nbsp;topSpeed</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">DecimalMax</span><span class="java_separator">(</span><span class="java_plain">value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;100000&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Price&nbsp;must&nbsp;not&nbsp;be&nbsp;higher&nbsp;than&nbsp;${value}&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">BigDecimal</span><span class="java_plain">&nbsp;price</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">double</span><span class="java_plain">&nbsp;topSpeed</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">BigDecimal</span><span class="java_plain">&nbsp;price</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">topSpeed&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;topSpeed</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">price&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;price</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Validating an invalid <code class="classname">Car</code> instance yields constraint violations with the messages shown by the assertions in <a class="xref" href="#example-expected-error-messages" title="例 4.3. Expected error messages">例 4.3 “Expected error messages”</a>:</p><div class="itemizedlist"><ul><li><p>the <code class="classname">@NotNull</code> constraint on the <code class="varname">manufacturer</code> field causes the error message "may not be null", as this is the default message defined by the Bean Validation specification and no specific descriptor is given in the <code class="methodname">message</code> attribute</p></li><li><p>the <code class="classname">@Size</code> constraint on the <code class="varname">licensePlate</code> field shows the interpolation of message parameters (<code class="literal">{min}</code>, <code class="literal">{max}</code>)</p></li><li><p>the <code class="classname">@Min</code> constraint on <code class="varname">seatCount</code> demonstrates how use an EL expression with a ternery expression to dynamically chose singular or plural form, depending on an attribute of the constraint ("There must be at least 1 seat" vs. "There must be at least 2 seats")</p></li><li><p>the message for the <code class="classname">@DecimalMax</code> constraint on <code class="varname">topSpeed</code> shows how to refer to the validated object in the error message and format it using the <code class="varname">formatter</code> object</p></li><li><p>finally, the <code class="classname">@DecimalMax</code> constraint on <code class="varname">price</code> shows that parameter interpolation has precedence over expression evaluation, causing the <code class="literal">$</code> sign to show up in front of the maximum price</p></li></ul></div><div class="example"><a id="example-expected-error-messages"/><p class="title"><b>例 4.3. Expected error messages</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;car&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">null</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;A&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">1</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">400.123456</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">BigDecimal</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">valueOf</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">200000</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">String</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;The&nbsp;license&nbsp;plate&nbsp;must&nbsp;be&nbsp;between&nbsp;2&nbsp;and&nbsp;14&nbsp;characters&nbsp;long&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;seatCount&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;seats&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;topSpeed&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;top&nbsp;speed&nbsp;400.12&nbsp;is&nbsp;higher&nbsp;than&nbsp;350&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;price&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Price&nbsp;must&nbsp;not&nbsp;be&nbsp;higher&nbsp;than&nbsp;$100000&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-custom-message-interpolation"/>4.2. Custom message interpolation</h2></div></div></div><p>If the default message interpolation algorithm does not fit your requirements it is also possible to plug in a custom <code class="classname">MessageInterpolator</code> implementation.</p><p>Custom interpolators must implement the interface <code class="classname">javax.validation.MessageInterpolator</code>. Note that implementations must be thread-safe. It is recommended that custom message interpolators delegate final implementation to the default interpolator, which can be obtained via <code class="methodname">Configuration#getDefaultMessageInterpolator()</code>.</p><p>In order to use a custom message interpolator it must be registered either by configuring it in the Bean Validation XML descriptor <code class="filename">META-INF/validation.xml</code> (see <a class="xref" href="#section-configuration-validation-xml" title="7.1. Configuring the validator factory in validation.xml">第 7.1 节 “Configuring the validator factory in validation.xml”</a>) or by passing it when bootstrapping a <code class="classname">ValidatorFactory</code> or <code class="classname">Validator</code> (see <a class="xref" href="#section-validator-factory-message-interpolator" title="8.2.1. MessageInterpolator">第 8.2.1 节 “MessageInterpolator”</a> and <a class="xref" href="#section-configuring-validator" title="8.3. Configuring a Validator">第 8.3 节 “Configuring a Validator”</a>, respectively).</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-resource-bundle-locator"/>4.2.1. <code class="classname">ResourceBundleLocator</code></h3></div></div></div><p>In some use cases you want to use the message interpolation algorithm as defined by the Bean Validation specification, but retrieve error messages from other resource bundles than <code class="filename">ValidationMessages</code>. In this situation Hibernate Validator's <code class="classname">ResourceBundleLocator</code> SPI can help.</p><p>The default message interpolator in Hibernate Validator, <code class="classname">ResourceBundleMessageInterpolator</code>, delegates retrieval of resource bundles to that SPI. Using an alternative bundle only requires passing an instance of <code class="classname">PlatformResourceBundleLocator</code> with the bundle name when bootstrapping the <code class="classname">ValidatorFactory</code> as shown in <a class="xref" href="#example-using-specific-resource-bundle-locator" title="例 4.4. Using a specific resource bundle">例 4.4 “Using a specific resource bundle”</a>.</p><div class="example"><a id="example-using-specific-resource-bundle-locator"/><p class="title"><b>例 4.4. Using a specific resource bundle</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceBundleMessageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">PlatformResourceBundleLocator</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;MyMessages&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Of course you also could implement a completely different <code class="classname">ResourceBundleLocator</code>, which for instance returns bundles backed by records in a database. In this case you can obtain the default locator via <code class="classname">HibernateValidatorConfiguration#getDefaultResourceBundleLocator()</code>, which you e.g. could use as fallback for your custom locator.</p><p>Besides <code class="classname">PlatformResourceBundleLocator</code>, Hibernate Validator provides another resource bundle locator implementation out of the box, namely <code class="classname">AggregateResourceBundleLocator</code>, which allows to retrieve error messages from more than one resource bundle. You could for instance use this implementation in a multi-module application where you want to have one message bundle per module. <a class="xref" href="#example-using-aggregate-resource-bundle-locator" title="例 4.5. Using AggregateResourceBundleLocator">例 4.5 “Using AggregateResourceBundleLocator”</a> shows how to use <code class="classname">AggregateResourceBundleLocator</code>.</p><div class="example"><a id="example-using-aggregate-resource-bundle-locator"/><p class="title"><b>例 4.5. Using <code class="classname">AggregateResourceBundleLocator</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceBundleMessageInterpolator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">AggregateResourceBundleLocator</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Arrays</span><span class="java_separator">.</span><span class="java_plain">asList</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;MyMessages&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;MyOtherMessages&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Note that the bundles are processed in the order as passed to the constructor. That means if several bundles contain an entry for a given message key, the value will be taken from the first bundle in the list containing the key.</p></div></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-groups"/>第 5 章 Grouping constraints</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#d0e2602">5.1. Requesting groups</a></span></dt><dt><span class="section"><a href="#section-defining-group-sequences">5.2. Defining group sequences</a></span></dt><dt><span class="section"><a href="#section-default-group-class">5.3. Redefining the default group sequence</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e2811">5.3.1. @GroupSequence</a></span></dt><dt><span class="section"><a href="#d0e2893">5.3.2. @GroupSequenceProvider</a></span></dt></dl></dd><dt><span class="section"><a href="#section-group-conversion">5.4. Group conversion</a></span></dt></dl></div><p>All validation methods on <code class="classname">Validator</code> and <code class="classname">ExecutableValidator</code> discussed in earlier chapters also take a var-arg argument <em class="parameter"><code>groups</code></em>. So far we have been ignoring this parameter, but it is time to have a closer look.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e2602"/>5.1. Requesting groups</h2></div></div></div><p>Groups allow you to restrict the set of constraints applied during validation. One use case for validation groups are UI wizards where in each step only a specified subset of constraints should get validated. The groups targeted are passed as var-arg parameters to the appropriate validate method.</p><p>Let's have a look at an example. The class <code class="classname">Person</code> in <a class="xref" href="#example-person" title="例 5.1. Person">例 5.1 “Person”</a> has a <code class="classname">@NotNull </code>constraint on <span class="property">name</span>. Since no group is specified for this annotation the default group <code class="classname">javax.validation.groups.Default</code> is assumed.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>When more than one group is requested, the order in which the groups are evaluated is not deterministic. If no group is specified the default group <code class="classname">javax.validation.groups.Default</code> is assumed.</p></div><div class="example"><a id="example-person"/><p class="title"><b>例 5.1. Person</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The class <code class="classname">Driver</code> in <a class="xref" href="#example-driver" title="例 5.2. Driver">例 5.2 “Driver”</a> extends <code class="classname">Person</code> and adds the properties <span class="property">age</span> and <span class="property">hasDrivingLicense</span>. Drivers must be at least 18 years old (<code class="classname">@Min(18)</code>) and have a driving license (<code class="classname">@AssertTrue</code>). Both constraints defined on these properties belong to the group <code class="classname">DriverChecks</code> which is just a simple tagging interface.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>Using interfaces makes the usage of groups type-safe and allows for easy refactoring. It also means that groups can inherit from each other via class inheritance.</p></div><div class="example"><a id="example-driver"/><p class="title"><b>例 5.2. Driver</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;have&nbsp;to&nbsp;be&nbsp;18&nbsp;to&nbsp;drive&nbsp;a&nbsp;car&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;first&nbsp;have&nbsp;to&nbsp;pass&nbsp;the&nbsp;driving&nbsp;test&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;hasDrivingLicense</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;passedDrivingTest</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;b</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hasDrivingLicense&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;b</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;getAge</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setAge</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;age</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">age&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Finally the class Car (<a class="xref" href="#example-car" title="例 5.3. Car">例 5.3 “Car”</a>) has some constraints which are part of the default group as well as <code class="classname">@AssertTrue</code> in the group <code class="classname">CarChecks</code> on the property <span class="property">passedVehicleInspection</span> which indicates whether a car passed the road worthy tests.</p><div class="example"><a id="example-car"/><p class="title"><b>例 5.3. Car</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;passedVehicleInspection</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Overall three different groups are used in the example:</p><div class="itemizedlist"><ul><li><p>The constraints on <span class="property">Person.name</span>, <span class="property">Car.manufacturer</span>, <span class="property">Car.licensePlate</span> and <span class="property">Car.seatCount</span> all belong to the <code class="classname">Default</code> group</p></li><li><p>The constraints on <span class="property">Driver.age</span> and <span class="property">Driver.hasDrivingLicense</span> belong to <code class="classname">DriverChecks</code></p></li><li><p>The constraint on <span class="property">Car.passedVehicleInspection</span> belongs to the group <code class="classname">CarChecks</code></p></li></ul></div><p><a class="xref" href="#example-drive-away" title="例 5.4. Using validation groups">例 5.4 “Using validation groups”</a> shows how passing different group combinations to the <code class="methodname">Validator#validate()</code> method results in different validation results.</p><div class="example"><a id="example-drive-away"/><p class="title"><b>例 5.4. Using validation groups</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;create&nbsp;a&nbsp;car&nbsp;and&nbsp;check&nbsp;that&nbsp;everything&nbsp;is&nbsp;ok&nbsp;with&nbsp;it</span><!-- <br/> --><span class="java_separator">.</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;but&nbsp;has&nbsp;it&nbsp;passed&nbsp;the&nbsp;vehicle&nbsp;inspection</span><span class="java_operator">?</span>
<!--  --><br/><span class="java_plain">constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;let's&nbsp;go&nbsp;to&nbsp;the&nbsp;vehicle&nbsp;inspection</span>
<!--  --><br/><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;now&nbsp;let's&nbsp;add&nbsp;a&nbsp;driver</span><span class="java_separator">.</span><span class="java_plain">&nbsp;</span><span class="java_type">He</span><span class="java_plain">&nbsp;is&nbsp;</span><span class="java_literal">18</span><span class="java_separator">,</span><span class="java_plain">&nbsp;but&nbsp;has&nbsp;not&nbsp;passed&nbsp;the&nbsp;driving&nbsp;test&nbsp;yet</span>
<!--  --><br/><span class="java_type">Driver</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;John&nbsp;Doe&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">john</span><span class="java_separator">.</span><span class="java_plain">setAge</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">setDriver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;You&nbsp;first&nbsp;have&nbsp;to&nbsp;pass&nbsp;the&nbsp;driving&nbsp;test&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;ok</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">John</span><span class="java_plain">&nbsp;passes&nbsp;the&nbsp;test</span>
<!--  --><br/><span class="java_plain">john</span><span class="java_separator">.</span><span class="java_plain">passedDrivingTest</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;just&nbsp;checking&nbsp;that&nbsp;everything&nbsp;is&nbsp;in&nbsp;order&nbsp;now</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;car</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>The first <code class="methodname">validate()</code> call in <a class="xref" href="#example-drive-away" title="例 5.4. Using validation groups">例 5.4 “Using validation groups”</a> is done using no explicit group. There are no validation errors, even though the property <span class="property">passedVehicleInspection</span> is per default <code class="constant">false</code>. However, the constraint defined on this property does not belong to the default group.</p><p>The next validation using the <code class="classname">CarChecks</code> group fails until the car passes the vehicle inspection. Adding a driver to the car and validating against <code class="classname">DriverChecks</code> again yields one constraint violation due to the fact that the driver has not yet passed the driving test. Only after setting <span class="property">passedDrivingTest</span> to <code class="literal">true</code> the validation against <code class="classname">DriverChecks</code> passes.</p><p>The last validate() call finally shows that all constraints are passing by validating against all defined groups.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-defining-group-sequences"/>5.2. Defining group sequences</h2></div></div></div><p>By default, constraints are evaluated in no particular order, regardless of which groups they belong to. In some situations, however, it is useful to control the order constraints are evaluated.</p><p>In the example from <a class="xref" href="#example-drive-away" title="例 5.4. Using validation groups">例 5.4 “Using validation groups”</a> it could for instance be required that first all default car constraints are passing before checking the road worthiness of the car. Finally, before driving away, the actual driver constraints should be checked.</p><p>In order to implement such a validation order you just need to define an interface and annotate it with <code class="classname">@GroupSequence</code>, defining the order in which the groups have to be validated (see <a class="xref" href="#example-defining-group-sequence" title="例 5.5. Defining a group sequence">例 5.5 “Defining a group sequence”</a>). If at least one constraint fails in a sequenced group none of the constraints of the following groups in the sequence get validated.</p><div class="example"><a id="example-defining-group-sequence"/><p class="title"><b>例 5.5. Defining a group sequence</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GroupSequence</span><span class="java_separator">({</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">OrderedChecks</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>Groups defining a sequence and groups composing a sequence must not be involved in a cyclic dependency either directly or indirectly, either through cascaded sequence definition or group inheritance. If a group containing such a circularity is evaluated, a <code class="classname">GroupDefinitionException</code> is raised.</p></div><p>You then can use the new sequence as shown in in <a class="xref" href="#example-group-sequence" title="例 5.6. Using a group sequence">例 5.6 “Using a group sequence”</a>.</p><div class="example"><a id="example-group-sequence"/><p class="title"><b>例 5.6. Using a group sequence</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;car&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;Morris&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;DD-AB-123&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">2</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Driver</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;John&nbsp;Doe&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">john</span><span class="java_separator">.</span><span class="java_plain">setAge</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">john</span><span class="java_separator">.</span><span class="java_plain">passedDrivingTest</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">setDriver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">OrderedChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-default-group-class"/>5.3. Redefining the default group sequence</h2></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e2811"/>5.3.1. <code class="classname">@GroupSequence</code></h3></div></div></div><p>Besides defining group sequences, the <code class="classname">@GroupSequence</code> annotation also allows to redefine the default group for a given class. To do so, just add the <code class="classname">@GroupSequence</code> annotation to the class and specify the sequence of groups which substitute <code class="classname">Default</code> for this class within the annotation.</p><p><a class="xref" href="#example-rental-car" title="例 5.7. Class RentalCar with redefined default group">例 5.7 “Class RentalCar with redefined default group”</a> introduces a new class <code class="classname">RentalCar</code> with a redefined default group.</p><div class="example"><a id="example-rental-car"/><p class="title"><b>例 5.7. Class <code class="classname">RentalCar</code> with redefined default group</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GroupSequence</span><span class="java_separator">({</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertFalse</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;is&nbsp;currently&nbsp;rented&nbsp;out&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;seatCount&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRented</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">rented&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalChecks</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>With this definition you can evaluate the constraints belonging to <code class="classname">RentalChecks</code>, <code class="classname">CarChecks</code> and <code class="classname">RentalCar</code> by just requesting the <code class="classname">Default</code> group as seen in <a class="xref" href="#example-testCarIsRented" title="例 5.8. Validating an object with redefined default group">例 5.8 “Validating an object with redefined default group”</a>.</p><div class="example"><a id="example-testCarIsRented"/><p class="title"><b>例 5.8. Validating an object with redefined default group</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">RentalCar</span><!-- <br/> --><span class="java_plain">&nbsp;rentalCar&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">RentalCar</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;Morris&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;DD-AB-123&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">2</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">rentalCar</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">rentalCar</span><span class="java_separator">.</span><span class="java_plain">setRented</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">RentalCar</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;rentalCar&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;Wrong&nbsp;message&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;is&nbsp;currently&nbsp;rented&nbsp;out&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">rentalCar</span><span class="java_separator">.</span><span class="java_plain">setRented</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">false</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;rentalCar&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Since there must no cyclic dependency in the group and group sequence definitions one cannot just add <code class="classname">Default</code> to the sequence redefining <code class="classname">Default</code> for a class. Instead the class itself has to be added!</p></div><p>The <code class="classname">Default</code> group sequence overriding is local to the class it is defined on and is not propagated to associated objects. For the example this means that adding <code class="classname">DriverChecks</code> to the default group sequence of <code class="classname">RentalCar</code> would not have any effects. Only the group <code class="classname">Default</code> will be propagated to the <span class="property">driver</span> association.</p><p>Note that you can control the propagated group(s) by declaring a group conversion rule (see <a class="xref" href="#section-group-conversion" title="5.4. Group conversion">第 5.4 节 “Group conversion”</a>).</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e2893"/>5.3.2. <code class="classname">@GroupSequenceProvider</code></h3></div></div></div><p>In addition to statically redefining default group sequences via <code class="classname">@GroupSequence</code>, Hibernate Validator also provides an SPI for the dynamic redefinition of default group sequences depending on the object state.</p><p>For that purpose you need to implement the interface <code class="classname">DefaultGroupSequenceProvider</code> and register this implementation with the target class via the <code class="classname">@GroupSequenceProvider</code> annotation. In the rental car scenario you could for instance dynamically add the <code class="classname">CarChecks</code> as seen in <a class="xref" href="#example-implementing-using-default-group-sequence-provider" title="例 5.9. Implementing and using a default group sequence provider">例 5.9 “Implementing and using a default group sequence provider”</a>.</p><div class="example"><a id="example-implementing-using-default-group-sequence-provider"/><p class="title"><b>例 5.9. Implementing and using a default group sequence provider</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">groupsequenceprovider</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCarGroupSequenceProvider</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">DefaultGroupSequenceProvider</span><span class="java_operator">&lt;</span><span class="java_type">RentalCar</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;getValidationGroups</span><span class="java_separator">(</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;car</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;defaultGroupSequence&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultGroupSequence</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">!=</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain">&nbsp;</span><span class="java_operator">!</span><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">isRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultGroupSequence</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;defaultGroupSequence</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">groupsequenceprovider</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GroupSequenceProvider</span><span class="java_separator">(</span><span class="java_type">RentalCarGroupSequenceProvider</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertFalse</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;is&nbsp;currently&nbsp;rented&nbsp;out&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;seatCount&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRented</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">rented&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-group-conversion"/>5.4. Group conversion</h2></div></div></div><p>What if you wanted to validate the car related checks together with the driver checks? Of course you could pass the required groups to the validate call explicitly, but what if you wanted to make these validations occur as part of the <code class="classname">Default</code> group validation? Here <code class="classname">@ConvertGroup</code> comes into play which allows you during cascaded validation to use a different group than the originally requested one.</p><p>Let's have a look at <a class="xref" href="#example-group-conversion-dedault-to-driver-checks" title="例 5.10. @ConvertGroup usage">例 5.10 “@ConvertGroup usage”</a>. Here <code class="code">@GroupSequence({ CarChecks.class, Car.class })</code> is used to combine the car related constraints under the <code class="classname">Default</code> group (see <a class="xref" href="#section-default-group-class" title="5.3. Redefining the default group sequence">第 5.3 节 “Redefining the default group sequence”</a>). There is also a <code class="code">@ConvertGroup(from = Default.class, to = DriverChecks.class)</code> which ensures the <code class="classname">Default</code> group gets converted to the <code class="classname">DriverChecks</code> group during cascaded validation of the <span class="property">driver</span> association.</p><div class="example"><a id="example-group-conversion-dedault-to-driver-checks"/><p class="title"><b>例 5.10. <code class="classname">@ConvertGroup</code> usage</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">groupconversion</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;have&nbsp;to&nbsp;be&nbsp;18&nbsp;to&nbsp;drive&nbsp;a&nbsp;car&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;first&nbsp;have&nbsp;to&nbsp;pass&nbsp;the&nbsp;driving&nbsp;test&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;hasDrivingLicense</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;passedDrivingTest</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;b</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hasDrivingLicense&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;b</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter05</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">groupconversion</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">GroupSequence</span><span class="java_separator">({</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;passedVehicleInspection</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ConvertGroup</span><span class="java_separator">(</span><span class="java_plain">from&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;to&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>As a result the validation in <a class="xref" href="#example-group-conversion-test" title="例 5.11. Test case for @ConvertGroup">例 5.11 “Test case for @ConvertGroup”</a> succeeds, even though the constraint on <span class="property">hasDrivingLicense</span> belongs to the <code class="classname">DriverChecks</code> group and only the <code class="classname">Default</code> group is requested in the <code class="methodname">validate()</code> call.</p><div class="example"><a id="example-group-conversion-test"/><p class="title"><b>例 5.11. Test case for @ConvertGroup</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;create&nbsp;a&nbsp;car&nbsp;and&nbsp;validate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">The</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Driver</span><!-- <br/> --><span class="java_plain">&nbsp;is&nbsp;still&nbsp;</span><!-- <br/> --><span class="java_literal">null</span><!-- <br/> --><span class="java_plain">&nbsp;and&nbsp;does&nbsp;not&nbsp;get&nbsp;validated</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;VW&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;USD-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">4</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;create&nbsp;a&nbsp;driver&nbsp;who&nbsp;has&nbsp;not&nbsp;passed&nbsp;the&nbsp;driving&nbsp;test</span>
<!--  --><br/><span class="java_type">Driver</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;John&nbsp;Doe&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">john</span><span class="java_separator">.</span><span class="java_plain">setAge</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;now&nbsp;let's&nbsp;add&nbsp;a&nbsp;driver&nbsp;to&nbsp;the&nbsp;car</span>
<!--  --><br/><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">setDriver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;The&nbsp;driver&nbsp;constraint&nbsp;should&nbsp;also&nbsp;be&nbsp;validated&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;default&nbsp;group&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">(),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;You&nbsp;first&nbsp;have&nbsp;to&nbsp;pass&nbsp;the&nbsp;driving&nbsp;test&quot;</span>
<!--  --><br/><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>You can define group conversions wherever <code class="classname">@Valid</code> can be used, namely associations as well as method and constructor parameters and return values. Multiple conversions can be specified using <code class="classname">@ConvertGroup.List</code>.</p><p>However, the following restrictions apply:</p><div class="itemizedlist"><ul><li><p><code class="classname">@ConvertGroup</code> must only be used in combination with <code class="classname">@Valid</code>. If used without, a <code class="classname">ConstraintDeclarationException</code> is thrown.</p></li><li><p>It is not legal to have multiple conversion rules on the same element with the same <em class="parameter"><code>from</code></em> value. In this case, a <code class="classname">ConstraintDeclarationException</code> is raised.</p></li><li><p>The <em class="parameter"><code>from</code></em> attribute must not refer to a group sequence. A <code class="classname">ConstraintDeclarationException</code> is raised in this situation.</p></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Rules are not executed recursively. The first matching conversion rule is used and subsequent rules are ignored. For example if a set of <code class="classname">@ConvertGroup</code> declarations chains group A to B and B to C, the group A will be converted to B and not to C.</p></div></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-customconstraints"/>第 6 章 Creating custom constraints</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#validator-customconstraints-simple">6.1. Creating a simple constraint</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-customconstraints-constraintannotation">6.1.1. The constraint annotation</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-validator">6.1.2. The constraint validator</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-errormessage">6.1.3. The error message</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-using">6.1.4. Using the constraint</a></span></dt></dl></dd><dt><span class="section"><a href="#section-class-level-constraints">6.2. Class-level constraints</a></span></dt><dd><dl><dt><span class="section"><a href="#section-custom-property-paths">6.2.1. Custom property paths</a></span></dt></dl></dd><dt><span class="section"><a href="#section-cross-parameter-constraints">6.3. Cross-parameter constraints</a></span></dt><dt><span class="section"><a href="#validator-customconstraints-compound">6.4. Constraint composition</a></span></dt></dl></div><p>The Bean Validation API defines a whole set of standard constraint annotations such as <code class="classname">@NotNull</code>, <code class="classname">@Size</code> etc. In cases where these buit-in constraints are not sufficient, you cean easily create custom constraints tailored to your specific validation requirements.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-customconstraints-simple"/>6.1. Creating a simple constraint</h2></div></div></div><p>To create a custom constraint, the following three steps are required:</p><div class="itemizedlist"><ul><li><p>Create a constraint annotation</p></li><li><p>Implement a validator</p></li><li><p>Define a default error message</p></li></ul></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-customconstraints-constraintannotation"/>6.1.1. The constraint annotation</h3></div></div></div><p>This section shows how to write a constraint annotation which can be used to ensure that a given string is either completely upper case or lower case. Later on this constraint will be applied to the <span class="property">licensePlate</span> field of the <code class="classname">Car</code> class from <a class="xref" href="#validator-gettingstarted" title="第 1 章 Getting started">第 1 章 <i>Getting started</i></a> to ensure, that the field is always an upper-case string.</p><p>The first thing needed is a way to express the two case modes. While you could use <code class="classname">String</code> constants, a better approach is using a Java 5 enum for that purpose:</p><div class="example"><a id="d0e3078"/><p class="title"><b>例 6.1. Enum <code class="classname">CaseMode</code> to express upper vs. lower case</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;enum&nbsp;</span><span class="java_type">CaseMode</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPPER</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOWER</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The next step is to define the actual constraint annotation. If you've never designed an annotation before, this may look a bit scary, but actually it's not that hard:</p><div class="example"><a id="example-defining-custom-constraint"/><p class="title"><b>例 6.2. Defining the <code class="classname">@CheckCase</code> constraint annotation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;FIELD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;METHOD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;PARAMETER</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ANNOTATION_TYPE&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Constraint</span><span class="java_separator">(</span><span class="java_plain">validatedBy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CheckCaseValidator</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Documented</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">CheckCase</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter06.CheckCase.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">CaseMode</span><span class="java_plain">&nbsp;value</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;FIELD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;METHOD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;PARAMETER</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ANNOTATION_TYPE&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Documented</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">CheckCase</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;value</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>An annotation type is defined using the <code class="code">@interface</code> keyword. All attributes of an annotation type are declared in a method-like manner. The specification of the Bean Validation API demands, that any constraint annotation defines</p><div class="itemizedlist"><ul><li><p>an attribute <span class="property">message</span> that returns the default key for creating error messages in case the constraint is violated</p></li><li><p>an attribute <span class="property">groups</span> that allows the specification of validation groups, to which this constraint belongs (see <a class="xref" href="#chapter-groups" title="第 5 章 Grouping constraints">第 5 章 <i>Grouping constraints</i></a>). This must default to an empty array of type <code class="classname">Class&lt;?&gt;</code>.</p></li><li><p>an attribute <code class="classname">payload</code> that can be used by clients of the Bean Validation API to assign custom payload objects to a constraint. This attribute is not used by the API itself. An example for a custom payload could be the definition of a severity:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Severity</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Info</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Error</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ContactDetails</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Name&nbsp;is&nbsp;mandatory&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;payload&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Severity</span><span class="java_separator">.</span><span class="java_type">Error</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Phone&nbsp;number&nbsp;not&nbsp;specified,&nbsp;but&nbsp;not&nbsp;mandatory&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Severity</span><span class="java_separator">.</span><span class="java_type">Info</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;phoneNumber</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>Now a client can after the validation of a <code class="classname">ContactDetails</code> instance access the severity of a constraint using <code class="methodname">ConstraintViolation.getConstraintDescriptor().getPayload()</code> and adjust its behaviour depending on the severity.</p></li></ul></div><p>Besides these three mandatory attributes there is another one, <span class="property">value</span>, allowing for the required case mode to be specified. The name <span class="property">value</span> is a special one, which can be omitted when using the annotation, if it is the only attribute specified, as e.g. in <code class="code">@CheckCase(CaseMode.UPPER)</code>.</p><p>In addition, the constraint annotation is decorated with a couple of meta annotations:</p><div class="itemizedlist"><ul><li><p><code class="code">@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE })</code>: Defines the supported target element types for the constraint. <code class="classname">@CheckCase</code> may be used on fields (element type <code class="classname">FIELD</code>), JavaBeans properties as well as method return values (<code class="classname">METHOD</code>) and method/constructor parameters (<code class="classname">PARAMETER</code>). The element type <code class="classname">ANNOTATION_TYPE</code> allows for the creation of composed constraints (see <a class="xref" href="#section-constraint-composition">第 6.4 节 “Constraint composition”</a>) based on <code class="classname">@CheckCase</code>.</p><p>When creating a class-level constraint (see <a class="xref" href="#validator-usingvalidator-classlevel">第 2.1.3 节 “Class-level constraints”</a>), the element type <code class="classname">TYPE</code> would have to be used. Constraints targetting the return value of a constructor need to support the element type <code class="classname">CONSTRUCTOR</code>. Cross-parameter constraints (see <a class="xref" href="#section-cross-parameter-constraints" title="6.3. Cross-parameter constraints">第 6.3 节 “Cross-parameter constraints”</a>) which are used to validate all the parameters of a method or constructor together, must support <code class="classname">METHOD</code> or <code class="classname">CONSTRUCTOR</code>, respectively.</p></li><li><p><code class="code">@Retention(RUNTIME)</code>: Specifies, that annotations of this type will be available at runtime by the means of reflection</p></li><li><p><code class="code">@Constraint(validatedBy = CheckCaseValidator.class)</code>: Marks the annotation type as constraint annotation and specifies the validator to be used to validate elements annotated with <code class="classname">@CheckCase</code>. If a constraint may be used on several data types, several validators may be specified, one for each data type.</p></li><li><p><code class="code">@Documented</code>: Says, that the use of <code class="classname">@CheckCase</code> will be contained in the JavaDoc of elements annotated with it</p></li></ul></div><p>Finally, there is an inner annotation type named <code class="classname">List</code>. This annotation allows to specify several <code class="classname">@CheckCase</code> annotations on the same element, e.g. with different validation groups and messages. While also another name could be used, the Bean Validation specification recommends to use the name <code class="classname">List</code> and make the annotation an inner annotation of the corresponding constraint type.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-customconstraints-validator"/>6.1.2. The constraint validator</h3></div></div></div><p>Having defined the annotation, you need to create a constraint validator, which is able to validate elements with a <code class="classname">@CheckCase</code> annotation. To do so, implement the interface <code class="classname">ConstraintValidator</code> as shown below:</p><div class="example"><a id="example-constraint-validator"/><p class="title"><b>例 6.3. Implementing a constraint validator for the constraint <code class="classname">@CheckCase</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CheckCaseValidator</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;</span><span class="java_type">CheckCase</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">CaseMode</span><span class="java_plain">&nbsp;caseMode</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;initialize</span><span class="java_separator">(</span><span class="java_type">CheckCase</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">caseMode&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">.</span><span class="java_plain">value</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;object</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorContext</span><span class="java_plain">&nbsp;constraintContext</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;object&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;caseMode&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_type">CaseMode</span><span class="java_separator">.</span><span class="java_plain">UPPER&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">toUpperCase</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">else</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">toLowerCase</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The <code class="classname">ConstraintValidator</code> interface defines two type parameters which are set in the implementation. The first one specifies the annotation type to be validated (<code class="classname">CheckCase</code>), the second one the type of elements, which the validator can handle (<code class="classname">String</code>). In case a constraint supports several data types, a <code class="classname">ConstraintValidator</code> for each allowed type has to be implemented and registered at the constraint annotation as shown above.</p><p>The implementation of the validator is straightforward. The <code class="methodname">initialize()</code> method gives you access to the attribute values of the validated constraint and allows you to store them in a field of the validator as shown in the example.</p><p>The <code class="methodname">isValid()</code> method contains the actual validation logic. For <code class="classname">@CheckCase</code> this is the check whether a given string is either completely lower case or upper case, depending on the case mode retrieved in <code class="classname">initialize()</code>. Note that the Bean Validation specification recommends to consider <code class="code">null</code> values as being valid. If <code class="code">null</code> is not a valid value for an element, it should be annotated with <code class="code">@NotNull</code> explicitly.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e3281"/>6.1.2.1. The <code class="classname">ConstraintValidatorContext</code></h4></div></div></div><p><a class="xref" href="#example-constraint-validator" title="例 6.3. Implementing a constraint validator for the constraint @CheckCase">例 6.3 “Implementing a constraint validator for the constraint @CheckCase”</a> relies on the default error message generation by just returning <code class="constant">true</code> or <code class="constant">false</code> from the <code class="methodname">isValid()</code> method. Using the passed <code class="classname">ConstraintValidatorContext</code> object it is possible to either add additional error messages or completely disable the default error message generation and solely define custom error messages. The <code class="classname">ConstraintValidatorContext</code> API is modeled as fluent interface and is best demonstrated with an example:</p><div class="example"><a id="example-constraint-validator-context"/><p class="title"><b>例 6.4. Using <code class="classname">ConstraintValidatorContext</code> to define custom error messages</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">constraintvalidatorcontext</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">CheckCaseValidator</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;</span><span class="java_type">CheckCase</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">CaseMode</span><span class="java_plain">&nbsp;caseMode</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;initialize</span><span class="java_separator">(</span><span class="java_type">CheckCase</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">caseMode&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">.</span><span class="java_plain">value</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;object</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorContext</span><span class="java_plain">&nbsp;constraintContext</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;object&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;caseMode&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_type">CaseMode</span><span class="java_separator">.</span><span class="java_plain">UPPER&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isValid&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">toUpperCase</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">else</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isValid&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;object</span><span class="java_separator">.</span><span class="java_plain">toLowerCase</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_operator">!</span><span class="java_plain">isValid&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintContext</span><span class="java_separator">.</span><span class="java_plain">disableDefaultConstraintViolation</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintContext</span><span class="java_separator">.</span><span class="java_plain">buildConstraintViolationWithTemplate</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter03.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;constraintvalidatorcontext.CheckCase.message}&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addConstraintViolation</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p><a class="xref" href="#example-constraint-validator-context" title="例 6.4. Using ConstraintValidatorContext to define custom error messages">例 6.4 “Using ConstraintValidatorContext to define custom error messages”</a> shows how you can disable the default error message generation and add a custom error message using a specified message template. In this example the use of the <code class="classname">ConstraintValidatorContext</code> results in the same error message as the default error message generation.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>It is important to add each configured constraint violation by calling <code class="methodname">addConstraintViolation()</code>. Only after that the new constraint violation will be created.</p></div><p>Refer to <a class="xref" href="#section-custom-property-paths" title="6.2.1. Custom property paths">第 6.2.1 节 “Custom property paths”</a> to learn how to use <code class="classname">the ConstraintValidatorContext</code> API to control the property path of constraint violations for class-level constraints.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-customconstraints-errormessage"/>6.1.3. The error message</h3></div></div></div><p>The last missing building block is an error message which should be used in case a <code class="classname">@CheckCase</code> constraint is violated. To define this, create a file<code class="filename"> ValidationMessages.properties</code> with the following contents (see also <a class="xref" href="#section-message-interpolation" title="4.1. Default message interpolation">第 4.1 节 “Default message interpolation”</a>):</p><div class="example"><a id="d0e3344"/><p class="title"><b>例 6.5. Defining a custom error message for the <code class="classname">CheckCase</code> constraint</b></p><div class="example-contents"><pre class="programlisting">org.hibernate.validator.referenceguide.chapter06.CheckCase.message=Case mode must be {value}.</pre></div></div><br class="example-break"/><p>If a validation error occurs, the validation runtime will use the default value, that you specified for the message attribute of the <code class="classname">@CheckCase</code> annotation to look up the error message in this resource bundle.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-customconstraints-using"/>6.1.4. Using the constraint</h3></div></div></div><p>You can now use the constraint in the <code class="classname">Car</code> class from the <a class="xref" href="#validator-gettingstarted" title="第 1 章 Getting started">第 1 章 <i>Getting started</i></a> chapter to specify that the <span class="property">licensePlate</span> field should only contain upper-case strings:</p><div class="example"><a id="example-car-with-checkcase"/><p class="title"><b>例 6.6. Applying the <code class="classname">@CheckCase</code> constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">CheckCase</span><span class="java_separator">(</span><span class="java_type">CaseMode</span><span class="java_separator">.</span><span class="java_plain">UPPER</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Finally, <a class="xref" href="#example-using-checkcase" title="例 6.7. Validating objects with the @CheckCase constraint">例 6.7 “Validating objects with the @CheckCase constraint”</a> demonstrates how validating a <code class="classname">Car</code> object with an invalid license plate causes the <code class="classname">@CheckCase</code> constraint to be violated.</p><div class="example"><a id="example-using-checkcase"/><p class="title"><b>例 6.7. Validating objects with the @<code class="classname">CheckCase</code> constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">invalid&nbsp;license&nbsp;plate</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;dd-ab-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">4</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;Case&nbsp;mode&nbsp;must&nbsp;be&nbsp;UPPER.&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">valid&nbsp;license&nbsp;plate</span>
<!--  --><br/><span class="java_plain">car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">4</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-class-level-constraints"/>6.2. Class-level constraints</h2></div></div></div><p>As discussed earlier, constraints can also be applied on the class level to validate the state of an entire object. Class-level constraints are defined in the same was as are property constraints. <a class="xref" href="#example-implementing-classlevel-constraint" title="例 6.8. Implementing a class-level constraint">例 6.8 “Implementing a class-level constraint”</a> shows constraint annotation and validator of the <code class="classname">@ValidPassengerCount</code> constraint you already saw in use in <a class="xref" href="#example-class-level" title="例 2.3. Class-level constraint">例 2.3 “Class-level constraint”</a>.</p><div class="example"><a id="example-implementing-classlevel-constraint"/><p class="title"><b>例 6.8. Implementing a class-level constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">classlevel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;TYPE</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ANNOTATION_TYPE&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Constraint</span><span class="java_separator">(</span><span class="java_plain">validatedBy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidPassengerCountValidator</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Documented</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidPassengerCount</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter06.classlevel.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;ValidPassengerCount.message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">classlevel</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidPassengerCountValidator</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;</span><span class="java_type">ValidPassengerCount</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;initialize</span><span class="java_separator">(</span><span class="java_type">ValidPassengerCount</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">(</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorContext</span><span class="java_plain">&nbsp;context</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">getPassengers</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_operator">&lt;=</span><span class="java_plain">&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">getSeatCount</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>As the example demonstrates, you need to use the element type <code class="classname">TYPE</code> in the <code class="classname">@Target</code> annotation. This allows the constraint to be put on type definitions. The validator of the constraint in the example receives a <code class="classname">Car</code> in the <code class="methodname">isValid()</code> method and can access the complete object state to decide whether the given instance is valid or not.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-custom-property-paths"/>6.2.1. Custom property paths</h3></div></div></div><p>By default the constraint violation for a class-level constraint is reported on the level of the annotated type, e.g. <code class="classname">Car</code>.</p><p>In some cases it is preferable though that the violation's property path refers to one of the involved properties. For instance you might want to report the <code class="classname">@ValidPassengerCount</code> constraint against the <span class="property">passengers</span> property instead of the <code class="classname">Car</code> bean.</p><p><a class="xref" href="#example-custom-error" title="例 6.9. Adding a new ConstraintViolation with custom property path">例 6.9 “Adding a new ConstraintViolation with custom property path”</a> shows how this can be done by using the constraint validator context passed to <code class="methodname">isValid()</code> to build a custom constraint violation with a property node for the property <span class="property">passengers</span>. Note that you also could add several property nodes, pointing to a sub-entity of the validated bean.</p><div class="example"><a id="example-custom-error"/><p class="title"><b>例 6.9. Adding a new <code class="classname">ConstraintViolation</code> with custom property path</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">custompath</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidPassengerCountValidator</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;</span><span class="java_type">ValidPassengerCount</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;initialize</span><span class="java_separator">(</span><span class="java_type">ValidPassengerCount</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">(</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorContext</span><span class="java_plain">&nbsp;constraintValidatorContext</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">getPassengers</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_operator">&lt;=</span><span class="java_plain">&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">getSeatCount</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_operator">!</span><span class="java_plain">isValid&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintValidatorContext</span><span class="java_separator">.</span><span class="java_plain">disableDefaultConstraintViolation</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintValidatorContext</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildConstraintViolationWithTemplate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{my.custom.template}&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addPropertyNode</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;passengers&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">addConstraintViolation</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-cross-parameter-constraints"/>6.3. Cross-parameter constraints</h2></div></div></div><p>Bean Validation distinguishes between two different kinds of constraints.</p><p>Generic constraints (which have been discussed so far) apply to the annotated element, e.g. a type, field, method parameter or return value etc. Cross-parameter constraints, in contrast, apply to the array of parameters of a method or constructor and can be used to express validation logic which depends on several parameter values.</p><p>In order to define a cross-parameter constraint, its validator class must be annotated with <code class="classname">@SupportedValidationTarget(ValidationTarget.PARAMETERS)</code>. The type parameter <code class="varname">T</code> from the <code class="classname">ConstraintValidator</code> interface must resolve to either <code class="classname">Object</code> or <code class="classname">Object[]</code> in order to receive the array of method/constructor arguments in the <code class="methodname">isValid()</code> method.</p><p>The following example shows the definition of a cross-parameter constraint which can be used to check that two <code class="classname">Date</code> parameters of a method are in the correct order:</p><div class="example"><a id="d0e3497"/><p class="title"><b>例 6.10. Cross-parameter constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">crossparameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Constraint</span><span class="java_separator">(</span><span class="java_plain">validatedBy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ConsistentDateParameterValidator</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;METHOD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;CONSTRUCTOR</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ANNOTATION_TYPE&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Documented</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">ConsistentDateParameters</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter06.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;crossparameter.ConsistentDateParameters.message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The definition of a cross-parameter constraint isn't any different from defining a generic constraint, i.e. it must specify the members <code class="methodname">message()</code>, <code class="methodname">groups()</code> and <code class="methodname">payload()</code> and be annotated with <code class="classname">@Constraint</code>. This meta annotation also specifies the corresponding validator, which is shown in <a class="xref" href="#example-cross-parameter-validator" title="例 6.11. Generic and cross-parameter constraint">例 6.11 “Generic and cross-parameter constraint”</a>. Note that besides the element types <code class="classname">METHOD</code> and <code class="classname">CONSTRUCTOR</code> also <code class="classname">ANNOTATION_TYPE</code> is specified as target of the annotation, in order to enable the creation of composed constraints based on <code class="classname">@ConsistentDateParameters</code> (see <a class="xref" href="#validator-customconstraints-compound" title="6.4. Constraint composition">第 6.4 节 “Constraint composition”</a>).</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Cross-parameter constraints are specified directly on the declaration of a method or constructor, which is also the case for return value constraints. In order to improve code readability, it is therefore recommended to chose constraint names - such as <code class="classname">@ConsistentDateParameters</code> - which make the constraint target apparent.</p></div><div class="example"><a id="example-cross-parameter-validator"/><p class="title"><b>例 6.11. Generic and cross-parameter constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">crossparameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">SupportedValidationTarget</span><span class="java_separator">(</span><span class="java_type">ValidationTarget</span><span class="java_separator">.</span><span class="java_plain">PARAMETERS</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ConsistentDateParameterValidator</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;</span><span class="java_type">ConsistentDateParameters</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;initialize</span><span class="java_separator">(</span><span class="java_type">ConsistentDateParameters</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">(</span><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;value</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorContext</span><span class="java_plain">&nbsp;context</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value</span><span class="java_separator">.</span><span class="java_plain">length&nbsp;</span><span class="java_operator">!=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">throw</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">IllegalArgumentException</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Illegal&nbsp;method&nbsp;signature&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">leave&nbsp;</span><span class="java_literal">null</span><span class="java_operator">-</span><span class="java_plain">checking&nbsp;to&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;on&nbsp;individual&nbsp;parameters</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value</span><span class="java_separator">[</span><span class="java_literal">0</span><span class="java_separator">]</span><span class="java_plain">&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;value</span><span class="java_separator">[</span><span class="java_literal">1</span><span class="java_separator">]</span><span class="java_plain">&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_operator">!</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value</span><span class="java_separator">[</span><span class="java_literal">0</span><span class="java_separator">]</span><span class="java_plain">&nbsp;</span><span class="java_keyword">instanceof</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_operator">!</span><span class="java_separator">(</span><span class="java_plain">&nbsp;value</span><span class="java_separator">[</span><span class="java_literal">1</span><span class="java_separator">]</span><span class="java_plain">&nbsp;</span><span class="java_keyword">instanceof</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">throw</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">IllegalArgumentException</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;Illegal&nbsp;method&nbsp;signature,&nbsp;expected&nbsp;two&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;parameters&nbsp;of&nbsp;type&nbsp;Date.&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Date</span><span class="java_separator">)</span><span class="java_plain">&nbsp;value</span><span class="java_separator">[</span><span class="java_literal">0</span><span class="java_separator">]</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">before</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Date</span><span class="java_separator">)</span><span class="java_plain">&nbsp;value</span><span class="java_separator">[</span><span class="java_literal">1</span><span class="java_separator">]</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>As discussed above, the validation target <code class="varname">PARAMETERS</code> must be configured for a cross-parameter validator by using the <code class="classname">@SupportedValidationTarget</code> annotation. Since a cross-parameter constraint could be applied to any method or constructor, it is considered a best practice to check for the expected number and types of parameters in the validator implementation.</p><p>As with generic constraints, <code class="literal">null</code> parameters should be considered valid and <code class="classname">@NotNull</code> on the individual parameters should be used to make sure that parameters are not <code class="literal">null</code>.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>Similar to class-level constraints, you can create custom constraint violations on single parameters instead of all parameters when validating a cross-parameter constraint. Just obtain a node builder from the <code class="classname">ConstraintValidatorContext</code> passed to <code class="methodname">isValid()</code> and add a parameter node by calling <code class="methodname">addParameterNode()</code>. In the example you could use this to create a constraint violation on the end date parameter of the validated method.</p></div><p>In rare situations a constraint is both, generic and cross-parameter. This is the case if a constraint has a validator class which is annotated with <code class="code">@SupportedValidationTarget({ValidationTarget.PARAMETERS, ValidationTarget.ANNOTATED_ELEMENT})</code> or if it has a generic and a cross-parameter validator class.</p><p>When declaring such a constraint on a method which has parameters and also a return value, the intended constraint target can't be determined. Constraints which are generic and cross-parameter at the same time, must therefore define a member <code class="methodname">validationAppliesTo()</code> which allows the constraint user to specify the constraint's target as shown in <a class="xref" href="#example-dual-cross-parameter-constraint" title="例 6.12. Generic and cross-parameter constraint">例 6.12 “Generic and cross-parameter constraint”</a>.</p><div class="example"><a id="example-dual-cross-parameter-constraint"/><p class="title"><b>例 6.12. Generic and cross-parameter constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">crossparameter</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Constraint</span><span class="java_separator">(</span><span class="java_plain">validatedBy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ScriptAssertObjectValidator</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ScriptAssertParametersValidator</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;TYPE</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;PARAMETER</span><span class="java_separator">,</span><span class="java_plain">&nbsp;METHOD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;CONSTRUCTOR</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ANNOTATION_TYPE&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Documented</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">ScriptAssert</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter06.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;crossparameter.ScriptAssert.message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;script</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ConstraintTarget</span><span class="java_plain">&nbsp;validationAppliesTo</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintTarget</span><span class="java_separator">.</span><span class="java_plain">IMPLICIT</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The <code class="classname">@ScriptAssert</code> constraint has two validators (not shown), a generic and a cross-parameter one and thus defines the member <code class="methodname">validationAppliesTo()</code>. The default value <code class="varname">IMPLICIT</code> allows to derive the target automatically in situations where this is possible (e.g. if the constraint is declared on a field or on a method which has parameters but no return value).</p><p>If the target can not be determined implicitly, it must be set by the user to either <code class="varname">PARAMETERS</code> or <code class="varname">RETURN_VALUE</code> as shown in <a class="xref" href="#example-dual-cross-parameter-constraint-usage" title="例 6.13. Specifying the target for a generic and cross-parameter constraint">例 6.13 “Specifying the target for a generic and cross-parameter constraint”</a>.</p><div class="example"><a id="example-dual-cross-parameter-constraint-usage"/><p class="title"><b>例 6.13. Specifying the target for a generic and cross-parameter constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">ScriptAssert</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">script&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;arg1.size()&nbsp;&lt;=&nbsp;arg0&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;validationAppliesTo&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">ConstraintTarget</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">PARAMETERS</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;buildCar</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Passenger</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-customconstraints-compound"/>6.4. Constraint composition</h2></div></div></div><p>Looking at the <span class="property">licensePlate</span> field of the <code class="classname">Car</code> class in <a class="xref" href="#example-car-with-checkcase" title="例 6.6. Applying the @CheckCase constraint">例 6.6 “Applying the @CheckCase constraint”</a>, you see three constraint annotations already. In complexer scenarios, where even more constraints could be applied to one element, this might become a bit confusing easily. Furthermore, if there was a <span class="property">licensePlate</span> field in another class, you would have to copy all constraint declarations to the other class as well, violating the DRY principle.</p><p>You can address this kind of problem by creating higher level constraints, composed from several basic constraints. <a class="xref" href="#example-composed-constraint" title="例 6.14. Creating a composing constraint @ValidLicensePlate">例 6.14 “Creating a composing constraint @ValidLicensePlate”</a> shows a composed constraint annotation which comprises the constraints <code class="classname">@NotNull</code>, <code class="classname">@Size</code> and <code class="classname">@CheckCase</code>:</p><div class="example"><a id="example-composed-constraint"/><p class="title"><b>例 6.14. Creating a composing constraint <code class="classname">@ValidLicensePlate</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">constraintcomposition</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">CheckCase</span><span class="java_separator">(</span><span class="java_type">CaseMode</span><span class="java_separator">.</span><span class="java_plain">UPPER</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;METHOD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;ANNOTATION_TYPE&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Constraint</span><span class="java_separator">(</span><span class="java_plain">validatedBy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Documented</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidLicensePlate</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter06.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;constraintcomposition.ValidLicensePlate.message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>To create a composed constraint, simply annotate the constraint declaration with its comprising constraints. If the composed constraint itself requires a validator, this validator is to be specified within the <code class="classname">@Constraint</code> annotation. For composed constraints which don't need an additional validator such as <code class="classname">@ValidLicensePlate</code>, just set <code class="methodname">validatedBy()</code> to an empty array.</p><p>Using the new composed constraint at the <span class="property">licensePlate</span> field is fully equivalent to the previous version, where the three constraints were declared directly at the field itself:</p><div class="example"><a id="d0e3670"/><p class="title"><b>例 6.15. Application of composing constraint <code class="classname">ValidLicensePlate</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter06</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">constraintcomposition</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ValidLicensePlate</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The set of <code class="classname">ConstraintViolations</code> retrieved when validating a <code class="classname">Car</code> instance will contain an entry for each violated composing constraint of the <code class="classname">@ValidLicensePlate</code> constraint. If you rather prefer a single <code class="classname">ConstraintViolation</code> in case any of the composing constraints is violated, the <code class="classname">@ReportAsSingleViolation</code> meta constraint can be used as follows:</p><div class="example"><a id="d0e3694"/><p class="title"><b>例 6.16. Using <code class="classname">@ReportAsSingleViolation</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ReportAsSingleViolation</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidLicensePlate</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter06.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;constraintcomposition.ValidLicensePlate.message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-xml-configuration"/>第 7 章 Configuring via XML</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#section-configuration-validation-xml">7.1. Configuring the validator factory in validation.xml</a></span></dt><dt><span class="section"><a href="#section-mapping-xml-constraints">7.2. Mapping constraints via constraint-mappings</a></span></dt></dl></div><p>So far we have used the default configuration source for Bean Validation, namely annotations. However, there also exist two kinds of XML descriptors allowing configuration via XML. The first descriptor describes general Bean Validation behaviour and is provided as <code class="filename">META-INF/validation.xml</code>. The second one describes constraint declarations and closely matches the constraint declaration approach via annotations. Let's have a look at these two document types.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>The XSD files are available via <a class="ulink" href="http://www.jboss.org/xml/ns/javax/validation/configuration/">http://www.jboss.org/xml/ns/javax/validation/configuration</a> and <a class="ulink" href="http://www.jboss.org/xml/ns/javax/validation/mapping">http://www.jboss.org/xml/ns/javax/validation/mapping</a>.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-configuration-validation-xml"/>7.1. Configuring the validator factory in <code class="filename">validation.xml</code></h2></div></div></div><p>The key to enable XML configuration for Hibernate Validator is the file <code class="filename">META-INF/validation.xml</code>. If this file exists on the classpath its configuration will be applied when the <code class="classname">ValidatorFactory</code> gets created. <a class="xref" href="#image-validation-configuration" title="例 7.1. validation-configuration-1.1.xsd">例 7.1 “validation-configuration-1.1.xsd”</a> shows a model view of the XML schema to which <code class="filename">validation.xml</code> has to adhere.</p><div class="example"><a id="image-validation-configuration"/><p class="title"><b>例 7.1. validation-configuration-1.1.xsd</b></p><div class="example-contents"><div class="mediaobject"><img src="validation-configuration-1.1.png"/></div></div></div><p><br class="example-break"/></p><p><a class="xref" href="#example-validation-xml" title="例 7.2. validation.xml">例 7.2 “validation.xml”</a> shows the several configuration options of <code class="filename">validation.xml</code>. All settings are optional and the same configuration options are also available programmatically through <code class="classname">javax.validation.Configuration</code>. In fact the XML configuration will be overridden by values explicitly specified via the programmatic API. It is even possible to ignore the XML configuration completely via <code class="methodname">Configuration#ignoreXmlConfiguration()</code>. See also <a class="xref" href="#section-configuring-validator-factory" title="8.2. Configuring a ValidatorFactory">第 8.2 节 “Configuring a ValidatorFactory”</a>.</p><div class="example"><a id="example-validation-xml"/><p class="title"><b>例 7.2. validation.xml</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">validation-config</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/configuration&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/configuration&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">default-provider</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">com.acme.ValidationProvider</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">default-provider</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">message-interpolator</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">com.acme.MessageInterpolator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">message-interpolator</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">traversable-resolver</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">com.acme.TraversableResolver</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">traversable-resolver</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-validator-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;com.acme.ConstraintValidatorFactory</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-validator-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter-name-provider</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">com.acme.ParameterNameProvider</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">parameter-name-provider</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">executable-validation</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">enabled</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">default-validated-executable-types</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">executable-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">CONSTRUCTORS</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">executable-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">executable-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">NON_GETTER_METHODS</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">executable-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">executable-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">GETTER_METHODS</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">executable-type</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">default-validated-executable-types</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">executable-validation</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">META-INF/validation/constraints-car.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;hibernate.validator.fail_fast&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">false</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">validation-config</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>There must only be one file named <code class="filename">META-INF/validation.xml</code> on the classpath. If more than one is found an exception is thrown.</p></div><p>The node <span class="property">default-provider</span> allows to choose the Bean Validation provider. This is useful if there is more than one provider on the classpath. <span class="property">message-interpolator</span>, <span class="property">traversable-resolver</span>, <span class="property">constraint-validator-factory</span> and <span class="property">parameter-name-provider</span> allow to customize the used implementations for the interfaces <code class="classname">MessageInterpolator</code>, <code class="classname">TraversableResolver</code>, <code class="classname">ConstraintValidatorFactory</code> and <code class="classname">ParameterNameProvider</code> defined in the <code class="classname">javax.validation</code> package. See the sub-sections of <a class="xref" href="#section-configuring-validator-factory" title="8.2. Configuring a ValidatorFactory">第 8.2 节 “Configuring a ValidatorFactory”</a> for more information about these interfaces.</p><p><span class="property">executable-validation</span> and its subnodes define defaults for method validation. The Bean Validation specification defines constructor and non getter methods as defaults. The <span class="property">enabled</span> attribute acts as global switch to turn method validation on and off (see also <a class="xref" href="#chapter-method-constraints" title="第 3 章 Declaring and validating method constraints">第 3 章 <i>Declaring and validating method constraints</i></a>).</p><p>Via the <span class="property">constraint-mapping</span> element you can list an arbitrary number of additional XML files containing the actual constraint configuration. Mapping file names must be specified using their fully-qualified name on the classpath. Details on writing mapping files can be found in the next section.</p><p>Last but not least, you can specify provider specific properties via the <span class="property">property</span> nodes. In the example we are using the Hibernate Validator specific <span class="property">hibernate.validator.fail_fast</span> property (see <a class="xref" href="#section-fail-fast" title="11.2. Fail fast mode">第 11.2 节 “Fail fast mode”</a>).</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-mapping-xml-constraints"/>7.2. Mapping constraints via <span class="property">constraint-mappings</span></h2></div></div></div><p>Expressing constraints in XML is possible via files adhering to the schema seen in <a class="xref" href="#image-mapping-configuration" title="例 7.3. validation-mapping-1.1.xsd">例 7.3 “validation-mapping-1.1.xsd”</a>. Note that these mapping files are only processed if listed via <span class="property">constraint-mapping</span> in <code class="filename">validation.xml</code>.</p><div class="example"><a id="image-mapping-configuration"/><p class="title"><b>例 7.3. validation-mapping-1.1.xsd</b></p><div class="example-contents"><div class="mediaobject"><img src="validation-mapping-1.1.png"/></div></div></div><br class="example-break"/><p><a class="xref" href="#example-constraints-car" title="例 7.4. Bean constraints configured via XML">例 7.4 “Bean constraints configured via XML”</a> shows how the classes <code class="classname">Car</code> and <code class="classname">RentalCar</code> from <a class="xref" href="#example-car" title="例 5.3. Car">例 5.3 “Car”</a> resp. <a class="xref" href="#example-rental-car" title="例 5.7. Class RentalCar with redefined default group">例 5.7 “Class RentalCar with redefined default group”</a> could be mapped in XML.</p><div class="example"><a id="example-constraints-car"/><p class="title"><b>例 7.4. Bean constraints configured via XML</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-mappings</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/mapping&nbsp;validation-mapping-1.1.xsd&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/mapping&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">version</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;1.1&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">default-package</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.referenceguide.chapter05</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">default-package</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Car&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;manufacturer&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;licensePlate&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;seatCount&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.Min&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;value&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">2</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;driver&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">valid</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">getter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;passedVehicleInspection&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.AssertTrue&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groups</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">CarChecks</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groups</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;max&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">10</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">getter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;RentalCar&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">class</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">group-sequence</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">RentalCar</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">CarChecks</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">group-sequence</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-definition</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.mycompany.CheckCase&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">validated-by</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">include-existing-validators</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.mycompany.CheckCaseValidator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">validated-by</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-definition</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><p><a class="xref" href="#example-rental-station-xml" title="例 7.5. Method constraints configured via XML">例 7.5 “Method constraints configured via XML”</a> shows how the constraints from <a class="xref" href="#example-declaring-parameter-constraints" title="例 3.1. Declaring method and constructor parameter constraints">例 3.1 “Declaring method and constructor parameter constraints”</a>, <a class="xref" href="#example-declaring-return-value-constraints" title="例 3.4. Declaring method and constructor return value constraints">例 3.4 “Declaring method and constructor return value constraints”</a> and <a class="xref" href="#example-specifying-constraint-target" title="例 3.3. Specifying a constraint's target">例 3.3 “Specifying a constraint's target”</a> can be expressed in XML.</p><div class="example"><a id="example-rental-station-xml"/><p class="title"><b>例 7.5. Method constraints configured via XML</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-mappings</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/mapping&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/mapping&nbsp;validation-mapping-1.1.xsd&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">version</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;1.1&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">default-package</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.referenceguide.chapter07</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">default-package</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;RentalStation&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constructor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">return-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;ValidRentalStation&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">return-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constructor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constructor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java.lang.String&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">parameter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constructor</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">method</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;getCustomers&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">return-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.Size&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;min&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">1</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">return-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">method</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">method</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;rentCar&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Customer&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">parameter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java.util.Date&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.Future&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">parameter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;int&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.Min&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;value&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">1</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">parameter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">method</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Garage&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">method</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;buildCar&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java.util.List&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">cross-parameter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;ELAssert&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;expression&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">...</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;validationAppliesTo&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">PARAMETERS</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">cross-parameter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">method</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">method</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;paintCar&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">parameter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;int&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">return-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;ELAssert&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;expression&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">...</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;validationAppliesTo&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">RETURN_VALUE</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">return-value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">method</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><p>The XML configuration is closely mirroring the programmatic API. For this reason it should suffice to just add some comments. <span class="property">default-package</span> is used for all fields where a class name is expected. If the specified class is not fully qualified the configured default package will be used. Every mapping file can then have several <span class="property">bean</span> nodes, each describing the constraints on the entity with the specified class name.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>A given entity can only be configured once across all configuration files. The same applies for constraint definitions for a given constraint annotation. It can only occur in one mapping file. If these rules are violated a <code class="classname">ValidationException</code> is thrown.</p></div><p>Setting <span class="property">ignore-annotations</span> to <code class="constant">true</code> means that constraint annotations placed on the configured bean are ignored. The default for this value is <code class="constant">true</code>. ignore-annotations is also available for the nodes <span class="property">class</span>, <span class="property">fields</span>, <span class="property">getter</span>, <span class="property">constructor</span>, <span class="property">method</span>, <span class="property">parameter</span>, <span class="property">cross-parameter</span> and <span class="property">return-value</span>. If not explicitly specified on these levels the configured <span class="property">bean</span> value applies.</p><p>The nodes <span class="property">class</span>, <span class="property">field</span>, <span class="property">getter</span>, <span class="property">constructor</span> and <span class="property">method</span> (and its sub node <span class="property">parameter</span>) determine on which level the constraint gets placed. The <span class="property">constraint</span> node is then used to add a constraint on the corresponding level. Each constraint definition must define the class via the <span class="property">annotation</span> attribute. The constraint attributes required by the Bean Validation specification (<span class="property">message</span>, <span class="property">groups</span> and <span class="property">payload</span>) have dedicated nodes. All other constraint specific attributes are configured using the <span class="property">element</span> node.</p><p>The <span class="property">class</span> node also allows to reconfigure the default group sequence (see <a class="xref" href="#section-default-group-class" title="5.3. Redefining the default group sequence">第 5.3 节 “Redefining the default group sequence”</a>) via the <span class="property">group-sequence</span> node. Not shown in the example is the use of <span class="property">convert-group</span> to specify group conversions (see <a class="xref" href="#section-group-conversion" title="5.4. Group conversion">第 5.4 节 “Group conversion”</a>). This node is available on <span class="property">field</span>, <span class="property">getter</span>, <span class="property">parameter</span> and <span class="property">return-value</span> and specifies a <span class="property">from</span> and <span class="property">to</span> attribute to specify the groups.</p><p>Last but not least, the list of <code class="classname">ConstraintValidator</code>s associated to a given constraint can be altered via the <span class="property">constraint-definition</span> node. The <span class="property">annotation</span> attribute represents the constraint annotation being altered. The <span class="property">validated-by</span> elements represent the (ordered) list of <code class="classname">ConstraintValidator</code> implementations associated to the constraint. If <span class="property">include-existing-validator</span> is set to <code class="constant">false</code>, validators defined on the constraint annotation are ignored. If set to <code class="constant">true</code>, the list of constraint validators described in XML is concatenated to the list of validators specified on the annotation.</p></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-bootstrapping"/>第 8 章 Bootstrapping</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#section-retrieving-validator-factory-validator">8.1. Retrieving ValidatorFactory and Validator</a></span></dt><dd><dl><dt><span class="section"><a href="#section-validation-provider-resolver">8.1.1. ValidationProviderResolver</a></span></dt></dl></dd><dt><span class="section"><a href="#section-configuring-validator-factory">8.2. Configuring a ValidatorFactory</a></span></dt><dd><dl><dt><span class="section"><a href="#section-validator-factory-message-interpolator">8.2.1. MessageInterpolator</a></span></dt><dt><span class="section"><a href="#d0e4245">8.2.2. TraversableResolver</a></span></dt><dt><span class="section"><a href="#d0e4287">8.2.3. ConstraintValidatorFactory</a></span></dt><dt><span class="section"><a href="#section-parameter-name-provider">8.2.4. ParameterNameProvider</a></span></dt><dt><span class="section"><a href="#d0e4371">8.2.5. Adding mapping streams</a></span></dt><dt><span class="section"><a href="#section-provider-specific-settings">8.2.6. Provider-specific settings</a></span></dt></dl></dd><dt><span class="section"><a href="#section-configuring-validator">8.3. Configuring a Validator</a></span></dt></dl></div><p>In <a class="xref" href="#section-obtaining-validator" title="2.2.1. Obtaining a Validator instance">第 2.2.1 节 “Obtaining a Validator instance”</a> you already saw one way for creating a <code class="classname">Validator</code> instance - via <code class="methodname">Validation#buildDefaultValidatorFactory()</code>. In this chapter you will learn how to use the other methods in <code class="classname">javax.validation.Validation</code> in order to bootstrap specifically configured validators.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-retrieving-validator-factory-validator"/>8.1. Retrieving <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code></h2></div></div></div><p>You obtain a <code class="classname">Validator</code> by retrieving a <code class="classname">ValidatorFactory</code> via one of the static methods on <code class="classname">javax.validation.Validation</code> and calling <code class="classname">getValidator()</code> on the factory instance.</p><p><a class="xref" href="#example-build-default-validator-factory" title="例 8.1. Bootstrapping default ValidatorFactory and Validator">例 8.1 “Bootstrapping default ValidatorFactory and Validator”</a> shows how to obtain a validator from the default validator factory:</p><div class="example"><a id="example-build-default-validator-factory"/><p class="title"><b>例 8.1. Bootstrapping default <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>The generated <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> instances are thread-safe and can be cached. As Hibernate Validator uses the factory as context for caching constraint metadata it is recommended to work with one factory instance within an application.</p></div><p>Bean Validation supports working with several providers such as Hibernate Validator within one application. If more than one provider is present on the classpath, it is not guaranteed which one is chosen when creating a factory via <code class="methodname">buildDefaultValidatorFactory()</code>.</p><p>In this case you can explicitly specify the provider to use via <code class="methodname">Validation#byProvider()</code>, passing the provider's <code class="classname">ValidationProvider</code> class as shown in <a class="xref" href="#example-using-specific-provider" title="例 8.2. Bootstrapping ValidatorFactory and Validator using a specific provider">例 8.2 “Bootstrapping ValidatorFactory and Validator using a specific provider”</a>.</p><div class="example"><a id="example-using-specific-provider"/><p class="title"><b>例 8.2. Bootstrapping <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> using a specific provider</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Note that the configuration object returned by <code class="methodname">configure()</code> allows to specifically customize the factory before calling <code class="methodname">buildValidatorFactory()</code>. The available options are discussed later in this chapter.</p><p>Similarly you can retrieve the default validator factory for configuration which is demonstrated in <a class="xref" href="#example-configuring-default-provider" title="例 8.3. Retrieving the default ValidatorFactory for configuration">例 8.3 “Retrieving the default ValidatorFactory for configuration”</a>.</p><div class="example"><a id="example-configuring-default-provider"/><p class="title"><b>例 8.3. Retrieving the default <code class="classname">ValidatorFactory</code> for configuration</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>If a <code class="classname">ValidatorFactory</code> instance is no longer in use, it should be disposed by calling <code class="methodname">ValidatorFactory#close()</code>. This will free any resources possibly allocated by the factory.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-validation-provider-resolver"/>8.1.1. <code class="classname">ValidationProviderResolver</code></h3></div></div></div><p>By default, available Bean Validation providers are discovered using the <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider">Java Service Provider</a> mechanism.</p><p>For that purpose, each provider includes the file <code class="filename">META-INF/services/javax.validation.spi.ValidationProvider</code>, containing the fully qualified classname of its <code class="classname">ValidationProvider</code> implementation. In the case of Hibernate Validator this is <code class="classname">org.hibernate.validator.HibernateValidator</code>.</p><p>Depending on your environment and its classloading specifics, provider discovery via the Java's service loader mechanism might not work. In this case you can plug in a custom <code class="classname">ValidationProviderResolver</code> implementation which performs the provider retrieval. An example is OSGi, where you could implement a provider resolver which uses OSGi services for provider discovery.</p><p>To use a custom provider resolver pass it via <code class="methodname">providerResolver()</code> as shown shown in <a class="xref" href="#example-using-custom-validation-provider-resolver" title="例 8.4. Using a custom ValidationProviderResolver">例 8.4 “Using a custom ValidationProviderResolver”</a>.</p><div class="example"><a id="example-using-custom-validation-provider-resolver"/><p class="title"><b>例 8.4. Using a custom <code class="classname">ValidationProviderResolver</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">OsgiServiceDiscoverer</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidationProviderResolver</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">ValidationProvider</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;getValidationProviders</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">providerResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">OsgiServiceDiscoverer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-configuring-validator-factory"/>8.2. Configuring a <code class="classname">ValidatorFactory</code></h2></div></div></div><p>By default validator factories retrieved from <code class="classname">Validation</code> and any validators they create are configured as per the XML descriptor <code class="filename">META-INF/validation.xml</code> (see <a class="xref" href="#chapter-xml-configuration" title="第 7 章 Configuring via XML">第 7 章 <i>Configuring via XML</i></a>), if present.</p><p>If you want to disable the XML based configuration, you can do so by invoking <code class="methodname">Configuration#ignoreXmlConfiguration()</code>.</p><p>The different values of the XML configuration can be accessed via <code class="methodname">Configuration#getBootstrapConfiguration()</code>. This can for instance be helpful if you want to integrate Bean Validation into a managed environment and want to create managed instances of the objects configured via XML.</p><p>Using the fluent configuration API, you can override one or more of the settings when bootstrapping the factory. The following sections show how to make use of the different options. Note that the <code class="classname">Configuration</code> class exposes the default implementations of the different extension points which can be useful if you want to use these as delegates for your custom implementations.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-validator-factory-message-interpolator"/>8.2.1. <code class="classname">MessageInterpolator</code></h3></div></div></div><p>Message interpolators are used by the validation engine to create user readable error messages from constraint message descriptors.</p><p>In case the default message interpolation algorithm described in <a class="xref" href="#chapter-message-interpolation" title="第 4 章 Interpolating constraint error messages">第 4 章 <i>Interpolating constraint error messages</i></a> is not sufficient for your needs, you can pass in your own implementation of the <code class="classname">MessageInterpolator</code> interface via <code class="classname">Configuration#messageInterpolator()</code> as shown in <a class="xref" href="#example-using-custom-message-interpolator" title="例 8.5. Using a custom MessageInterpolator">例 8.5 “Using a custom MessageInterpolator”</a>.</p><div class="example"><a id="example-using-custom-message-interpolator"/><p class="title"><b>例 8.5. Using a custom <code class="classname">MessageInterpolator</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">MessageInterpolator</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;interpolate</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;messageTemplate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Context</span><span class="java_plain">&nbsp;context</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;interpolate</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;messageTemplate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Context</span><span class="java_plain">&nbsp;context</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Locale</span><span class="java_plain">&nbsp;locale</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e4245"/>8.2.2. <code class="classname">TraversableResolver</code></h3></div></div></div><p>In some cases the validation engine should not access the state of a bean property. The most obvious example for that is a lazily loaded property or association of a JPA entity. Validating this lazy property or association would mean that its state would have to be accessed, triggering a load from the database.</p><p>Which properties can be accessed and which ones not is controlled by querying the <code class="classname">TraversableResolver</code> interface. <a class="xref" href="#example-using-custom-traversable-resolver" title="例 8.6. Using a custom TraversableResolver">例 8.6 “Using a custom TraversableResolver”</a> shows how to use a custom traversable resolver implementation.</p><div class="example"><a id="example-using-custom-traversable-resolver"/><p class="title"><b>例 8.6. Using a custom <code class="classname">TraversableResolver</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">TraversableResolver</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isReachable</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Object</span><span class="java_plain">&nbsp;traversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Node</span><span class="java_plain">&nbsp;traversableProperty</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;rootBeanType</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_plain">&nbsp;pathToTraversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ElementType</span><span class="java_plain">&nbsp;elementType</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isCascadable</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Object</span><span class="java_plain">&nbsp;traversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Node</span><span class="java_plain">&nbsp;traversableProperty</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;rootBeanType</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_plain">&nbsp;pathToTraversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ElementType</span><span class="java_plain">&nbsp;elementType</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Hibernate Validator provides two <code class="classname">TraversableResolver</code>s out of the box which will be enabled automatically depending on your environment. The first is <code class="classname">DefaultTraversableResolver</code> which will always return <code class="literal">true</code> for <code class="methodname">isReachable()</code> and <code class="methodname">isTraversable()</code>. The second is <code class="classname">JPATraversableResolver</code> which gets enabled when Hibernate Validator is used in combination with JPA 2.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e4287"/>8.2.3. <code class="classname">ConstraintValidatorFactory</code></h3></div></div></div><p><code class="classname">ConstraintValidatorFactory</code> is the extension point for customizing how constraint validators are instantiated and released.</p><p>The default <code class="classname">ConstraintValidatorFactory</code> provided by Hibernate Validator requires a public no-arg constructor to instantiate <code class="classname">ConstraintValidator</code> instances (see <a class="xref" href="#section-constraint-validator">第 6.1.2 节 “The constraint validator”</a>). Using a custom <code class="classname">ConstraintValidatorFactory</code> offers for example the possibility to use dependency injection in constraint validator implementations.</p><p>To configure a custom constraint validator factory call <code class="methodname">Configuration#constraintValidatorFactory()</code> (see <a class="xref" href="#example-using-custom-constraint-validator-factory" title="例 8.7. Using a custom ConstraintValidatorFactory">例 8.7 “Using a custom ConstraintValidatorFactory”</a>.</p><div class="example"><a id="example-using-custom-constraint-validator-factory"/><p class="title"><b>例 8.7. Using a custom <code class="classname">ConstraintValidatorFactory</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyConstraintValidatorFactory</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorFactory</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_operator">&lt;</span><span class="java_plain">T&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;?</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_operator">?&gt;&gt;</span><span class="java_plain">&nbsp;T&nbsp;getInstance</span><span class="java_separator">(</span><span class="java_type">Class</span><span class="java_operator">&lt;</span><span class="java_plain">T</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;key</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;releaseInstance</span><span class="java_separator">(</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;?</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_operator">?&gt;</span><span class="java_plain">&nbsp;instance</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraintValidatorFactory</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyConstraintValidatorFactory</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>Any constraint implementations relying on <code class="classname">ConstraintValidatorFactory</code> behaviors specific to an implementation (dependency injection, no no-arg constructor and so on) are not considered portable.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p><code class="classname">ConstraintValidatorFactory</code> implementations should not cache validator instances as the state of each instance can be altered in the <code class="methodname">initialize()</code> method.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-parameter-name-provider"/>8.2.4. <code class="classname">ParameterNameProvider</code></h3></div></div></div><p>In case a method or constructor parameter constraint is violated, the <code class="classname">ParameterNameProvider</code> interface is used to retrieve the parameter's name and make it available to the user via the constraint violation's property path.</p><p>The default implementation returns parameter names in the form <code class="literal">arg0</code>, <code class="literal">arg1</code> etc., while custom implementations could e.g. be based on parameter annotations, debug symbols or a feature for retrieving parameter names at runtime possibly provided by future Java versions.</p><p>Custom <code class="classname">ParameterNameProvider</code> implementations are used as demonstrated in <a class="xref" href="#example-using-custom-parameter-name-provider" title="例 8.8. Using a custom ParameterNameProvider">例 8.8 “Using a custom ParameterNameProvider”</a>.</p><div class="example"><a id="example-using-custom-parameter-name-provider"/><p class="title"><b>例 8.8. Using a custom <code class="classname">ParameterNameProvider</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyParameterNameProvider</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ParameterNameProvider</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getParameterNames</span><span class="java_separator">(</span><span class="java_type">Constructor</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;constructor</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getParameterNames</span><span class="java_separator">(</span><span class="java_type">Method</span><span class="java_plain">&nbsp;method</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">parameterNameProvider</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyParameterNameProvider</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e4371"/>8.2.5. Adding mapping streams</h3></div></div></div><p>As discussed earlier you can configure the constraints applying for your Java beans using XML based constraint mappings.</p><p>Besides the mapping files specified in <code class="filename">META-INF/validation.xml</code> you can add further mappings via <code class="methodname">Configuration#addMapping()</code> (see <a class="xref" href="#example-adding-mapping-streams" title="例 8.9. Adding constraint mapping streams">例 8.9 “Adding constraint mapping streams”</a>). Note that the passed input stream(s) must adhere to the XML schema for constraint mappings presented in <a class="xref" href="#section-mapping-xml-constraints" title="7.2. Mapping constraints via constraint-mappings">第 7.2 节 “Mapping constraints via constraint-mappings”</a>.</p><div class="example"><a id="example-adding-mapping-streams"/><p class="title"><b>例 8.9. Adding constraint mapping streams</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">InputStream</span><!-- <br/> --><span class="java_plain">&nbsp;constraintMapping1&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">...;</span>
<!--  --><br/><span class="java_type">InputStream</span><span class="java_plain">&nbsp;constraintMapping2&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">...;</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Validation</span><span class="java_separator">.</span><span class="java_plain">byDefaultProvider</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constraintMapping1&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constraintMapping2&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>You should close any passed input stream after the validator factory has been created.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-provider-specific-settings"/>8.2.6. Provider-specific settings</h3></div></div></div><p>Via the configuration object returned by <code class="methodname">Validation#byProvider()</code> provider specific options can be configured.</p><p>In case of Hibernate Validator this allows you to enable the fail fast mode and pass one or more programmatic constraint mappings as demonstrated in <a class="xref" href="#example-hibernate-validator-specific-options" title="例 8.10. Setting Hibernate Validator specific options">例 8.10 “Setting Hibernate Validator specific options”</a>.</p><div class="example"><a id="example-hibernate-validator-specific-options"/><p class="title"><b>例 8.10. Setting Hibernate Validator specific options</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">failFast</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">ConstraintMapping</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Alternatively, provider-specific options can be passed via <code class="methodname">Configuration#addProperty()</code>. Hibernate Validator supports enabling the fail fast mode that way, too:</p><div class="example"><a id="example-hibernate-validator-specific-option-via-addproperty"/><p class="title"><b>例 8.11. Enabling a Hibernate Validator specific option via <code class="methodname">addProperty()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;hibernate.validator.fail_fast&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;true&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Refer to <a class="xref" href="#section-fail-fast" title="11.2. Fail fast mode">第 11.2 节 “Fail fast mode”</a> and <a class="xref" href="#section-programmatic-api" title="11.3. Programmatic constraint declaration">第 11.3 节 “Programmatic constraint declaration”</a> to learn more about the fail fast mode and the constraint declaration API.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-configuring-validator"/>8.3. Configuring a <code class="classname">Validator</code></h2></div></div></div><p>When working with a configured validator factory it can occasionally be required to apply a different configuration to a single <code class="classname">Validator</code> instance. <a class="xref" href="#example-using-context" title="例 8.12. Configuring a Validator via usingContext()">例 8.12 “Configuring a Validator via usingContext()”</a> shows how this can be achieved by calling <code class="methodname">ValidatorFactory#usingContext()</code>.</p><div class="example"><a id="example-using-context"/><p class="title"><b>例 8.12. Configuring a <code class="classname">Validator</code> via <code class="methodname">usingContext()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">usingContext</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-metadata-api"/>第 9 章 Using constraint metadata</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#d0e4477">9.1. BeanDescriptor</a></span></dt><dt><span class="section"><a href="#section-property-descriptor">9.2. PropertyDescriptor</a></span></dt><dt><span class="section"><a href="#d0e4630">9.3. MethodDescriptor and ConstructorDescriptor</a></span></dt><dt><span class="section"><a href="#validator-metadata-api-elementdescriptor">9.4. ElementDescriptor</a></span></dt><dt><span class="section"><a href="#section-group-conversion-descriptor">9.5. GroupConversionDescriptor</a></span></dt><dt><span class="section"><a href="#section-constraint-descriptor">9.6. ConstraintDescriptor</a></span></dt></dl></div><p>The Bean Validation specification provides not only a validation engine, but also an API for retrieving constraint metadata in a uniform way, no matter whether the constraints are declared using annotations or via XML mappings. Read this chapter to learn more about this API and its possibilities. You can find all the metadata API types in the package <span class="package">javax.validation.metadata</span>.</p><p>The examples presented in this chapter are based on the classes and constraint declarations shown in <a class="xref" href="#metadata-example-car" title="例 9.1. Example classes">例 9.1 “Example classes”</a>.</p><div class="example"><a id="metadata-example-car"/><p class="title"><b>例 9.1. Example classes</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter07</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Basic</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Vehicle</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">Basic</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_separator">(</span><span class="java_plain">groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_separator">.</span><span class="java_type">Basic</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getManufacturer</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">ValidCar</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">SeverityInfo</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;modelName</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;modelName</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">driver&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">modelName&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;modelName</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;driveAway</span><span class="java_separator">(</span><span class="java_plain">@</span><span class="java_type">Max</span><span class="java_separator">(</span><span class="java_literal">75</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;speed</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">LuggageCountMatchesPassengerCount</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;piecesOfLuggagePerPassenger&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validationAppliesTo&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintTarget</span><span class="java_separator">.</span><span class="java_plain">PARAMETERS</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">SeverityInfo</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;There&nbsp;must&nbsp;not&nbsp;be&nbsp;more&nbsp;than&nbsp;{piecesOfLuggagePerPassenger}&nbsp;pieces&nbsp;of&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;luggage&nbsp;per&nbsp;passenger.&quot;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;load</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">PieceOfLuggage</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;luggage</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">3</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setManufacturer</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ConvertGroup</span><span class="java_separator">(</span><span class="java_plain">from&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;to&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">.</span><span class="java_type">Basic</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;getDriver</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">further&nbsp;getters&nbsp;and&nbsp;setters</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e4477"/>9.1. <code class="classname"><a id="section-bean-descriptor"/>BeanDescriptor</code></h2></div></div></div><p>The entry point into the metadata API is the method <code class="code">Validator#getConstraintsForClass()</code>, which returns an instance of the <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/BeanDescriptor.html"><code class="classname">BeanDescriptor</code></a> interface. Using this descriptor, you can obtain metadata for constraints declared directly on the bean itself (class- or property-level), but also retrieve metadata descriptors representing single properties, methods and constructors.</p><p><a class="xref" href="#metadata-example-using-beandescriptor" title="例 9.2. Using BeanDescriptor">例 9.2 “Using BeanDescriptor”</a> demonstrates how to retrieve a <code class="classname">BeanDescriptor</code> for the <code class="classname">Car</code> class and how to use this descriptor in form of assertions.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>If a constraint declaration hosted by the requested class is invalid, a <code class="classname">ValidationException</code> is thrown.</p></div><div class="example"><a id="metadata-example-using-beandescriptor"/><p class="title"><b>例 9.2. Using <code class="classname">BeanDescriptor</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">getValidator</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">BeanDescriptor</span><span class="java_plain">&nbsp;carDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForClass</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">isBeanConstrained</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">one&nbsp;</span><span class="java_keyword">class</span><span class="java_operator">-</span><span class="java_plain">level&nbsp;constraint</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;driver</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">3</span><span class="java_separator">,</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstrainedProperties</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">property&nbsp;has&nbsp;constraint</span>
<!--  --><br/><span class="java_plain">assertNotNull</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">property&nbsp;is&nbsp;marked&nbsp;with&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">assertNotNull</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;driver&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">constraints&nbsp;from&nbsp;getter&nbsp;method&nbsp;in&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;and&nbsp;implementation&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;are&nbsp;returned</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">property&nbsp;is&nbsp;not&nbsp;constrained</span>
<!--  --><br/><span class="java_plain">assertNull</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;modelName&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">driveAway</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_separator">),</span><span class="java_plain">&nbsp;load</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">PieceOfLuggage</span><span class="java_operator">&gt;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstrainedMethods</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">MethodType</span><span class="java_separator">.</span><span class="java_plain">NON_GETTER&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">driveAway</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_separator">),</span><span class="java_plain">&nbsp;getManufacturer</span><span class="java_separator">(),</span><span class="java_plain">&nbsp;getDriver</span><span class="java_separator">(),</span><span class="java_plain">&nbsp;load</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">PieceOfLuggage</span><span class="java_operator">&gt;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">4</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstrainedMethods</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">MethodType</span><span class="java_separator">.</span><span class="java_plain">NON_GETTER</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">MethodType</span><span class="java_separator">.</span><span class="java_plain">GETTER&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">driveAway</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">assertNotNull</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;driveAway&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">getManufacturer</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">assertNotNull</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;getManufacturer&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">setManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;is&nbsp;not&nbsp;constrained</span>
<!--  --><br/><span class="java_plain">assertNull</span><span class="java_separator">(</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;setManufacturer&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstrainedConstructors</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">assertNotNull</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForConstructor</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Person</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>You can determine whether the specified class hosts any class- or property-level constraints via <code class="code">isBeanConstrained()</code>. Method or constructor constraints are not considered by <code class="methodname">isBeanConstrained()</code>.</p><p>The method <code class="code">getConstraintDescriptors()</code> is common to all descriptors derived from <code class="classname">ElementDescriptor</code> (see <a class="xref" href="#validator-metadata-api-elementdescriptor" title="9.4. ElementDescriptor">第 9.4 节 “ElementDescriptor”</a>) and returns a set of descriptors representing the constraints directly declared on the given element. In case of <code class="classname">BeanDescriptor</code>, the bean's class-level constraints are returned. More details on <code class="classname">ConstraintDescriptor</code> can be found in <a class="xref" href="#section-constraint-descriptor" title="9.6. ConstraintDescriptor">第 9.6 节 “ConstraintDescriptor”</a>.</p><p>Via <code class="methodname">getConstraintsForProperty()</code>, <code class="methodname">getConstraintsForMethod()</code> and <code class="methodname">getConstraintsForConstructor()</code> you can obtain a descriptor representing one given property or executable element, identified by its name and, in case of methods and constructors, parameter types. The different descriptor types returned by these methods are described in the following sections.</p><p>Note that these methods consider constraints declared at super-types according to the rules for constraint inheritance as described in <a class="xref" href="#section-constraint-inheritance" title="2.1.4. Constraint inheritance">第 2.1.4 节 “Constraint inheritance”</a>. An example is the descriptor for the <code class="varname">manufacturer</code> property, which provides access to all constraints defined on <code class="methodname">Vehicle#getManufacturer()</code> and the implementing method <code class="methodname">Car#getManufacturer()</code>. <code class="literal">null</code> is returned in case the specified element does not exist or is not constrained.</p><p>The methods <code class="methodname">getConstrainedProperties()</code>, <code class="methodname">getConstrainedMethods()</code> and <code class="methodname">getConstrainedConstructors()</code> return (potentially empty) sets with all constrained properties, methods and constructors, respectively. An element is considered constrained, if it has at least one constraint or is marked for cascaded validation. When invoking <code class="methodname">getConstrainedMethods()</code>, you can specify the type of the methods to be returned (getters, non-getters or both).</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-property-descriptor"/>9.2. <code class="classname">PropertyDescriptor</code></h2></div></div></div><p>The interface <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/PropertyDescriptor.html"><code class="classname">PropertyDescriptor</code></a> represents one given property of a class. It is transparent whether constraints are declared on a field or a property getter, provided the JavaBeans naming conventions are respected. <a class="xref" href="#metadata-example-using-propertydescriptor" title="例 9.3. Using PropertyDescriptor">例 9.3 “Using PropertyDescriptor”</a> shows how to use the <code class="classname">PropertyDescriptor</code> interface.</p><div class="example"><a id="metadata-example-using-propertydescriptor"/><p class="title"><b>例 9.3. Using <code class="classname">PropertyDescriptor</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">PropertyDescriptor</span><!-- <br/> --><span class="java_plain">&nbsp;licensePlateDescriptor&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;carDescriptor</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getConstraintsForProperty</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_plain">&nbsp;has&nbsp;two&nbsp;constraints</span><span class="java_separator">,</span><span class="java_plain">&nbsp;is&nbsp;not&nbsp;marked&nbsp;with&nbsp;@</span><span class="java_type">Valid</span><span class="java_plain">&nbsp;and&nbsp;defines&nbsp;no&nbsp;group&nbsp;conversions</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licensePlateDescriptor</span><span class="java_separator">.</span><span class="java_plain">getPropertyName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licensePlateDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;licensePlateDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstraints</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;licensePlateDescriptor</span><span class="java_separator">.</span><span class="java_plain">isCascaded</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;licensePlateDescriptor</span><span class="java_separator">.</span><span class="java_plain">getGroupConversions</span><span class="java_separator">().</span><span class="java_plain">isEmpty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">PropertyDescriptor</span><span class="java_plain">&nbsp;driverDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;driver&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_literal">&quot;driver&quot;</span><span class="java_plain">&nbsp;has&nbsp;no&nbsp;constraints</span><span class="java_separator">,</span><span class="java_plain">&nbsp;is&nbsp;marked&nbsp;with&nbsp;@</span><span class="java_type">Valid</span><span class="java_plain">&nbsp;and&nbsp;defines&nbsp;one&nbsp;group&nbsp;conversion</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;driver&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;driverDescriptor</span><span class="java_separator">.</span><span class="java_plain">getPropertyName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;driverDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">isEmpty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;driverDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstraints</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;driverDescriptor</span><span class="java_separator">.</span><span class="java_plain">isCascaded</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;driverDescriptor</span><span class="java_separator">.</span><span class="java_plain">getGroupConversions</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>Using <code class="methodname">getConstrainedDescriptors()</code>, you can retrieve a set of <code class="classname">ConstraintDescriptor</code>s providing more information on the individual constraints of a given property. The method <code class="methodname">isCascaded()</code> returns <code class="literal">true</code>, if the property is marked for cascaded validation (either using the <code class="classname">@Valid</code> annotation or via XML), <code class="literal">false</code> otherwise. Any configured group conversions are returned by <code class="methodname">getGroupConversions()</code>. See <a class="xref" href="#section-group-conversion-descriptor" title="9.5. GroupConversionDescriptor">第 9.5 节 “GroupConversionDescriptor”</a> for more details on <code class="classname">GroupConversionDescriptor</code>.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e4630"/>9.3. <code class="classname">MethodDescriptor</code> and <code class="classname">ConstructorDescriptor</code></h2></div></div></div><p>Constrained methods and constructors are represented by the interfaces <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/MethodDescriptor.html"><code class="classname">MethodDescriptor</code></a> and <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/ConstructorDescriptor.html"><code class="classname">ConstructorDescriptor</code></a>, respectively. <a class="xref" href="#metadata-example-using-methodandconstructordescriptor" title="例 9.4. Using MethodDescriptor and ConstructorDescriptor">例 9.4 “Using MethodDescriptor and ConstructorDescriptor”</a> demonstrates how to work with these descriptors.</p><div class="example"><a id="metadata-example-using-methodandconstructordescriptor"/><p class="title"><b>例 9.4. Using <code class="classname">MethodDescriptor</code> and <code class="classname">ConstructorDescriptor</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">driveAway</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">int</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;has&nbsp;a&nbsp;constrained&nbsp;parameter&nbsp;and&nbsp;an&nbsp;unconstrained&nbsp;</span><!-- <br/> --><span class="java_keyword">return</span><!-- <br/> --><span class="java_plain">&nbsp;value</span>
<!--  --><br/><span class="java_type">MethodDescriptor</span><span class="java_plain">&nbsp;driveAwayDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;driveAway&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">int</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;driveAway&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;driveAwayDescriptor</span><span class="java_separator">.</span><span class="java_plain">getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;driveAwayDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedParameters</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;driveAwayDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedReturnValue</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">always&nbsp;returns&nbsp;an&nbsp;empty&nbsp;set</span><span class="java_separator">;</span><span class="java_plain">&nbsp;constraints&nbsp;are&nbsp;retrievable&nbsp;by&nbsp;navigating&nbsp;to</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">one&nbsp;of&nbsp;the&nbsp;sub</span><span class="java_operator">-</span><span class="java_plain">descriptors</span><span class="java_separator">,</span><span class="java_plain">&nbsp;e</span><span class="java_separator">.</span><span class="java_plain">g</span><span class="java_separator">.</span><span class="java_plain">&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;the&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;value</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;driveAwayDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">isEmpty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">ParameterDescriptor</span><span class="java_plain">&nbsp;speedDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;driveAwayDescriptor</span><span class="java_separator">.</span><span class="java_plain">getParameterDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">get</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_type">The</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;speed&quot;</span><span class="java_plain">&nbsp;parameter&nbsp;is&nbsp;located&nbsp;at&nbsp;index&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;has&nbsp;one&nbsp;constraint&nbsp;and&nbsp;is&nbsp;not&nbsp;cascaded</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">nor&nbsp;does&nbsp;it&nbsp;define&nbsp;group&nbsp;conversions</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;arg0&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;speedDescriptor</span><span class="java_separator">.</span><span class="java_plain">getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;speedDescriptor</span><span class="java_separator">.</span><span class="java_plain">getIndex</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;speedDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;speedDescriptor</span><span class="java_separator">.</span><span class="java_plain">isCascaded</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_keyword">assert</span><span class="java_plain">&nbsp;speedDescriptor</span><span class="java_separator">.</span><span class="java_plain">getGroupConversions</span><span class="java_separator">().</span><span class="java_plain">isEmpty</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">getDriver</span><span class="java_separator">()</span><span class="java_plain">&nbsp;has&nbsp;no&nbsp;constrained&nbsp;parameters&nbsp;but&nbsp;its&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;value&nbsp;is&nbsp;marked&nbsp;</span><span class="java_keyword">for</span><span class="java_plain">&nbsp;cascaded</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">validation&nbsp;and&nbsp;declares&nbsp;one&nbsp;group&nbsp;conversion</span>
<!--  --><br/><span class="java_type">MethodDescriptor</span><span class="java_plain">&nbsp;getDriverDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;getDriver&quot;</span>
<!--  --><br/><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;getDriverDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedParameters</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;getDriverDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedReturnValue</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">ReturnValueDescriptor</span><span class="java_plain">&nbsp;returnValueDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;getDriverDescriptor</span><span class="java_separator">.</span><span class="java_plain">getReturnValueDescriptor</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;returnValueDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">isEmpty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;returnValueDescriptor</span><span class="java_separator">.</span><span class="java_plain">isCascaded</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;returnValueDescriptor</span><span class="java_separator">.</span><span class="java_plain">getGroupConversions</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">load</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">PieceOfLuggage</span><span class="java_operator">&gt;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;has&nbsp;one&nbsp;cross</span><span class="java_operator">-</span><span class="java_plain">parameter&nbsp;constraint</span>
<!--  --><br/><span class="java_type">MethodDescriptor</span><span class="java_plain">&nbsp;loadDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;load&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;loadDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedParameters</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;loadDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedReturnValue</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loadDescriptor</span><span class="java_separator">.</span><span class="java_plain">getCrossParameterDescriptor</span><span class="java_separator">().</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">)</span><span class="java_plain">&nbsp;has&nbsp;one&nbsp;constrained&nbsp;parameter</span>
<!--  --><br/><span class="java_type">ConstructorDescriptor</span><span class="java_plain">&nbsp;constructorDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForConstructor</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Person</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Car&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constructorDescriptor</span><span class="java_separator">.</span><span class="java_plain">getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertFalse</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constructorDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedReturnValue</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constructorDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstrainedParameters</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructorDescriptor</span><span class="java_separator">.</span><span class="java_plain">getParameterDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">get</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p><code class="methodname">getName()</code> returns the name of the given method or constructor. The methods <code class="methodname">hasConstrainedParameters()</code> and <code class="methodname">hasConstrainedReturnValue()</code> can be used to perform a quick check whether an executable element has any parameter constraints (either constraints on single parameters or cross-parameter constraints) or return value constraints.</p><p>Note that any constraints are not directly exposed on <code class="classname">MethodDescriptor</code> and <code class="classname">ConstructorDescriptor</code>, but rather on dedicated descriptors representing an executable's parameters, its return value and its cross-parameter constraints. To get hold of one of these descriptors, invoke <code class="methodname">getParameterDescriptors()</code>, <code class="methodname">getReturnValueDescriptor()</code> or <code class="methodname">getCrossParameterDescriptor()</code>, respectively.</p><p>These descriptors provide access to the element's constraints (<code class="methodname">getConstraintDescriptors()</code>) and, in case of parameters and return value, to its configuration for cascaded validation (<code class="methodname">isValid()</code> and <code class="methodname">getGroupConversions()</code>). For parameters, you also can retrieve the index and the name, as returned by the currently used parameter name provider (see <a class="xref" href="#section-parameter-name-provider" title="8.2.4. ParameterNameProvider">第 8.2.4 节 “ParameterNameProvider”</a>) via <code class="methodname">getName()</code> and <code class="methodname">getIndex()</code>.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>Getter methods following the JavaBeans naming conventions are considered as bean properties but also as constrained methods.</p><p>That means you can retrieve the related metadata either by obtaining a <code class="classname">PropertyDescriptor</code> (e.g. <code class="code">BeanDescriptor.getConstraintsForProperty("foo")</code>) or by examining the return value descriptor of the getter's <code class="classname">MethodDescriptor</code> (e.g. <code class="code">BeanDescriptor.getConstraintsForMethod("getFoo").getReturnValueDescriptor()</code>).</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-metadata-api-elementdescriptor"/>9.4. <code class="classname">ElementDescriptor</code></h2></div></div></div><p>The <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/ElementDescriptor.html"><code class="classname">ElementDiscriptor</code></a> interface is the common base class for the individual descriptor types such as <code class="classname">BeanDescriptor</code>, <code class="classname">PropertyDescriptor</code> etc. Besides <code class="methodname">getConstraintDescriptors()</code> it provides some more methods common to all descriptors.</p><p><code class="code">hasConstraints()</code> allows for a quick check whether an element has any direct constraints (e.g. class-level constraints in case of <code class="classname">BeanDescriptor</code>). <code class="methodname">getElementClass()</code> returns the Java type of the element represented by a given descriptor. More specifically, the method returns</p><div class="itemizedlist"><ul><li><p>the object type when invoked on <code class="classname">BeanDescriptor</code>,</p></li><li><p>the type of a property or parameter when invoked on <code class="classname">PropertyDescriptor</code> or <code class="classname">ParameterDescriptor</code> respectively,</p></li><li><p><code class="classname">Object[].class</code> when invoked on <code class="classname">CrossParameterDescriptor</code>,</p></li><li><p>the return type when invoked on <code class="classname">ConstructorDescriptor</code>, <code class="classname">MethodDescriptor</code> or <code class="classname">ReturnValueDescriptor</code>. <code class="classname">void.class</code> will be returned for methods which don't have a return value.</p></li></ul></div><p><a class="xref" href="#metadata-example-using-elementdescriptor" title="例 9.5. Using ElementDescriptor methods">例 9.5 “Using ElementDescriptor methods”</a> shows how these methods are used.</p><div class="example"><a id="metadata-example-using-elementdescriptor"/><p class="title"><b>例 9.5. Using <code class="classname">ElementDescriptor</code> methods</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">PropertyDescriptor</span><!-- <br/> --><span class="java_plain">&nbsp;manufacturerDescriptor&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;carDescriptor</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getConstraintsForProperty</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstraints</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">getElementClass</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">CrossParameterDescriptor</span><span class="java_plain">&nbsp;loadCrossParameterDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;load&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">).</span><span class="java_plain">getCrossParameterDescriptor</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;loadCrossParameterDescriptor</span><span class="java_separator">.</span><span class="java_plain">hasConstraints</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Object</span><span class="java_separator">[].</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;loadCrossParameterDescriptor</span><span class="java_separator">.</span><span class="java_plain">getElementClass</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>Finally, <code class="classname">ElementDescriptor</code> offers access to the <code class="classname">ConstraintFinder</code> API which allows you to query for constraint metadata in a fine grained way. <a class="xref" href="#example-constraint-finder" title="例 9.6. Usage of ConstraintFinder">例 9.6 “Usage of ConstraintFinder”</a> shows how to retrieve a <code class="classname">ConstraintFinder</code> instance via <code class="methodname">findConstraints()</code> and use the API to query for constraint metadata.</p><div class="example"><a id="example-constraint-finder"/><p class="title"><b>例 9.6. Usage of ConstraintFinder</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">PropertyDescriptor</span><!-- <br/> --><span class="java_plain">&nbsp;manufacturerDescriptor&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;carDescriptor</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getConstraintsForProperty</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_plain">&nbsp;constraints&nbsp;are&nbsp;declared&nbsp;on&nbsp;the&nbsp;getter</span><span class="java_separator">,</span><span class="java_plain">&nbsp;not&nbsp;the&nbsp;field</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">findConstraints</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">declaredOn</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">ElementType</span><span class="java_separator">.</span><span class="java_plain">FIELD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">isEmpty</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;on&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">#getManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;is&nbsp;part&nbsp;of&nbsp;another&nbsp;group</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">findConstraints</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">unorderedAndMatchingGroups</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">@</span><span class="java_type">Size</span><span class="java_plain">&nbsp;on&nbsp;</span><span class="java_type">Car</span><span class="java_plain">#getManufacturer</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">findConstraints</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">lookingAt</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Scope</span><span class="java_separator">.</span><span class="java_plain">LOCAL_ELEMENT&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">@</span><span class="java_type">Size</span><span class="java_plain">&nbsp;on&nbsp;</span><span class="java_type">Car</span><span class="java_plain">#getManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;and&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;on&nbsp;</span><span class="java_type">Vehicle</span><span class="java_plain">#getManufacturer</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">findConstraints</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">lookingAt</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Scope</span><span class="java_separator">.</span><span class="java_plain">HIERARCHY&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_type">Combining</span><span class="java_plain">&nbsp;several&nbsp;filter&nbsp;options</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manufacturerDescriptor</span><span class="java_separator">.</span><span class="java_plain">findConstraints</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">declaredOn</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">ElementType</span><span class="java_separator">.</span><span class="java_plain">METHOD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">lookingAt</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Scope</span><span class="java_separator">.</span><span class="java_plain">HIERARCHY&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">unorderedAndMatchingGroups</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Vehicle</span><span class="java_separator">.</span><span class="java_type">Basic</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>Via <code class="methodname">declaredOn()</code> you can search for <code class="classname">ConstraintDescriptor</code>s declared on certain element types. This is useful to find property constraints declared on either fields or getter methods.</p><p><code class="methodname">unorderedAndMatchingGroups()</code> restricts the resulting constraints to those matching the given validation group(s).</p><p><code class="methodname">lookingAt()</code> allows to distinguish between constraints directly specified on the element (<code class="constant">Scope.LOCAL_ELEMENT</code>) or constraints belonging to the element but hosted anywhere in the class hierarchy (<code class="constant">Scope.HIERARCHY</code>).</p><p>You can also combine the different options as shown in the last example.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>Order is not respected by <code class="methodname">unorderedAndMatchingGroups()</code>, but group inheritance and inheritance via sequence are.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-group-conversion-descriptor"/>9.5. <code class="classname">GroupConversionDescriptor</code></h2></div></div></div><p>All those descriptor types that represent elements which can be subject of cascaded validation (i.e., <code class="classname">PropertyDescriptor</code>, <code class="classname">ParameterDescriptor</code> and <code class="classname">ReturnValueDescriptor</code>) provide access to the element's group conversions via <code class="methodname">getGroupConversions()</code>. The returned set contains a <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/GroupConversionDescriptor.html"><code class="classname">GroupConversionDescriptor</code></a> for each configured conversion, allowing to retrieve source and target groups of the conversion. <a class="xref" href="#metadata-example-using-groupconversiondescriptor" title="例 9.7. Using GroupConversionDescriptor">例 9.7 “Using GroupConversionDescriptor”</a> shows an example.</p><div class="example"><a id="metadata-example-using-groupconversiondescriptor"/><p class="title"><b>例 9.7. Using <code class="classname">GroupConversionDescriptor</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">PropertyDescriptor</span><!-- <br/> --><span class="java_plain">&nbsp;driverDescriptor&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;carDescriptor</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getConstraintsForProperty</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_literal">&quot;driver&quot;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">GroupConversionDescriptor</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;groupConversions&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;driverDescriptor</span><span class="java_separator">.</span><span class="java_plain">getGroupConversions</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groupConversions</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">GroupConversionDescriptor</span><span class="java_plain">&nbsp;groupConversionDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;groupConversions</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groupConversionDescriptor</span><span class="java_separator">.</span><span class="java_plain">getFrom</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">.</span><span class="java_type">Basic</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groupConversionDescriptor</span><span class="java_separator">.</span><span class="java_plain">getTo</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-constraint-descriptor"/>9.6. <code class="classname">ConstraintDescriptor</code></h2></div></div></div><p>Last but not least, the <a class="ulink" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/index.html?javax/validation/metadata/ConstraintDescriptor.html"><code class="classname">ConstraintDescriptor</code></a> interface describes a single constraint together with its composing constraints. Via an instance of this interface you get access to the constraint annotation and its parameters.</p><p><a class="xref" href="#metadata-example-using-constraintdescriptor" title="例 9.8. Using ConstraintDescriptor">例 9.8 “Using ConstraintDescriptor”</a> shows how to retrieve default constraint attributes (such as message template, groups etc.) as well as custom constraint attributes (<code class="varname">piecesOfLuggagePerPassenger</code>) and other metadata such as the constraint's annotation type and its validators from a <code class="classname">ConstraintDescriptor</code>.</p><div class="example"><a id="metadata-example-using-constraintdescriptor"/><p class="title"><b>例 9.8. Using <code class="classname">ConstraintDescriptor</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">descriptor&nbsp;</span><!-- <br/> --><span class="java_keyword">for</span><!-- <br/> --><span class="java_plain">&nbsp;the&nbsp;@</span><!-- <br/> --><span class="java_type">LuggageCountMatchesPassengerCount</span><!-- <br/> --><span class="java_plain">&nbsp;constraint&nbsp;on&nbsp;the</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">load</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">PieceOfLuggage</span><span class="java_operator">&gt;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;method</span>
<!--  --><br/><span class="java_type">ConstraintDescriptor</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;constraintDescriptor&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;carDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintsForMethod</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;load&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_separator">.</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_separator">).</span><span class="java_plain">getCrossParameterDescriptor</span><span class="java_separator">().</span><span class="java_plain">getConstraintDescriptors</span><span class="java_separator">().</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">constraint&nbsp;type</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">LuggageCountMatchesPassengerCount</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getAnnotation</span><span class="java_separator">().</span><span class="java_plain">annotationType</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">standard&nbsp;constraint&nbsp;attributes</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">SeverityInfo</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getPayload</span><span class="java_separator">().</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ConstraintTarget</span><span class="java_separator">.</span><span class="java_plain">PARAMETERS</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getValidationAppliesTo</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getGroups</span><span class="java_separator">().</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;There&nbsp;must&nbsp;not&nbsp;be&nbsp;more&nbsp;than&nbsp;{piecesOfLuggagePerPassenger}&nbsp;pieces&nbsp;of&nbsp;luggage&nbsp;per&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;passenger.&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getMessageTemplate</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">custom&nbsp;constraint&nbsp;attribute</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getAttributes</span><span class="java_separator">().</span><span class="java_plain">get</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;piecesOfLuggagePerPassenger&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">no&nbsp;composing&nbsp;constraints</span>
<!--  --><br/><span class="java_plain">assertTrue</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getComposingConstraints</span><span class="java_separator">().</span><span class="java_plain">isEmpty</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">validator&nbsp;</span><span class="java_keyword">class</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Arrays</span><span class="java_separator">.</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">asList</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">LuggageCountMatchesPassengerCount</span><span class="java_separator">.</span><span class="java_type">Validator</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintDescriptor</span><span class="java_separator">.</span><span class="java_plain">getConstraintValidatorClasses</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-integration"/>第 10 章 Integrating with other frameworks</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#validator-checkconstraints-orm">10.1. ORM集成</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-checkconstraints-db">10.1.1. 与数据库集成校验</a></span></dt><dt><span class="section"><a href="#validator-checkconstraints-orm-hibernateevent">10.1.2. 基于Hibernate事件模型的校验</a></span></dt><dt><span class="section"><a href="#d0e5013">10.1.3. JPA</a></span></dt></dl></dd><dt><span class="section"><a href="#section-presentation-layer">10.2. JSF &amp; Seam</a></span></dt><dt><span class="section"><a href="#section-integration-with-cdi">10.3. CDI</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e5124">10.3.1. Dependency injection</a></span></dt><dt><span class="section"><a href="#d0e5202">10.3.2. Method validation</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e5359">10.4. Java EE</a></span></dt></dl></div><p>Hibernate Validator is intended to be used to implement multi-layered data validation, where constraints are expressed in a single place (the annotated domain model) and checked in various different layers of the application. For this reason there are multiple integration points with other technologies.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-checkconstraints-orm"/>10.1. ORM集成</h2></div></div></div><p>Hibernate Validator不仅能够和Hibernate集成工作, 还能够和任何JPA的实现很好的一起工作.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>When lazy loaded associations are supposed to be validated it is recommended to place the constraint on the getter of the association. Hibernate replaces lazy loaded associations with proxy instances which get initialized/loaded when requested via the getter. If, in such a case, the constraint is placed on field level the actual proxy instance is used which will lead to validation errors.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-checkconstraints-db"/>10.1.1. 与数据库集成校验</h3></div></div></div><p>Out of the box, Hibernate (as of version 3.5.x) will translate the constraints you have defined for your entities into mapping metadata. For example, if a property of your entity is annotated <code class="literal">@NotNull</code>, its columns will be declared as <code class="literal">not null</code> in the DDL schema generated by Hibernate.</p><p>If, for some reason, the feature needs to be disabled, set <code class="literal">hibernate.validator.apply_to_ddl</code> to <code class="literal">false</code>. See also <a class="xref" href="#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a> and <a class="xref" href="#table-custom-constraints" title="表 2.3. Custom constraints">表 2.3 “Custom constraints”</a>.</p><p>你也可以限制这个DDL约束自动生成的特性只应用到一部分实体类. 只需要设置<span class="property">org.hibernate.validator.group.ddl</span>属性, 这个属性的值是你想要应用此特性的实体类的全路径名称, 每个以逗号分隔.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-checkconstraints-orm-hibernateevent"/>10.1.2. 基于Hibernate事件模型的校验</h3></div></div></div><p>Hibernate Annotations (即 Hibernate 3.5.x) 中包含了一个的Hibernate 事件监听器(译注: 请阅读Hibernate Core文档了解Hibernate的事件模型) - <a class="ulink" href="http://fisheye.jboss.org/browse/Hibernate/core/trunk/annotations/src/main/java/org/hibernate/cfg/beanvalidation/BeanValidationEventListener.java"><code class="classname">org.hibernate.cfg.beanvalidation.BeanValidationEventListener</code></a> - 来为Hibernate Validator服务. 当一个<code class="literal">PreInsertEvent</code>, <code class="literal">PreUpdateEvent</code> 或 <code class="classname">PreDeleteEvent</code>事件发生的时候, 这个监听器就可以对该事件所涉及到的实体对象进行校验, 如果校验不通过的话, 则抛出异常. 默认情况下, Hibernate在对每个对象进行保存或者修改操作的时候,都会对其进行校验, 而删除操作则不会. 你可以通过<span class="property">javax.persistence.validation.group.pre-persist</span>, <span class="property">javax.persistence.validation.group.pre-update</span> 和 <span class="property">javax.persistence.validation.group.pre-remove</span>属性来定义对应事件发生的时候, 具体要校验哪(些)个校验组, 这个属性的值是要应用的校验组类的全路径, 使用逗号分隔. <a class="xref" href="#example-beanvalidationeventlistener-config" title="例 10.1. 自定义BeanValidationEvenListener">例 10.1 “自定义BeanValidationEvenListener”</a>显示了这几个属性在Hibernate内部定义的默认值, 所以, 你不需要在你的应用中再重复定义了.</p><p>如果发生了违反约束条件的情况, 该监听器会抛出一个运行时的<code class="classname">ConstraintViolationException</code>异常, 此异常包含了一系列的<code class="literal">ConstraintViolation</code>对象用于描述每个违反了约束条件的情况.</p><p>如果类路径上有Hibernate Validator, 则Hibernate Annotations (或 Hibernate EntityManager)会自动调用它, 如果你想避免这种情况, 可以设置<span class="property">javax.persistence.validation.mode</span>属性为<code class="constant">none</code>.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>如果实体模型上没有定义约束条件, 则不会有任何性能损耗.</p></div><p>如果你想在Hibernate Core中使用上面提到的事件监听器, 则可以在<code class="literal">hibernate.cfg.xml</code>中定义如下的配置信息:</p><div class="example"><a id="example-beanvalidationeventlistener-config"/><p class="title"><b>例 10.1. 自定义<code class="classname">BeanValidationEvenListener</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">hibernate-configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">session-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.persistence.validation.group.pre-persist&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javax.validation.groups.Default</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.persistence.validation.group.pre-update&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;javax.validation.groups.Default</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.persistence.validation.group.pre-remove&quot;</span><span class="xml_tag_symbols">&gt;&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">event</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;pre-update&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">listener</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.cfg.beanvalidation.BeanValidationEventListener&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">event</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">event</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;pre-insert&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">listener</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.cfg.beanvalidation.BeanValidationEventListener&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">event</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">event</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">type</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;pre-delete&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">listener</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.cfg.beanvalidation.BeanValidationEventListener&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">event</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">session-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">hibernate-configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e5013"/>10.1.3. JPA</h3></div></div></div><p>If you are using JPA 2 and Hibernate Validator is in the classpath the JPA2 specification requires that Bean Validation gets enabled. The properties <span class="property">javax.persistence.validation.group.pre-persist</span>, <span class="property">javax.persistence.validation.group.pre-update</span> and <span class="property">javax.persistence.validation.group.pre-remove</span> as described in <a class="xref" href="#validator-checkconstraints-orm-hibernateevent" title="10.1.2. 基于Hibernate事件模型的校验">第 10.1.2 节 “基于Hibernate事件模型的校验”</a> can in this case be configured in <code class="filename">persistence.xml</code>. <code class="filename">persistence.xml</code> also defines a node validation-mode which can be set to <code class="constant">AUTO</code>, <code class="constant">CALLBACK</code>, <code class="constant">NONE</code>. The default is <code class="constant">AUTO</code>.</p><p>对于JPA1来讲, 你需要自己创建和注册Hibernate Validator. 如果你是使用Hibernate EntityManager, 那么你可以把<a class="xref" href="#validator-checkconstraints-orm-hibernateevent" title="10.1.2. 基于Hibernate事件模型的校验">第 10.1.2 节 “基于Hibernate事件模型的校验”</a>中列出来的<code class="classname">BeanValidationEventListener</code>类添加到你的项目中, 然后再手工注册它.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-presentation-layer"/>10.2. JSF &amp; Seam</h2></div></div></div><p>When working with JSF2 or <span class="productname">JBoss Seam</span>™ and Hibernate Validator (Bean Validation) is present in the runtime environment, validation is triggered for every field in the application. <a class="xref" href="#example-jsf2" title="例 10.2. 在JSF2中使用Bean Validation">例 10.2 “在JSF2中使用Bean Validation”</a> shows an example of the f:validateBean tag in a JSF page. The <span class="property">validationGroups</span> attribute is optional and can be used to specify a comma seperated list of validation groups. The default is <code class="classname">javax.validation.groups.Default</code>. For more information refer to the Seam documentation or the JSF 2 specification.</p><div class="example"><a id="example-jsf2"/><p class="title"><b>例 10.2. 在JSF2中使用Bean Validation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">h:form</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><br />
&lt;f:validateBean validationGroups="javax.validation.groups.Default"&gt;<!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">h:inputText</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_plain">#{</span><span class="xml_attribute_name">model.property</span><span class="xml_plain">}&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">h:selectOneRadio</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_plain">#{</span><span class="xml_attribute_name">model.radioProperty</span><span class="xml_plain">}&nbsp;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">&nbsp;...&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">h:selectOneRadio</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;other&nbsp;input&nbsp;components&nbsp;here&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><br />
&lt;/f:validateBean&gt;<!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">h:form</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>The integration between JSF 2 and Bean Validation is described in the "Bean Validation Integration" chapter of <a class="ulink" href="http://jcp.org/en/jsr/detail?id=314">JSR-314</a>. It is interesting to know that JSF 2 implements a custom <code class="classname">MessageInterpolator</code> to ensure ensure proper localization. To encourage the use of the Bean Validation message facility, JSF 2 will per default only display the generated Bean Validation message. This can, however, be configured via the application resource bundle by providing the following configuration (<em class="parameter"><code>{0}</code></em> is replaced with the Bean Validation message and <em class="parameter"><code>{1}</code></em> is replaced with the JSF component label):</p><pre class="programlisting">javax.faces.validator.BeanValidator.MESSAGE={1}: {0}</pre><p>The default is:</p><pre class="programlisting">javax.faces.validator.BeanValidator.MESSAGE={0}</pre></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-integration-with-cdi"/>10.3. CDI</h2></div></div></div><p>As of version 1.1, Bean Validation is integrated with CDI (Contexts and Dependency Injection for Java<sup>TM</sup> EE).</p><p>This integration provides CDI managed beans for <code class="classname">Validator</code> and <code class="classname">ValidatorFactory</code> and enables dependency injection in constraint validators as well as custom message interpolators, traversable resolvers, constraint validator factories and parameter name providers.</p><p>Furthermore, parameter and return value constraints on the methods and constructors of CDI managed beans will automatically be validated upon invocation.</p><p>When your application runs on a Jave EE container, this integration is enabled by default. When working with CDI in a Servlet container or in a pure Java SE environment, you can use the CDI portable extension provided by Hibernate Validator. To do so, add the portable extension to your class path as described in <a class="xref" href="#section-getting-started-cdi" title="1.1.2. CDI">第 1.1.2 节 “CDI”</a>.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e5124"/>10.3.1. Dependency injection</h3></div></div></div><p>CDI's dependency injection mechanism makes it very easy to retrieve <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> instances and use them in your managed beans. Just annotate instance fields of your bean with <code class="classname">@javax.inject.Inject</code> as shown in <a class="xref" href="#example-dependency-injection" title="例 10.3. Retrieving validator factory and validator via @Inject">例 10.3 “Retrieving validator factory and validator via @Inject”</a>.</p><div class="example"><a id="example-dependency-injection"/><p class="title"><b>例 10.3. Retrieving validator factory and validator via <code class="classname">@Inject</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ApplicationScoped</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Inject</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Inject</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>The injected beans are the default validator factory and validator instances. In order to configure them - e.g. to use a custom message interpolator - you can use the Bean Validation XML descriptors as discussed in <a class="xref" href="#chapter-xml-configuration" title="第 7 章 Configuring via XML">第 7 章 <i>Configuring via XML</i></a>.</p><p>If you are working with several Bean Validation providers you can make sure that factory and validator from Hibernate Validator are injected by annotating the injection points with the <code class="classname">@HibernateValidator</code> qualifier which is demonstrated in <a class="xref" href="#example-dependency-injection-using-hv" title="例 10.4. Using the @HibernateValidator qualifier annotation">例 10.4 “Using the @HibernateValidator qualifier annotation”</a>.</p><div class="example"><a id="example-dependency-injection-using-hv"/><p class="title"><b>例 10.4. Using the @HibernateValidator qualifier annotation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">qualifier</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ApplicationScoped</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Inject</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">HibernateValidator</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Inject</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">HibernateValidator</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>The fully-qualified name of the qualifier annotation is <code class="classname">org.hibernate.validator.cdi.HibernateValidator</code>. Be sure to not import <code class="classname">org.hibernate.validator.HibernateValidator</code> instead which is the <code class="classname">ValidationProvider</code> implementation used for selecting Hibernate Validator when working with the bootstrapping API (see <a class="xref" href="#section-retrieving-validator-factory-validator" title="8.1. Retrieving ValidatorFactory and Validator">第 8.1 节 “Retrieving ValidatorFactory and Validator”</a>).</p></div><p>Via <code class="classname">@Inject</code> you also can inject dependencies into constraint validators and other Bean Validation objects such as <code class="classname">MessageInterpolator</code> implementations etc.</p><p><a class="xref" href="#example-constraint-validator-injected-bean" title="例 10.5. Constraint validator with injected bean">例 10.5 “Constraint validator with injected bean”</a> demonstrates how an injected CDI bean is used in a <code class="classname">ConstraintValidator</code> implementation to determine whether the given constraint is valid or not. As the example shows, you also can work with the <code class="classname">@PostConstruct</code> and <code class="classname">@PreDestroy</code> callbacks to implement any required construction and destruction logic.</p><div class="example"><a id="example-constraint-validator-injected-bean"/><p class="title"><b>例 10.5. Constraint validator with injected bean</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">injection</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidLicensePlateValidator</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;</span><span class="java_type">ValidLicensePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Inject</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">VehicleRegistry</span><span class="java_plain">&nbsp;vehicleRegistry</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">PostConstruct</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;postConstruct</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">do</span><span class="java_plain">&nbsp;initialization&nbsp;logic</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">PreDestroy</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;preDestroy</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">do</span><span class="java_plain">&nbsp;destruction&nbsp;logic</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;initialize</span><span class="java_separator">(</span><span class="java_type">ValidLicensePlate</span><span class="java_plain">&nbsp;constraintAnnotation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isValid</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorContext</span><span class="java_plain">&nbsp;constraintContext</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;vehicleRegistry</span><span class="java_separator">.</span><span class="java_plain">isValidLicensePlate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;licensePlate&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e5202"/>10.3.2. Method validation</h3></div></div></div><p>The method interception facilities of CDI allow for a very tight integration with Bean Validation's method validation functionality. Just put constraint annotations to the parameters and return values of the executables of your CDI beans and they will be validated automatically before (parameter constraints) and after (return value constraints) a method or constructor is invoked.</p><p>Note that no explicit interceptor binding is required, instead the required method validation interceptor will automatically be registered for all managed beans with constrained methods and constructors.</p><p>You can see an example in <a class="xref" href="#example-cdi-method-validation" title="例 10.6. CDI managed beans with method-level constraints">例 10.6 “CDI managed beans with method-level constraints”</a>.</p><div class="example"><a id="example-cdi-method-validation"/><p class="title"><b>例 10.6. CDI managed beans with method-level constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">methodvalidation</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ApplicationScoped</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;rentCar</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;@</span><span class="java_type">Future</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;startDate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;durationInDays</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getAvailableCars</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">methodvalidation</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">RequestScoped</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentCarRequest</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Inject</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;rentCar</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;customerId</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;startDate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;duration</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">causes&nbsp;</span><span class="java_type">ConstraintViolationException</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rentalStation</span><span class="java_separator">.</span><span class="java_plain">rentCar</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_operator">-</span><span class="java_literal">1</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Here the <code class="classname">RentalStation</code> bean hosts several method constraints. When invoking one of the <code class="classname">RentalStation</code> methods from another bean such as <code class="classname">RentCarRequest</code>, the constraints of the invoked method are automatically validated. If any illegal parameter values are passed as in the example, a <code class="classname">ConstraintViolationException</code> will be thrown by the method interceptor, providing detailed information on the violated constraints. The same is the case if the method's return value violates any return value constraints.</p><p>Similarly, constructor constraints are validated automatically upon invocation. In the example the <code class="classname">RentalStation</code> object returned by the constructor will be validated since the constructor return value is marked with <code class="classname">@Valid</code>.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e5242"/>10.3.2.1. Validated executable types</h4></div></div></div><p>Bean Validation allows for a fine-grained control of the executable types which are automatically validated. By default, constraints on constructors and non-getter methods are validated. Therefore the <code class="classname">@NotNull</code> constraint on the method <code class="classname">RentalStation#getAvailableCars()</code> in <a class="xref" href="#example-cdi-method-validation" title="例 10.6. CDI managed beans with method-level constraints">例 10.6 “CDI managed beans with method-level constraints”</a> gets not validated when the method is invoked.</p><p>You have the following options to configure which types of executables are validated upon invocation:</p><div class="itemizedlist"><ul><li><p>Configure the executable types globally via the XML descriptor <code class="filename">META-INF/validation.xml</code>; see <a class="xref" href="#section-configuration-validation-xml" title="7.1. Configuring the validator factory in validation.xml">第 7.1 节 “Configuring the validator factory in validation.xml”</a> for an example</p></li><li><p>Use the <code class="classname">@ValidateOnExecution</code> annotation on the executable or type level</p></li></ul></div><p>If several sources of configuration are specified for a given executable, <code class="classname">@ValidateOnExecution</code> on the executable level takes precedence over <code class="classname">@ValidateOnExecution</code> on the type level and <code class="classname">@ValidateOnExecution</code> generally takes precedence over the globally configured types in <code class="filename"><code class="filename">META-INF/validation.xml</code></code>.</p><p><a class="xref" href="#example-using-validateonexecution" title="例 10.7. Using @ValidateOnExecution">例 10.7 “Using @ValidateOnExecution”</a> shows how to use the <code class="classname">@ValidateOnExecution</code> annotation:</p><div class="example"><a id="example-using-validateonexecution"/><p class="title"><b>例 10.7. Using <code class="classname">@ValidateOnExecution</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">methodvalidation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">configuration</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ApplicationScoped</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ValidateOnExecution</span><span class="java_separator">(</span><span class="java_plain">type&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ExecutableType</span><span class="java_separator">.</span><span class="java_plain">ALL</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">ValidateOnExecution</span><span class="java_separator">(</span><span class="java_plain">type&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ExecutableType</span><span class="java_separator">.</span><span class="java_plain">NONE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;rentCar</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;@</span><span class="java_type">Future</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;startDate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;durationInDays</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getAvailableCars</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Here the method <code class="methodname">rentCar()</code> won't be validated upon invocation because it is annotated with <code class="classname">@ValidateOnExecution(type = ExecutableType.NONE)</code>. In contrast, the constructor and the method <code class="methodname">getAvailableCars()</code> will be validated due to <code class="classname">@ValidateOnExecution(type = ExecutableType.ALL)</code> being given on the type level. <code class="classname">ExecutableType.ALL</code> is a more compact form for explicitly specifying all the types <code class="classname">CONSTRUCTORS</code>, <code class="classname">GETTER_METHODS</code> and <code class="classname">NON_GETTER_METHODS</code>.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>Executable validation can be turned off globally by specifying <code class="literal">&lt;executable-validation enabled="false"/&gt;</code> in <code class="filename">META-INF/validation.xml</code>. In this case, any <code class="classname">@ValidateOnExecution</code> annotations are ignored.</p></div><p>Note that when a method overrides or implements a super-type method the configuration will be taken from that overridden or implemented method (as given via <code class="classname">@ValidateOnExecution</code> on the method itself or on the super-type). This protects a client of the super-type method from an unexpected alteration of the configuration, e.g. disabling validation of an overridden executable in a sub-type.</p><p>In case a CDI managed bean overrides or implements a super-type method and this super-type method hosts any constraints, it can happen that the validation interceptor is not properly registered with the bean, resulting in the bean's methods not being validated upon invocation. In this case you can specify the executable type IMPLICIT on the sub-class as shown in <a class="xref" href="#example-using-executabletype-implicit" title="例 10.8. Using ExecutableType.IMPLICIT">例 10.8 “Using ExecutableType.IMPLICIT”</a>, which makes sure that all required metadata is discovered an the validation interceptor kicks in when the methods on <code class="classname">ExpressRentalStation</code> are invoked.</p><div class="example"><a id="example-using-executabletype-implicit"/><p class="title"><b>例 10.8. Using <code class="classname">ExecutableType.IMPLICIT</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">methodvalidation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">implicit</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ValidateOnExecution</span><span class="java_separator">(</span><span class="java_plain">type&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ExecutableType</span><span class="java_separator">.</span><span class="java_plain">ALL</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;rentCar</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span><span class="java_plain">&nbsp;@</span><span class="java_type">Future</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;startDate</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;durationInDays</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">cdi</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">methodvalidation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">implicit</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ApplicationScoped</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ValidateOnExecution</span><span class="java_separator">(</span><span class="java_plain">type&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">ExecutableType</span><span class="java_separator">.</span><span class="java_plain">IMPLICIT</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">ExpressRentalStation</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStation</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;rentCar</span><span class="java_separator">(</span><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;startDate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;durationInDays</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e5359"/>10.4. Java EE</h2></div></div></div><p>When your application runs on a Java EE application server such as WildFly, you also can obtain <code class="classname">Validator</code> and <code class="classname">ValidatorFactory</code> instances via <code class="classname">@Resource</code> injection in managed objects such as EJBs etc., as shown in <a class="xref" href="#example-validator-resource-injection" title="例 10.9. Retrieving Validator and ValidatorFactory via @Resource injection">例 10.9 “Retrieving Validator and ValidatorFactory via @Resource injection”</a>.</p><div class="example"><a id="example-validator-resource-injection"/><p class="title"><b>例 10.9. Retrieving <code class="classname">Validator</code> and <code class="classname">ValidatorFactory</code> via <code class="classname">@Resource</code> injection</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter10</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">javaee</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Stateless</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalStationBean</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Resource</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Resource</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>Alternatively you can obtain a validator and a validator factory from JNDI under the names "java:comp/Validator" and "java:comp/ValidatorFactory", respectively.</p><p>Similar to CDI-based injection via <code class="classname">@Inject</code>, these objects represent default validator and validator factory and thus can be configured using the XML descriptor <code class="filename">META-INF/validation.xml</code> (see <a class="xref" href="#chapter-xml-configuration" title="第 7 章 Configuring via XML">第 7 章 <i>Configuring via XML</i></a>).</p><p>When your application is CDI-enabled, the injected objects are CDI-aware as well and e.g. support dependency injection in constraint validators.</p></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-specifics"/>第 11 章 Hibernate Validator Specifics</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#d0e5412">11.1. Public API</a></span></dt><dt><span class="section"><a href="#section-fail-fast">11.2. Fail fast mode</a></span></dt><dt><span class="section"><a href="#section-programmatic-api">11.3. Programmatic constraint declaration</a></span></dt><dt><span class="section"><a href="#section-boolean-constraint-composition">11.4. Boolean composition of constraints</a></span></dt><dt><span class="section"><a href="#d0e5697">11.5. ResourceBundleLocator</a></span></dt></dl></div><p>In this chapter you will learn how to make use of several features provided by Hibernate Validator in addition to the functionality defined by the Bean Validation specification. This includes the fail fast mode, the API for programmatic constraint configuration and the boolean composition of constraints.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Using the features described in the following sections may result in application code which is not portable between Bean Validation providers.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e5412"/>11.1. Public API</h2></div></div></div><p>Let's start, however, with a look at the public API of Hibernate Validator. <a class="xref" href="#validator-public-api" title="表 11.1. Hibernate Validator public API">表 11.1 “Hibernate Validator public API”</a> lists all packages belonging to this API and describes their purpose. Note that when a package is part of the public this is not necessarily true for its sub-packages.</p><div class="table"><a id="validator-public-api"/><p class="title"><b>表 11.1. Hibernate Validator public API</b></p><div class="table-contents"><table summary="Hibernate Validator public API" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>Packages</th><th>Description</th></tr></thead><tbody valign="top"><tr><td valign="top"><span class="package">org.hibernate.validator</span></td><td valign="top">Classes used by the Bean Validation bootstrap mechanism (eg. validation provider, configuration class); For more details see <a class="xref" href="#chapter-bootstrapping" title="第 8 章 Bootstrapping">第 8 章 <i>Bootstrapping</i></a>.</td></tr><tr><td valign="top"><span class="package">org.hibernate.validator.cfg</span>, <span class="package">org.hibernate.validator.cfg.context</span>, <span class="package">org.hibernate.validator.cfg.defs</span></td><td valign="top">Hibernate Validator's fluent API for constraint declaration; In <span class="package">org.hibernate.validator.cfg</span> you will find the <code class="classname">ConstraintMapping</code> interface and in <span class="package">org.hibernate.validator.cfg.defs</span> all constraint definitions. Refer to <a class="xref" href="#section-programmatic-api" title="11.3. Programmatic constraint declaration">第 11.3 节 “Programmatic constraint declaration”</a> for the details.</td></tr><tr><td valign="top"><span class="package">org.hibernate.validator.constraints</span>, <span class="package">org.hibernate.validator.constraints.br</span></td><td valign="top">Some useful custom constraints provided by Hibernate Validator in addition to the built-in constraints defined by the Bean Validation specification; The constraints are described in detail in <a class="xref" href="#validator-defineconstraints-hv-constraints" title="2.3.2. Additional constraints">第 2.3.2 节 “Additional constraints”</a>.</td></tr><tr><td valign="top"><span class="package">org.hibernate.validator.group</span>, <span class="package">org.hibernate.validator.spi.group</span></td><td valign="top">The group sequence provider feature which allows you to define dynamic default group sequences in function of the validated object state; The specifics can be found in <a class="xref" href="#section-default-group-class" title="5.3. Redefining the default group sequence">第 5.3 节 “Redefining the default group sequence”</a>.</td></tr><tr><td valign="top"><span class="package">org.hibernate.validator.messageinterpolation</span>, <span class="package">org.hibernate.validator.resourceloading</span>, <span class="package">org.hibernate.validator.spi.resourceloading</span></td><td valign="top">Classes related to constraint message interpolation; The first package contains Hibernate Validator's default message interpolator, <code class="classname">ResourceBundleMessageInterpolator</code>. The latter two packages provide the<code class="classname"> ResourceBundleLocator</code> SPI for the loading of resource bundles (see <a class="xref" href="#section-resource-bundle-locator" title="4.2.1. ResourceBundleLocator">第 4.2.1 节 “ResourceBundleLocator”</a>) and its default implementation.</td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>The public packages of Hibernate Validator fall into two categories: while the actual API parts are intended to be <span class="emphasis"><em>invoked</em></span> or <span class="emphasis"><em>used</em></span> by clients (e.g. the API for programmatic constraint declaration or the custom constraints), the SPI (service provider interface) packages contain interfaces which are intended to be <span class="emphasis"><em>implemented</em></span> by clients (e.g. <code class="classname">ResourceBundleLocator</code>).</p></div><p>Any packages not listed in that table are internal packages of Hibernate Validator and are not intended to be accessed by clients. The contents of these internal packages can change from release to release without notice, thus possibly breaking any client code relying on it.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-fail-fast"/>11.2. Fail fast mode</h2></div></div></div><p>Using the fail fast mode, Hibernate Validator allows to return from the current validation as soon as the first constraint violation occurs. This can be useful for the validation of large object graphs where you are only interested in a quick check whether there is any constraint violation at all.</p><p><a class="xref" href="#example-using-fail-fast" title="例 11.1. Using the fail fast validation mode">例 11.1 “Using the fail fast validation mode”</a> shows how to bootstrap and use a fail fast enabled validator.</p><div class="example"><a id="example-using-fail-fast"/><p class="title"><b>例 11.1. Using the fail fast validation mode</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter11</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">failfast</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">failFast</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">false</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>Here the validated object actually fails to satisfy both the constraints declared on the <code class="classname">Car</code> class, yet the validation call yields only one <code class="classname">ConstraintViolation</code> since the fail fast mode is enabled.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>There is no guarantee in which order the constraints are evaluated, i.e. it is not deterministic whether the returned violation originates from the <code class="classname">@NotNull</code> or the <code class="classname">@AssertTrue</code> constraint. If required, a deterministic evaluation order can be enforced using group sequences as described in <a class="xref" href="#section-defining-group-sequences" title="5.2. Defining group sequences">第 5.2 节 “Defining group sequences”</a>.</p></div><p>Refer to <a class="xref" href="#section-provider-specific-settings" title="8.2.6. Provider-specific settings">第 8.2.6 节 “Provider-specific settings”</a> to learn about the different ways of enabling the fail fast mode when bootstrapping a validator.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-programmatic-api"/>11.3. Programmatic constraint declaration</h2></div></div></div><p>As per the Bean Validation specification, you can declare constraints using Java annotations and XML based constraint mappings.</p><p>In addition, Hibernate Validator provides a fluent API which allows for the programmatic configuration of constraints. Use cases include the dynamic addition of constraints at runtime depending on some application state or tests where you need entities with different constraints in different scenarios but don't want to implement actual Java classes for each test case.</p><p>By default, constraints added via the fluent API are additive to constraints configured via the standard configuration capabilities. But it is also possible to ignore annotation and XML configured constraints where required.</p><p>The API is centered around the <code class="classname">ConstraintMapping</code> interface. You obtain a new mapping via <code class="classname">HibernateValidatorConfiguration#createConstraintMapping()</code> which you then can configure in a fluent manner as shown in <a class="xref" href="#example-constraint-mapping" title="例 11.2. Programmatic constraint declaration">例 11.2 “Programmatic constraint declaration”</a>.</p><div class="example"><a id="example-constraint-mapping"/><p class="title"><b>例 11.2. Programmatic constraint declaration</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">HibernateValidatorConfiguration</span><!-- <br/> --><span class="java_plain">&nbsp;configuration&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">byProvider</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">HibernateValidator</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">ConstraintMapping</span><span class="java_plain">&nbsp;constraintMapping&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;configuration</span><span class="java_separator">.</span><span class="java_plain">createConstraintMapping</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">constraintMapping</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">property</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNullDef</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">property</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">ignoreAnnotations</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNullDef</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">SizeDef</span><span class="java_separator">().</span><span class="java_plain">min</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">max</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">property</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;rentalStation&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;METHOD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNullDef</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;configuration</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constraintMapping&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre></div></div><br class="example-break"/><p>Constraints can be configured on multiple classes and properties using method chaining. The constraint definition classes <code class="classname">NotNullDef</code> and <code class="classname">SizeDef</code> are helper classes which allow to configure constraint parameters in a type-safe fashion. Definition classes exist for all built-in constraints in the <code class="classname">org.hibernate.validator.cfg.defs</code> package. By calling <code class="methodname">ignoreAnnotations()</code> any constraints configured via annotations or XML are ignored for the given element.</p><p>Having configured the mapping, you must add it back to the configuration object from which you then can obtain a validator factory.</p><p>For custom constraints you can either create your own definition classes extending <code class="classname">ConstraintDef</code> or you can use <code class="classname">GenericConstraintDef</code> as seen in <a class="xref" href="#example-generic-constraint-mapping" title="例 11.3. Programmatic declaration of a custom constraint">例 11.3 “Programmatic declaration of a custom constraint”</a>.</p><div class="example"><a id="example-generic-constraint-mapping"/><p class="title"><b>例 11.3. Programmatic declaration of a custom constraint</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ConstraintMapping</span><!-- <br/> --><span class="java_plain">&nbsp;constraintMapping&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;configuration</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createConstraintMapping</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">constraintMapping</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">property</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;licensePlate&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">GenericConstraintDef</span><span class="java_operator">&lt;</span><span class="java_type">CheckCase</span><span class="java_operator">&gt;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">CheckCase</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">param</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;value&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CaseMode</span><span class="java_separator">.</span><span class="java_plain">UPPER&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span></pre></div></div><br class="example-break"/><p>By invoking <code class="methodname">valid()</code> a member is marked for cascasded validation which is equivalent to annotating it with <code class="classname">@Valid</code>. An example can be seen in <a class="xref" href="#example-cascading-constraints" title="例 11.4. Marking a property for cascaded validation">例 11.4 “Marking a property for cascaded validation”</a>.</p><div class="example"><a id="example-cascading-constraints"/><p class="title"><b>例 11.4. Marking a property for cascaded validation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ConstraintMapping</span><!-- <br/> --><span class="java_plain">&nbsp;constraintMapping&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;configuration</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createConstraintMapping</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">constraintMapping</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">property</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;driver&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNullDef</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">valid</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">property</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;name&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNullDef</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/><p>Not only bean constraints but also method constraints can be configured using the fluent API. As shown in <a class="xref" href="#example-method-constraint-mapping" title="例 11.5. Programmatic declaration of method constraints">例 11.5 “Programmatic declaration of method constraints”</a> methods are identified by their name and parameter types. Having selected a method, you can marke its parameters and/or return value for cascaded validation and add constraints.</p><div class="example"><a id="example-method-constraint-mapping"/><p class="title"><b>例 11.5. Programmatic declaration of method constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ConstraintMapping</span><!-- <br/> --><span class="java_plain">&nbsp;constraintMapping&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;configuration</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createConstraintMapping</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">constraintMapping</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">method</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;drive&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">parameter</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MaxDef</span><span class="java_separator">().</span><span class="java_plain">value&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">75</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">method</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;getDriver&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">returnValue</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraint</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">NotNullDef</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">valid</span><span class="java_separator">();</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre></div></div><br class="example-break"/><p>Last but not least you can configure the default group sequence or the default group sequence provider of a type as shown in the following example.</p><div class="example"><a id="example-sequences"/><p class="title"><b>例 11.6. Configuration of default group sequence and default group sequence provider</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ConstraintMapping</span><!-- <br/> --><span class="java_plain">&nbsp;constraintMapping&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;configuration</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createConstraintMapping</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">constraintMapping</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">defaultGroupSequence</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">type</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">defaultGroupSequenceProviderClass</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCarGroupSequenceProvider</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-boolean-constraint-composition"/>11.4. Boolean composition of constraints</h2></div></div></div><p>Bean Validation specificies that the constraints of a composed constraint (see <a class="xref" href="#section-constraint-composition">第 6.4 节 “Constraint composition”</a>) are all combined via a logical <span class="emphasis"><em>AND</em></span>. This means all of the composing constraints need to return <code class="constant">true</code> in order for an overall successful validation.</p><p>Hibernate Validator offers an extension to this and allows you to compose constraints via a logical <span class="emphasis"><em>OR</em></span> or <span class="emphasis"><em>NOT</em></span>. To do so you have to use the <code class="classname">ConstraintComposition</code> annotation and the enum <code class="classname">CompositionType</code> with its values <span class="emphasis"><em>AND</em></span>, <span class="emphasis"><em>OR</em></span> and <span class="emphasis"><em>ALL_FALSE</em></span>.</p><p><a class="xref" href="#example-boolean-constraint-composition" title="例 11.7. OR composition of constraints">例 11.7 “OR composition of constraints”</a> shows how to build a composed constraint <code class="classname">@PatternOrSize</code> where only one of the composing constraints needs to be valid in order to pass the validation. Either the validated string is all lower-cased or it is between two and three characters long.</p><div class="example"><a id="example-boolean-constraint-composition"/><p class="title"><b>例 11.7. OR composition of constraints</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter11</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">booleancomposition</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ConstraintComposition</span><span class="java_separator">(</span><span class="java_plain">OR</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Pattern</span><span class="java_separator">(</span><span class="java_plain">regexp&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;[a-z]&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">3</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">ReportAsSingleViolation</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Target</span><span class="java_separator">({</span><span class="java_plain">&nbsp;METHOD</span><span class="java_separator">,</span><span class="java_plain">&nbsp;FIELD&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Retention</span><span class="java_separator">(</span><span class="java_plain">RUNTIME</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Constraint</span><span class="java_separator">(</span><span class="java_plain">validatedBy&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;@</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">PatternOrSize</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;message</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;{org.hibernate.validator.referenceguide.chapter11.&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;booleancomposition.PatternOrSize.message}&quot;</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;groups</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Payload</span><span class="java_operator">&gt;</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;payload</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_keyword">default</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain">&nbsp;</span><span class="java_separator">};</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>Using <span class="emphasis"><em>ALL_FALSE</em></span> as composition type implicitly enforces that only a single violation will get reported in case validation of the constraint composition fails.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e5697"/>11.5. <code class="classname">ResourceBundleLocator</code></h2></div></div></div><p>As described in <a class="xref" href="#section-custom-message-interpolation" title="4.2. Custom message interpolation">第 4.2 节 “Custom message interpolation”</a>, Bean Validation allows to plug in custom message interpolator implementations.</p><p>With <code class="classname">ResourceBundleLocator</code>, Hibernate Validator provides an additional SPI which allows to retrieve error messages from other resource bundles than <code class="filename">ValidationMessages</code> while still using the actual interpolation algorithm as defined by the specification. Refer to <a class="xref" href="#section-resource-bundle-locator" title="4.2.1. ResourceBundleLocator">第 4.2.1 节 “ResourceBundleLocator”</a> to learn how to make use of that SPI.</p></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-annotation-processor"/>第 12 章 Annotation Processor</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="#validator-annotationprocessor-prerequisites">12.1. Prerequisites</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-features">12.2. Features</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-options">12.3. Options</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-usage">12.4. Using the Annotation Processor</a></span></dt><dd><dl><dt><span class="section"><a href="#validator-annotationprocessor-commandline">12.4.1. Command line builds</a></span></dt><dt><span class="section"><a href="#validator-annotationprocessor-ide">12.4.2. IDE builds</a></span></dt></dl></dd><dt><span class="section"><a href="#validator-annotationprocessor-known-issues">12.5. Known issues</a></span></dt></dl></div><p>Have you ever caught yourself by unintentionally doing things like</p><div class="itemizedlist"><ul><li><p>specifying constraint annotations at unsupported data types (e.g. by annotating a String with <code class="classname">@Past</code>)</p></li><li><p>annotating the setter of a JavaBeans property (instead of the getter method)</p></li><li><p>annotating static fields/methods with constraint annotations (which is not supported)?</p></li></ul></div><p>Then the Hibernate Validator Annotation Processor is the right thing for you. It helps preventing such mistakes by plugging into the build process and raising compilation errors whenever constraint annotations are incorrectly used.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>You can find the Hibernate Validator Annotation Processor as part of the distribution bundle on <a class="ulink" href="http://sourceforge.net/projects/hibernate/files/hibernate-validator">Sourceforge</a> or in the usual Maven repositories such as Maven Central under the GAV org.hibernate:hibernate-validator-annotation-processor:5.0.1.Final.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-annotationprocessor-prerequisites"/>12.1. Prerequisites</h2></div></div></div><p>The Hibernate Validator Annotation Processor is based on the "Pluggable Annotation Processing API" as defined by <a class="ulink" href="http://jcp.org/en/jsr/detail?id=269">JSR 269</a> which is part of the Java Platform since Java 6.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-annotationprocessor-features"/>12.2. Features</h2></div></div></div><p>As of Hibernate Validator 5.0.1.Final the Hibernate Validator Annotation Processor checks that:</p><div class="itemizedlist"><ul><li><p>constraint annotations are allowed for the type of the annotated element</p></li><li><p>only non-static fields or methods are annotated with constraint annotations</p></li><li><p>only non-primitive fields or methods are annotated with <code class="classname">@Valid</code></p></li><li><p>only such methods are annotated with constraint annotations which are valid JavaBeans getter methods (optionally, see below)</p></li><li><p>only such annotation types are annotated with constraint annotations which are constraint annotations themselves</p></li><li><p>definition of dynamic default group sequence with <code class="classname">@GroupSequenceProvider</code> is valid</p></li></ul></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-annotationprocessor-options"/>12.3. Options</h2></div></div></div><p>The behavior of the Hibernate Validator Annotation Processor can be controlled using the <a class="ulink" href="http://java.sun.com/javase/6/docs/technotes/tools/windows/javac.html#options">processor options</a> listed in table <a class="xref" href="#table_processor_options" title="表 12.1. Hibernate Validator Annotation Processor options">表 12.1 “Hibernate Validator Annotation Processor options”</a>:</p><div class="table"><a id="table_processor_options"/><p class="title"><b>表 12.1. Hibernate Validator Annotation Processor options</b></p><div class="table-contents"><table summary="Hibernate Validator Annotation Processor options" border="1"><colgroup><col/><col/></colgroup><thead><tr><th align="center">Option</th><th align="center">Explanation</th></tr></thead><tbody><tr><td><code class="varname">diagnosticKind</code></td><td>Controls how constraint problems are reported. Must be the string representation of one of the values from the enum <code class="classname">javax.tools.Diagnostic.Kind</code>, e.g. <code class="classname">WARNING</code>. A value of <code class="classname">ERROR</code> will cause compilation to halt whenever the AP detects a constraint problem. Defaults to <code class="classname">ERROR</code>.</td></tr><tr><td><code class="varname">methodConstraintsSupported</code></td><td>Controls whether constraints are allowed at methods of any kind. Must be set to <code class="varname">true</code> when working with method level constraints as supported by Hibernate Validator. Can be set to <code class="varname">false</code> to allow constraints only at JavaBeans getter methods as defined by the Bean Validation API. Defaults to <code class="varname">true</code>.</td></tr><tr><td><code class="varname">verbose</code></td><td>Controls whether detailed processing information shall be displayed or not, useful for debugging purposes. Must be either <code class="varname">true</code> or <code class="varname">false</code>. Defaults to <code class="varname">false</code>.</td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-annotationprocessor-usage"/>12.4. Using the Annotation Processor</h2></div></div></div><p>This section shows in detail how to integrate the Hibernate Validator Annotation Processor into command line builds (javac, Ant, Maven) as well as IDE-based builds (Eclipse, IntelliJ IDEA, NetBeans).</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-annotationprocessor-commandline"/>12.4.1. Command line builds</h3></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="validator-annotationprocessor-javac"/>12.4.1.1. javac</h4></div></div></div><p>When compiling on the command line using <a class="ulink" href="http://java.sun.com/javase/6/docs/technotes/guides/javac/index.html">javac</a>, specify the JAR hibernate-validator-annotation-processor-5.0.1.Final.jar using the "processorpath" option as shown in the following listing. The processor will be detected automatically by the compiler and invoked during compilation.</p><div class="example"><a id="d0e5864"/><p class="title"><b>例 12.1. Using the annotation processor with javac</b></p><div class="example-contents"><pre class="programlisting">javac src/main/java/org/hibernate/validator/ap/demo/Car.java \
   -cp /path/to/validation-api-1.1.0.Final.jar \
   -processorpath /path/to/hibernate-validator-annotation-processor-5.0.1.Final.jar</pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="validator-annotationprocessor-ant"/>12.4.1.2. Apache Ant</h4></div></div></div><p>Similar to directly working with javac, the annotation processor can be added as as compiler argument when invoking the <a class="ulink" href="http://ant.apache.org/manual/CoreTasks/javac.html">javac task</a> for <a class="ulink" href="http://ant.apache.org/">Apache Ant</a>:</p><div class="example"><a id="d0e5880"/><p class="title"><b>例 12.2. Using the annotation processor with Ant</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">javac</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">srcdir</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;src/main&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">destdir</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;build/classes&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">classpath</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/path/to/validation-api-1.1.0.Final.jar&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">compilerarg</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;-processorpath&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">compilerarg</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;/path/to/hibernate-validator-annotation-processor-5.0.1.Final.jar&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">javac</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e5885"/>12.4.1.3. Maven</h4></div></div></div><p>There are several options for integrating the annotation processor with <a class="ulink" href="http://maven.apache.org/">Apache Maven</a>. Generally it is sufficient to add the Hibernate Validator Annotation Processor as dependency to your project:</p><div class="example"><a id="d0e5893"/><p class="title"><b>例 12.3. Adding the HV Annotation Processor as dependency</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain">...</span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">hibernate-validator-annotation-processor</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">5.0.1.Final</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
</pre></div></div><br class="example-break"/><p>The processor will then be executed automatically by the compiler. This basically works, but comes with the disadavantage that in some cases messages from the annotation processor are not displayed (see <a class="ulink" href="http://jira.codehaus.org/browse/MCOMPILER-66">MCOMPILER-66</a>).</p><p>Another option is using the <a class="ulink" href="http://code.google.com/p/maven-annotation-plugin/">Maven Annotation Plugin</a>. To work with this plugin, disable the standard annotation processing performed by the compiler plugin and configure the annotation plugin by specifying an execution and adding the Hibernate Validator Annotation Processor as plugin dependency (that way the processor is not visible on the project's actual classpath):</p><div class="example"><a id="d0e5908"/><p class="title"><b>例 12.4. Configuring the Maven Annotation Plugin</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain">...</span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">plugin</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">maven-compiler-plugin</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">source</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">1.6</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">source</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">target</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">1.6</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">target</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">compilerArgument</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">-proc:none</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">compilerArgument</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">plugin</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">plugin</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.bsc.maven</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">maven-processor-plugin</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">2.2.1</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">executions</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">execution</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">id</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">process</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">id</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">goals</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">goal</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">process</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">goal</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">goals</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">phase</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">process-sources</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">phase</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">execution</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">executions</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependencies</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groupId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">hibernate-validator-annotation-processor</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">artifactId</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">5.0.1.Final</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">version</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependency</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">dependencies</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">plugin</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
</pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-annotationprocessor-ide"/>12.4.2. IDE builds</h3></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e5916"/>12.4.2.1. Eclipse</h4></div></div></div><p>Do the following to use the annotation processor within the <a class="ulink" href="http://www.eclipse.org/">Eclipse</a> IDE:</p><div class="itemizedlist"><ul><li><p>Right-click your project, choose "Properties"</p></li><li><p>Go to "Java Compiler" and make sure, that "Compiler compliance level" is set to "1.6". Otherwise the processor won't be activated</p></li><li><p>Go to "Java Compiler - Annotation Processing" and choose "Enable annotation processing"</p></li><li><p>Go to "Java Compiler - Annotation Processing - Factory Path" and add the JAR hibernate-validator-annotation-processor-5.0.1.Final.jar</p></li><li><p>Confirm the workspace rebuild</p></li></ul></div><p>You now should see any annotation problems as regular error markers within the editor and in the "Problem" view:</p><div class="mediaobject" align="center"><img src="annotation_processor_eclipse.png" align="middle"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="validator-annotationprocessor-idea"/>12.4.2.2. IntelliJ IDEA</h4></div></div></div><p>The following steps must be followed to use the annotation processor within <a class="ulink" href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a> (version 9 and above):</p><div class="itemizedlist"><ul><li><p>Go to "File", then "Settings",</p></li><li><p>Expand the node "Compiler", then "Annotation Processors"</p></li><li><p>Choose "Enable annotation processing" and enter the following as "Processor path": /path/to/hibernate-validator-annotation-processor-5.0.1.Final.jar</p></li><li><p>Add the processor's fully qualified name <code class="classname">org.hibernate.validator.ap.ConstraintValidationProcessor</code> to the "Annotation Processors" list</p></li><li><p>If applicable add you module to the "Processed Modules" list</p></li></ul></div><p>Rebuilding your project then should show any erronous constraint annotations:</p><div class="mediaobject" align="center"><img src="annotation_processor_intellij.png" align="middle"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="validator-annotationprocessor-netbeans"/>12.4.2.3. NetBeans</h4></div></div></div><p>Starting with version 6.9, also the <a class="ulink" href="http://www.netbeans.org/">NetBeans</a> IDE supports using annotation processors within the IDE build. To do so, do the following:</p><div class="itemizedlist"><ul><li><p>Right-click your project, choose "Properties"</p></li><li><p>Go to "Libraries", tab "Processor", and add the JAR hibernate-validator-annotation-processor-5.0.1.Final.jar</p></li><li><p>Go to "Build - Compiling", select "Enable Annotation Processing" and "Enable Annotation Processing in Editor". Add the annotation processor by specifying its fully qualified name <code class="classname">org.hibernate.validator.ap.ConstraintValidationProcessor</code></p></li></ul></div><p>Any constraint annotation problems will then be marked directly within the editor:</p><div class="mediaobject" align="center"><img src="annotation_processor_netbeans.png" align="middle"/></div></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-annotationprocessor-known-issues"/>12.5. Known issues</h2></div></div></div><p>The following known issues exist as of May 2010:</p><div class="itemizedlist"><ul><li><p><a class="ulink" href="http://opensource.atlassian.com/projects/hibernate/browse/HV-308">HV-308</a>: Additional validators registered for a constraint <a class="ulink" href="http://docs.jboss.org/hibernate/stable/validator/reference/en/html_single/#d0e1957">using XML</a> are not evaluated by the annotation processor.</p></li><li><p>Sometimes custom constraints can't be <a class="ulink" href="http://opensource.atlassian.com/projects/hibernate/browse/HV-293">properly evaluated</a> when using the processor within Eclipse. Cleaning the project can help in these situations. This seems to be an issue with the Eclipse JSR 269 API implementation, but further investigation is required here.</p></li><li><p>When using the processor within Eclipse, the check of dynamic default group sequence definitions doesn't work. After further investigation, it seems to be an issue with the Eclipse JSR 269 API implementation.</p></li></ul></div></div></div><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-further-reading"/>第 13 章 Further reading</h2></div></div></div><p>Last but not least, a few pointers to further information.</p><p>A great source for examples is the Bean Validation TCK which is available for anonymous access on <a class="ulink" href="https://github.com/beanvalidation/beanvalidation-tck">GitHub</a>. In particular the TCK's <a class="ulink" href="https://github.com/beanvalidation/beanvalidation-tck/tree/1.1.0.Final/tests">tests</a> might be of interest. <a class="ulink" href="http://beanvalidation.org/1.1/spec/1.1.0.cr3">The JSR 349</a> specification itself is also a great way to deepen your understanding of Bean Validation resp. Hibernate Validator.</p><p>If you have any further questions to Hibernate Validator or want to share some of your use cases have a look at the <a class="ulink" href="http://community.jboss.org/en/hibernate/validator">Hibernate Validator Wiki</a> and the <a class="ulink" href="https://forum.hibernate.org/viewforum.php?f=9">Hibernate Validator Forum</a>.</p><p>In case you would like to report a bug use <a class="ulink" href="http://opensource.atlassian.com/projects/hibernate/browse/HV">Hibernate's Jira</a> instance. Feedback is always welcome!</p></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">版权 © 2009 - 2013 Red Hat, Inc. &amp; Gunnar Morling</p></a></body></html>