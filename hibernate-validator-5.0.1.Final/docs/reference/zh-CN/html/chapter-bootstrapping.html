<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">第 8 章 Bootstrapping</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Hibernate Validator"/><link rel="up" href="index.html" title="Hibernate Validator"/><link rel="prev" href="chapter-xml-configuration.html" title="第 7 章 Configuring via XML"/><link rel="next" href="validator-metadata-api.html" title="第 9 章 Using constraint metadata"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="chapter-xml-configuration.html"><strong>上一页</strong></a></li><li class="next"><a accesskey="n" href="validator-metadata-api.html"><strong>下一页</strong></a></li></ul><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="chapter-bootstrapping"/>第 8 章 Bootstrapping</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="chapter-bootstrapping.html#section-retrieving-validator-factory-validator">8.1. Retrieving ValidatorFactory and Validator</a></span></dt><dd><dl><dt><span class="section"><a href="chapter-bootstrapping.html#section-validation-provider-resolver">8.1.1. ValidationProviderResolver</a></span></dt></dl></dd><dt><span class="section"><a href="chapter-bootstrapping.html#section-configuring-validator-factory">8.2. Configuring a ValidatorFactory</a></span></dt><dd><dl><dt><span class="section"><a href="chapter-bootstrapping.html#section-validator-factory-message-interpolator">8.2.1. MessageInterpolator</a></span></dt><dt><span class="section"><a href="chapter-bootstrapping.html#d0e4245">8.2.2. TraversableResolver</a></span></dt><dt><span class="section"><a href="chapter-bootstrapping.html#d0e4287">8.2.3. ConstraintValidatorFactory</a></span></dt><dt><span class="section"><a href="chapter-bootstrapping.html#section-parameter-name-provider">8.2.4. ParameterNameProvider</a></span></dt><dt><span class="section"><a href="chapter-bootstrapping.html#d0e4371">8.2.5. Adding mapping streams</a></span></dt><dt><span class="section"><a href="chapter-bootstrapping.html#section-provider-specific-settings">8.2.6. Provider-specific settings</a></span></dt></dl></dd><dt><span class="section"><a href="chapter-bootstrapping.html#section-configuring-validator">8.3. Configuring a Validator</a></span></dt></dl></div><p>In <a class="xref" href="chapter-bean-constraints.html#section-obtaining-validator" title="2.2.1. Obtaining a Validator instance">第 2.2.1 节 “Obtaining a Validator instance”</a> you already saw one way for creating a <code class="classname">Validator</code> instance - via <code class="methodname">Validation#buildDefaultValidatorFactory()</code>. In this chapter you will learn how to use the other methods in <code class="classname">javax.validation.Validation</code> in order to bootstrap specifically configured validators.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-retrieving-validator-factory-validator"/>8.1. Retrieving <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code></h2></div></div></div><p>You obtain a <code class="classname">Validator</code> by retrieving a <code class="classname">ValidatorFactory</code> via one of the static methods on <code class="classname">javax.validation.Validation</code> and calling <code class="classname">getValidator()</code> on the factory instance.</p><p><a class="xref" href="chapter-bootstrapping.html#example-build-default-validator-factory" title="例 8.1. Bootstrapping default ValidatorFactory and Validator">例 8.1 “Bootstrapping default ValidatorFactory and Validator”</a> shows how to obtain a validator from the default validator factory:</p><div class="example"><a id="example-build-default-validator-factory"/><p class="title"><b>例 8.1. Bootstrapping default <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>The generated <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> instances are thread-safe and can be cached. As Hibernate Validator uses the factory as context for caching constraint metadata it is recommended to work with one factory instance within an application.</p></div><p>Bean Validation supports working with several providers such as Hibernate Validator within one application. If more than one provider is present on the classpath, it is not guaranteed which one is chosen when creating a factory via <code class="methodname">buildDefaultValidatorFactory()</code>.</p><p>In this case you can explicitly specify the provider to use via <code class="methodname">Validation#byProvider()</code>, passing the provider's <code class="classname">ValidationProvider</code> class as shown in <a class="xref" href="chapter-bootstrapping.html#example-using-specific-provider" title="例 8.2. Bootstrapping ValidatorFactory and Validator using a specific provider">例 8.2 “Bootstrapping ValidatorFactory and Validator using a specific provider”</a>.</p><div class="example"><a id="example-using-specific-provider"/><p class="title"><b>例 8.2. Bootstrapping <code class="classname">ValidatorFactory</code> and <code class="classname">Validator</code> using a specific provider</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Note that the configuration object returned by <code class="methodname">configure()</code> allows to specifically customize the factory before calling <code class="methodname">buildValidatorFactory()</code>. The available options are discussed later in this chapter.</p><p>Similarly you can retrieve the default validator factory for configuration which is demonstrated in <a class="xref" href="chapter-bootstrapping.html#example-configuring-default-provider" title="例 8.3. Retrieving the default ValidatorFactory for configuration">例 8.3 “Retrieving the default ValidatorFactory for configuration”</a>.</p><div class="example"><a id="example-configuring-default-provider"/><p class="title"><b>例 8.3. Retrieving the default <code class="classname">ValidatorFactory</code> for configuration</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>If a <code class="classname">ValidatorFactory</code> instance is no longer in use, it should be disposed by calling <code class="methodname">ValidatorFactory#close()</code>. This will free any resources possibly allocated by the factory.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-validation-provider-resolver"/>8.1.1. <code class="classname">ValidationProviderResolver</code></h3></div></div></div><p>By default, available Bean Validation providers are discovered using the <a class="ulink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/jar/jar.html#Service%20Provider">Java Service Provider</a> mechanism.</p><p>For that purpose, each provider includes the file <code class="filename">META-INF/services/javax.validation.spi.ValidationProvider</code>, containing the fully qualified classname of its <code class="classname">ValidationProvider</code> implementation. In the case of Hibernate Validator this is <code class="classname">org.hibernate.validator.HibernateValidator</code>.</p><p>Depending on your environment and its classloading specifics, provider discovery via the Java's service loader mechanism might not work. In this case you can plug in a custom <code class="classname">ValidationProviderResolver</code> implementation which performs the provider retrieval. An example is OSGi, where you could implement a provider resolver which uses OSGi services for provider discovery.</p><p>To use a custom provider resolver pass it via <code class="methodname">providerResolver()</code> as shown shown in <a class="xref" href="chapter-bootstrapping.html#example-using-custom-validation-provider-resolver" title="例 8.4. Using a custom ValidationProviderResolver">例 8.4 “Using a custom ValidationProviderResolver”</a>.</p><div class="example"><a id="example-using-custom-validation-provider-resolver"/><p class="title"><b>例 8.4. Using a custom <code class="classname">ValidationProviderResolver</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">OsgiServiceDiscoverer</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ValidationProviderResolver</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">ValidationProvider</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;getValidationProviders</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">providerResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">OsgiServiceDiscoverer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-configuring-validator-factory"/>8.2. Configuring a <code class="classname">ValidatorFactory</code></h2></div></div></div><p>By default validator factories retrieved from <code class="classname">Validation</code> and any validators they create are configured as per the XML descriptor <code class="filename">META-INF/validation.xml</code> (see <a class="xref" href="chapter-xml-configuration.html" title="第 7 章 Configuring via XML">第 7 章 <i>Configuring via XML</i></a>), if present.</p><p>If you want to disable the XML based configuration, you can do so by invoking <code class="methodname">Configuration#ignoreXmlConfiguration()</code>.</p><p>The different values of the XML configuration can be accessed via <code class="methodname">Configuration#getBootstrapConfiguration()</code>. This can for instance be helpful if you want to integrate Bean Validation into a managed environment and want to create managed instances of the objects configured via XML.</p><p>Using the fluent configuration API, you can override one or more of the settings when bootstrapping the factory. The following sections show how to make use of the different options. Note that the <code class="classname">Configuration</code> class exposes the default implementations of the different extension points which can be useful if you want to use these as delegates for your custom implementations.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-validator-factory-message-interpolator"/>8.2.1. <code class="classname">MessageInterpolator</code></h3></div></div></div><p>Message interpolators are used by the validation engine to create user readable error messages from constraint message descriptors.</p><p>In case the default message interpolation algorithm described in <a class="xref" href="chapter-message-interpolation.html" title="第 4 章 Interpolating constraint error messages">第 4 章 <i>Interpolating constraint error messages</i></a> is not sufficient for your needs, you can pass in your own implementation of the <code class="classname">MessageInterpolator</code> interface via <code class="classname">Configuration#messageInterpolator()</code> as shown in <a class="xref" href="chapter-bootstrapping.html#example-using-custom-message-interpolator" title="例 8.5. Using a custom MessageInterpolator">例 8.5 “Using a custom MessageInterpolator”</a>.</p><div class="example"><a id="example-using-custom-message-interpolator"/><p class="title"><b>例 8.5. Using a custom <code class="classname">MessageInterpolator</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">MessageInterpolator</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;interpolate</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;messageTemplate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Context</span><span class="java_plain">&nbsp;context</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;interpolate</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;messageTemplate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Context</span><span class="java_plain">&nbsp;context</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Locale</span><span class="java_plain">&nbsp;locale</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e4245"/>8.2.2. <code class="classname">TraversableResolver</code></h3></div></div></div><p>In some cases the validation engine should not access the state of a bean property. The most obvious example for that is a lazily loaded property or association of a JPA entity. Validating this lazy property or association would mean that its state would have to be accessed, triggering a load from the database.</p><p>Which properties can be accessed and which ones not is controlled by querying the <code class="classname">TraversableResolver</code> interface. <a class="xref" href="chapter-bootstrapping.html#example-using-custom-traversable-resolver" title="例 8.6. Using a custom TraversableResolver">例 8.6 “Using a custom TraversableResolver”</a> shows how to use a custom traversable resolver implementation.</p><div class="example"><a id="example-using-custom-traversable-resolver"/><p class="title"><b>例 8.6. Using a custom <code class="classname">TraversableResolver</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">TraversableResolver</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isReachable</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Object</span><span class="java_plain">&nbsp;traversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Node</span><span class="java_plain">&nbsp;traversableProperty</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;rootBeanType</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_plain">&nbsp;pathToTraversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ElementType</span><span class="java_plain">&nbsp;elementType</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isCascadable</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Object</span><span class="java_plain">&nbsp;traversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Node</span><span class="java_plain">&nbsp;traversableProperty</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;rootBeanType</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_plain">&nbsp;pathToTraversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ElementType</span><span class="java_plain">&nbsp;elementType</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Hibernate Validator provides two <code class="classname">TraversableResolver</code>s out of the box which will be enabled automatically depending on your environment. The first is <code class="classname">DefaultTraversableResolver</code> which will always return <code class="literal">true</code> for <code class="methodname">isReachable()</code> and <code class="methodname">isTraversable()</code>. The second is <code class="classname">JPATraversableResolver</code> which gets enabled when Hibernate Validator is used in combination with JPA 2.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e4287"/>8.2.3. <code class="classname">ConstraintValidatorFactory</code></h3></div></div></div><p><code class="classname">ConstraintValidatorFactory</code> is the extension point for customizing how constraint validators are instantiated and released.</p><p>The default <code class="classname">ConstraintValidatorFactory</code> provided by Hibernate Validator requires a public no-arg constructor to instantiate <code class="classname">ConstraintValidator</code> instances (see <a class="xref" href="validator-customconstraints.html#section-constraint-validator">第 6.1.2 节 “The constraint validator”</a>). Using a custom <code class="classname">ConstraintValidatorFactory</code> offers for example the possibility to use dependency injection in constraint validator implementations.</p><p>To configure a custom constraint validator factory call <code class="methodname">Configuration#constraintValidatorFactory()</code> (see <a class="xref" href="chapter-bootstrapping.html#example-using-custom-constraint-validator-factory" title="例 8.7. Using a custom ConstraintValidatorFactory">例 8.7 “Using a custom ConstraintValidatorFactory”</a>.</p><div class="example"><a id="example-using-custom-constraint-validator-factory"/><p class="title"><b>例 8.7. Using a custom <code class="classname">ConstraintValidatorFactory</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyConstraintValidatorFactory</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidatorFactory</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_operator">&lt;</span><span class="java_plain">T&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;?</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_operator">?&gt;&gt;</span><span class="java_plain">&nbsp;T&nbsp;getInstance</span><span class="java_separator">(</span><span class="java_type">Class</span><span class="java_operator">&lt;</span><span class="java_plain">T</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;key</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;releaseInstance</span><span class="java_separator">(</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;?</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_operator">?&gt;</span><span class="java_plain">&nbsp;instance</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraintValidatorFactory</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyConstraintValidatorFactory</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>Any constraint implementations relying on <code class="classname">ConstraintValidatorFactory</code> behaviors specific to an implementation (dependency injection, no no-arg constructor and so on) are not considered portable.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p><code class="classname">ConstraintValidatorFactory</code> implementations should not cache validator instances as the state of each instance can be altered in the <code class="methodname">initialize()</code> method.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-parameter-name-provider"/>8.2.4. <code class="classname">ParameterNameProvider</code></h3></div></div></div><p>In case a method or constructor parameter constraint is violated, the <code class="classname">ParameterNameProvider</code> interface is used to retrieve the parameter's name and make it available to the user via the constraint violation's property path.</p><p>The default implementation returns parameter names in the form <code class="literal">arg0</code>, <code class="literal">arg1</code> etc., while custom implementations could e.g. be based on parameter annotations, debug symbols or a feature for retrieving parameter names at runtime possibly provided by future Java versions.</p><p>Custom <code class="classname">ParameterNameProvider</code> implementations are used as demonstrated in <a class="xref" href="chapter-bootstrapping.html#example-using-custom-parameter-name-provider" title="例 8.8. Using a custom ParameterNameProvider">例 8.8 “Using a custom ParameterNameProvider”</a>.</p><div class="example"><a id="example-using-custom-parameter-name-provider"/><p class="title"><b>例 8.8. Using a custom <code class="classname">ParameterNameProvider</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;org</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">hibernate</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">validator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">referenceguide</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">chapter08</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">MyParameterNameProvider</span><span class="java_plain">&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">ParameterNameProvider</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getParameterNames</span><span class="java_separator">(</span><span class="java_type">Constructor</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;constructor</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Override</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">String</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;getParameterNames</span><span class="java_separator">(</span><span class="java_type">Method</span><span class="java_plain">&nbsp;method</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">parameterNameProvider</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyParameterNameProvider</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e4371"/>8.2.5. Adding mapping streams</h3></div></div></div><p>As discussed earlier you can configure the constraints applying for your Java beans using XML based constraint mappings.</p><p>Besides the mapping files specified in <code class="filename">META-INF/validation.xml</code> you can add further mappings via <code class="methodname">Configuration#addMapping()</code> (see <a class="xref" href="chapter-bootstrapping.html#example-adding-mapping-streams" title="例 8.9. Adding constraint mapping streams">例 8.9 “Adding constraint mapping streams”</a>). Note that the passed input stream(s) must adhere to the XML schema for constraint mappings presented in <a class="xref" href="chapter-xml-configuration.html#section-mapping-xml-constraints" title="7.2. Mapping constraints via constraint-mappings">第 7.2 节 “Mapping constraints via constraint-mappings”</a>.</p><div class="example"><a id="example-adding-mapping-streams"/><p class="title"><b>例 8.9. Adding constraint mapping streams</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">InputStream</span><!-- <br/> --><span class="java_plain">&nbsp;constraintMapping1&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">...;</span>
<!--  --><br/><span class="java_type">InputStream</span><span class="java_plain">&nbsp;constraintMapping2&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">...;</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Validation</span><span class="java_separator">.</span><span class="java_plain">byDefaultProvider</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constraintMapping1&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;constraintMapping2&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>You should close any passed input stream after the validator factory has been created.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-provider-specific-settings"/>8.2.6. Provider-specific settings</h3></div></div></div><p>Via the configuration object returned by <code class="methodname">Validation#byProvider()</code> provider specific options can be configured.</p><p>In case of Hibernate Validator this allows you to enable the fail fast mode and pass one or more programmatic constraint mappings as demonstrated in <a class="xref" href="chapter-bootstrapping.html#example-hibernate-validator-specific-options" title="例 8.10. Setting Hibernate Validator specific options">例 8.10 “Setting Hibernate Validator specific options”</a>.</p><div class="example"><a id="example-hibernate-validator-specific-options"/><p class="title"><b>例 8.10. Setting Hibernate Validator specific options</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">failFast</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addMapping</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">ConstraintMapping</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Alternatively, provider-specific options can be passed via <code class="methodname">Configuration#addProperty()</code>. Hibernate Validator supports enabling the fail fast mode that way, too:</p><div class="example"><a id="example-hibernate-validator-specific-option-via-addproperty"/><p class="title"><b>例 8.11. Enabling a Hibernate Validator specific option via <code class="methodname">addProperty()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addProperty</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;hibernate.validator.fail_fast&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;true&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>Refer to <a class="xref" href="validator-specifics.html#section-fail-fast" title="11.2. Fail fast mode">第 11.2 节 “Fail fast mode”</a> and <a class="xref" href="validator-specifics.html#section-programmatic-api" title="11.3. Programmatic constraint declaration">第 11.3 节 “Programmatic constraint declaration”</a> to learn more about the fail fast mode and the constraint declaration API.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-configuring-validator"/>8.3. Configuring a <code class="classname">Validator</code></h2></div></div></div><p>When working with a configured validator factory it can occasionally be required to apply a different configuration to a single <code class="classname">Validator</code> instance. <a class="xref" href="chapter-bootstrapping.html#example-using-context" title="例 8.12. Configuring a Validator via usingContext()">例 8.12 “Configuring a Validator via usingContext()”</a> shows how this can be achieved by calling <code class="methodname">ValidatorFactory#usingContext()</code>.</p><div class="example"><a id="example-using-context"/><p class="title"><b>例 8.12. Configuring a <code class="classname">Validator</code> via <code class="methodname">usingContext()</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;validatorFactory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validatorFactory</span><span class="java_separator">.</span><span class="java_plain">usingContext</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">版权 © 2009 - 2013 Red Hat, Inc. &amp; Gunnar Morling</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="chapter-xml-configuration.html"><strong>上一页</strong>第 7 章 Configuring via XML</a></li><li class="up"><a accesskey="u" href="#"><strong>上一级</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>起始页</strong></a></li><li class="next"><a accesskey="n" href="validator-metadata-api.html"><strong>下一页</strong>第 9 章 Using constraint metadata</a></li></ul></body></html>